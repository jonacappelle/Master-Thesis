<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Master Thesis: ICM_20948/ICM20948.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="sensor_node_small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Master Thesis
   &#160;<span id="projectnumber">V1.0</span>
   </div>
   <div id="projectbrief">Research and Design of Sensor Node for NMSD Treatment</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_i_c_m20948_8c.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">ICM20948.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Advanced funcions to control and read data from the ICM-20948.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="_i_c_m20948_8h_source.html">ICM20948.h</a>&quot;</code><br />
<code>#include &quot;em_device.h&quot;</code><br />
<code>#include &quot;em_chip.h&quot;</code><br />
<code>#include &quot;em_cmu.h&quot;</code><br />
<code>#include &quot;em_gpio.h&quot;</code><br />
<code>#include &quot;em_usart.h&quot;</code><br />
<code>#include &quot;<a class="el" href="debug__dbprint_8h_source.html">debug_dbprint.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="delay_8h_source.html">delay.h</a>&quot;</code><br />
<code>#include &lt;stdint.h&gt;</code><br />
<code>#include &quot;<a class="el" href="pinout_8h_source.html">pinout.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="timer_8h_source.html">timer.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_i2_c_8h_source.html">I2C.h</a>&quot;</code><br />
<code>#include &quot;em_i2c.h&quot;</code><br />
<code>#include &quot;i2cspm.h&quot;</code><br />
<code>#include &quot;em_core.h&quot;</code><br />
<code>#include &quot;em_wdog.h&quot;</code><br />
<code>#include &quot;rtcdriver.h&quot;</code><br />
<code>#include &quot;em_rtc.h&quot;</code><br />
<code>#include &quot;bsp.h&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for ICM20948.c:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="_i_c_m20948_8c__incl.svg" width="1851" height="187"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
<p><a href="_i_c_m20948_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ae71449b1cc6e6250b91f539153a7a0d3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a>&#160;&#160;&#160;3.14159265358979323846</td></tr>
<tr class="separator:ae71449b1cc6e6250b91f539153a7a0d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:abe547d7b034f54274da0607f457f2ac2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#abe547d7b034f54274da0607f457f2ac2">ICM_20948_Init</a> ()</td></tr>
<tr class="memdesc:abe547d7b034f54274da0607f457f2ac2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Init function for ICM20948.  <a href="_i_c_m20948_8c.html#abe547d7b034f54274da0607f457f2ac2">More...</a><br /></td></tr>
<tr class="separator:abe547d7b034f54274da0607f457f2ac2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a784752c7cf3630129dfd34f57cc5b440"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#a784752c7cf3630129dfd34f57cc5b440">ICM_20948_Init2</a> ()</td></tr>
<tr class="memdesc:a784752c7cf3630129dfd34f57cc5b440"><td class="mdescLeft">&#160;</td><td class="mdescRight">Second init function for ICM20948, use when waking from sleep.  <a href="_i_c_m20948_8c.html#a784752c7cf3630129dfd34f57cc5b440">More...</a><br /></td></tr>
<tr class="separator:a784752c7cf3630129dfd34f57cc5b440"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af59bec74c2be5e0172d4c43b99ec9c4c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#af59bec74c2be5e0172d4c43b99ec9c4c">ICM_20948_Init_SPI</a> ()</td></tr>
<tr class="memdesc:af59bec74c2be5e0172d4c43b99ec9c4c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initiate SPI functionality for ICM20948.  <a href="_i_c_m20948_8c.html#af59bec74c2be5e0172d4c43b99ec9c4c">More...</a><br /></td></tr>
<tr class="separator:af59bec74c2be5e0172d4c43b99ec9c4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53932d6c16bbfbfe8603d62195bed2ea"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#a53932d6c16bbfbfe8603d62195bed2ea">ICM_20948_enable_SPI</a> (bool enable)</td></tr>
<tr class="memdesc:a53932d6c16bbfbfe8603d62195bed2ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enables the necessary SPI interface to communicate with ICM20948.  <a href="_i_c_m20948_8c.html#a53932d6c16bbfbfe8603d62195bed2ea">More...</a><br /></td></tr>
<tr class="separator:a53932d6c16bbfbfe8603d62195bed2ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace147474f6cfc16fee8390c478b66b5e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#ace147474f6cfc16fee8390c478b66b5e">ICM_20948_power</a> (bool enable)</td></tr>
<tr class="memdesc:ace147474f6cfc16fee8390c478b66b5e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Turns the GPIO pin high to provide power to the ICM20948.  <a href="_i_c_m20948_8c.html#ace147474f6cfc16fee8390c478b66b5e">More...</a><br /></td></tr>
<tr class="separator:ace147474f6cfc16fee8390c478b66b5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adac3c17a3cdba84cde8bad432e1b2e58"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#adac3c17a3cdba84cde8bad432e1b2e58">ICM_20948_printAllData</a> ()</td></tr>
<tr class="memdesc:adac3c17a3cdba84cde8bad432e1b2e58"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print all gyro + accel + magn data using dbprint.  <a href="_i_c_m20948_8c.html#adac3c17a3cdba84cde8bad432e1b2e58">More...</a><br /></td></tr>
<tr class="separator:adac3c17a3cdba84cde8bad432e1b2e58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a337faefa825f447fde6495c735a064"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#a7a337faefa825f447fde6495c735a064">ICM_20948_check_WhoAmI</a> ()</td></tr>
<tr class="memdesc:a7a337faefa825f447fde6495c735a064"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check WhoAmI register of ICM20948.  <a href="_i_c_m20948_8c.html#a7a337faefa825f447fde6495c735a064">More...</a><br /></td></tr>
<tr class="separator:a7a337faefa825f447fde6495c735a064"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e019e8fd51a6ca5c169d3e6ee48542f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#a2e019e8fd51a6ca5c169d3e6ee48542f">ICM_20948_chipSelectSet</a> (bool enable)</td></tr>
<tr class="memdesc:a2e019e8fd51a6ca5c169d3e6ee48542f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set chipselect pin for SPI functionality.  <a href="_i_c_m20948_8c.html#a2e019e8fd51a6ca5c169d3e6ee48542f">More...</a><br /></td></tr>
<tr class="separator:a2e019e8fd51a6ca5c169d3e6ee48542f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9c1a0462c03c5af6e1ccff792128450"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#aa9c1a0462c03c5af6e1ccff792128450">ICM_20948_bankSelect</a> (uint8_t bank)</td></tr>
<tr class="memdesc:aa9c1a0462c03c5af6e1ccff792128450"><td class="mdescLeft">&#160;</td><td class="mdescRight">Select appropriate bank in ICM20948 based on first bits of address.  <a href="_i_c_m20948_8c.html#aa9c1a0462c03c5af6e1ccff792128450">More...</a><br /></td></tr>
<tr class="separator:aa9c1a0462c03c5af6e1ccff792128450"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67648f0e4d9239b0624c22f87a23014c"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#a67648f0e4d9239b0624c22f87a23014c">ICM_20948_read</a> (uint16_t addr)</td></tr>
<tr class="memdesc:a67648f0e4d9239b0624c22f87a23014c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read single register from IMU using SPI.  <a href="_i_c_m20948_8c.html#a67648f0e4d9239b0624c22f87a23014c">More...</a><br /></td></tr>
<tr class="separator:a67648f0e4d9239b0624c22f87a23014c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f8e3ac3e31a7d1a441e1a8ceb3470c8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#a9f8e3ac3e31a7d1a441e1a8ceb3470c8">ICM_20948_registerRead</a> (uint16_t addr, int numBytes, uint8_t *<a class="el" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>)</td></tr>
<tr class="memdesc:a9f8e3ac3e31a7d1a441e1a8ceb3470c8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read registers from IMU.  <a href="_i_c_m20948_8c.html#a9f8e3ac3e31a7d1a441e1a8ceb3470c8">More...</a><br /></td></tr>
<tr class="separator:a9f8e3ac3e31a7d1a441e1a8ceb3470c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa22d0eb7ceca8855eb2eece3d875f65e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a> (uint16_t addr, uint8_t <a class="el" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>)</td></tr>
<tr class="memdesc:aa22d0eb7ceca8855eb2eece3d875f65e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes registers from IMU.  <a href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">More...</a><br /></td></tr>
<tr class="separator:aa22d0eb7ceca8855eb2eece3d875f65e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f1159f4f75b1eaed9a091d01fe76c3d"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#a8f1159f4f75b1eaed9a091d01fe76c3d">ICM_20948_sleepModeEnable</a> (bool enable)</td></tr>
<tr class="memdesc:a8f1159f4f75b1eaed9a091d01fe76c3d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sleep mode enable function.  <a href="_i_c_m20948_8c.html#a8f1159f4f75b1eaed9a091d01fe76c3d">More...</a><br /></td></tr>
<tr class="separator:a8f1159f4f75b1eaed9a091d01fe76c3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32e5e81e275f3fecca06ca62cccd8ad5"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#a32e5e81e275f3fecca06ca62cccd8ad5">ICM_20948_reset</a> (void)</td></tr>
<tr class="memdesc:a32e5e81e275f3fecca06ca62cccd8ad5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset IMU.  <a href="_i_c_m20948_8c.html#a32e5e81e275f3fecca06ca62cccd8ad5">More...</a><br /></td></tr>
<tr class="separator:a32e5e81e275f3fecca06ca62cccd8ad5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9f4be3cc42a20a835c115c7d1fa3b97"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#ae9f4be3cc42a20a835c115c7d1fa3b97">ICM_20948_gyroDataRead</a> (float *gyro)</td></tr>
<tr class="memdesc:ae9f4be3cc42a20a835c115c7d1fa3b97"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read gyroscope data from IMU.  <a href="_i_c_m20948_8c.html#ae9f4be3cc42a20a835c115c7d1fa3b97">More...</a><br /></td></tr>
<tr class="separator:ae9f4be3cc42a20a835c115c7d1fa3b97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6ae090b120ceda0265da1df5a25c185"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#ae6ae090b120ceda0265da1df5a25c185">ICM_20948_gyroResolutionGet</a> (float *gyroRes)</td></tr>
<tr class="memdesc:ae6ae090b120ceda0265da1df5a25c185"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set gyro resolution.  <a href="_i_c_m20948_8c.html#ae6ae090b120ceda0265da1df5a25c185">More...</a><br /></td></tr>
<tr class="separator:ae6ae090b120ceda0265da1df5a25c185"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d34cc47da43d0bc629a4b28a9cc15ab"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#a3d34cc47da43d0bc629a4b28a9cc15ab">ICM_20948_interruptStatusRead</a> (uint32_t *intStatus)</td></tr>
<tr class="memdesc:a3d34cc47da43d0bc629a4b28a9cc15ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read staus of interrupt IMU.  <a href="_i_c_m20948_8c.html#a3d34cc47da43d0bc629a4b28a9cc15ab">More...</a><br /></td></tr>
<tr class="separator:a3d34cc47da43d0bc629a4b28a9cc15ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70ee6c80001c77355f8d6f7e47ba43db"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#a70ee6c80001c77355f8d6f7e47ba43db">ICM_20948_interruptEnable</a> (bool dataReadyEnable, bool womEnable)</td></tr>
<tr class="separator:a70ee6c80001c77355f8d6f7e47ba43db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad640eb781cd8b92ce54c6e51754b36a5"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#ad640eb781cd8b92ce54c6e51754b36a5">ICM_20948_sampleRateSet</a> (float sampleRate)</td></tr>
<tr class="separator:ad640eb781cd8b92ce54c6e51754b36a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a480bb1caa28241f1cc1e77a3445961"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#a2a480bb1caa28241f1cc1e77a3445961">ICM_20948_gyroSampleRateSet</a> (float sampleRate)</td></tr>
<tr class="separator:a2a480bb1caa28241f1cc1e77a3445961"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afca99859e232ac24c63406fb22a8bd46"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#afca99859e232ac24c63406fb22a8bd46">ICM_20948_accelSampleRateSet</a> (float sampleRate)</td></tr>
<tr class="separator:afca99859e232ac24c63406fb22a8bd46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a138a0d4e0dcbec3f93bb022ac655d3e7"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#a138a0d4e0dcbec3f93bb022ac655d3e7">ICM_20948_lowPowerModeEnter</a> (bool enAccel, bool enGyro, bool enTemp)</td></tr>
<tr class="separator:a138a0d4e0dcbec3f93bb022ac655d3e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afafb9e426c5a0c760268db0cffd7f46e"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#afafb9e426c5a0c760268db0cffd7f46e">ICM_20948_sensorEnable</a> (bool accel, bool gyro, bool temp)</td></tr>
<tr class="separator:afafb9e426c5a0c760268db0cffd7f46e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa97147c0f9f71cfaea563fb4b1d64306"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#aa97147c0f9f71cfaea563fb4b1d64306">ICM_20948_cycleModeEnable</a> (bool enable)</td></tr>
<tr class="separator:aa97147c0f9f71cfaea563fb4b1d64306"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f821ffac36d4f9a97b9f0868b21c03f"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#a2f821ffac36d4f9a97b9f0868b21c03f">ICM_20948_accelDataRead</a> (float *accel)</td></tr>
<tr class="separator:a2f821ffac36d4f9a97b9f0868b21c03f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c64c7bd58f7e6dafb61fddd98fe9250"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#a4c64c7bd58f7e6dafb61fddd98fe9250">ICM_20948_accelResolutionGet</a> (float *accelRes)</td></tr>
<tr class="separator:a4c64c7bd58f7e6dafb61fddd98fe9250"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d964813062ec77bcd52135dab29654d"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#a1d964813062ec77bcd52135dab29654d">ICM_20948_accelFullscaleSet</a> (uint8_t accelFs)</td></tr>
<tr class="separator:a1d964813062ec77bcd52135dab29654d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a128cc4107e5e547f6c9e1c4dd87cfbe8"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#a128cc4107e5e547f6c9e1c4dd87cfbe8">ICM_20948_gyroFullscaleSet</a> (uint8_t gyroFs)</td></tr>
<tr class="separator:a128cc4107e5e547f6c9e1c4dd87cfbe8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d0bf2e4c95719f9dfb2e8c286d7a8d6"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#a8d0bf2e4c95719f9dfb2e8c286d7a8d6">ICM_20948_wakeOnMotionITEnable</a> (bool enable, uint8_t womThreshold, float sampleRate)</td></tr>
<tr class="separator:a8d0bf2e4c95719f9dfb2e8c286d7a8d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7988a26a892dc9f22714fef8005f42e"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#ad7988a26a892dc9f22714fef8005f42e">ICM_20948_gyroBandwidthSet</a> (uint8_t gyroBw)</td></tr>
<tr class="separator:ad7988a26a892dc9f22714fef8005f42e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6d2dbd77995c450b5cab0068291cc37"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#ab6d2dbd77995c450b5cab0068291cc37">ICM_20948_accelBandwidthSet</a> (uint8_t accelBw)</td></tr>
<tr class="separator:ab6d2dbd77995c450b5cab0068291cc37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab79679ad6161de947d8bfb16a34b4187"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#ab79679ad6161de947d8bfb16a34b4187">ICM_20948_latchEnable</a> (bool enable)</td></tr>
<tr class="memdesc:ab79679ad6161de947d8bfb16a34b4187"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enables / disables the 50 micro seconds interrupt pin functionality.  <a href="_i_c_m20948_8c.html#ab79679ad6161de947d8bfb16a34b4187">More...</a><br /></td></tr>
<tr class="separator:ab79679ad6161de947d8bfb16a34b4187"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a8b698432306e6b555992507ffaf6ac"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#a0a8b698432306e6b555992507ffaf6ac">ICM_20948_set_mag_transfer</a> (bool read)</td></tr>
<tr class="separator:a0a8b698432306e6b555992507ffaf6ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab25e7c803027dbf8de4c205763ac39ab"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#ab25e7c803027dbf8de4c205763ac39ab">waitForSlave4</a> ()</td></tr>
<tr class="separator:ab25e7c803027dbf8de4c205763ac39ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0556327f5e2a9693e8928ef676943851"><td class="memItemLeft" align="right" valign="top">unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#a0556327f5e2a9693e8928ef676943851">readMagRegister</a> (unsigned char magreg)</td></tr>
<tr class="separator:a0556327f5e2a9693e8928ef676943851"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a139d96443873e815a9301c1432e640b6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#a139d96443873e815a9301c1432e640b6">writeMagRegister</a> (unsigned char magreg, unsigned char val)</td></tr>
<tr class="separator:a139d96443873e815a9301c1432e640b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa39af5c47122519a8bed2bcafd5ee06"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#afa39af5c47122519a8bed2bcafd5ee06">ICM_20948_read_mag_register</a> (uint8_t addr, uint8_t numBytes, uint8_t *<a class="el" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>)</td></tr>
<tr class="memdesc:afa39af5c47122519a8bed2bcafd5ee06"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read register in the AK09916 magnetometer device.  <a href="_i_c_m20948_8c.html#afa39af5c47122519a8bed2bcafd5ee06">More...</a><br /></td></tr>
<tr class="separator:afa39af5c47122519a8bed2bcafd5ee06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ed83e84f5d14637ea91c05174e84dcd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#a7ed83e84f5d14637ea91c05174e84dcd">ICM_20948_write_mag_register</a> (uint8_t addr, uint8_t <a class="el" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>)</td></tr>
<tr class="memdesc:a7ed83e84f5d14637ea91c05174e84dcd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes a uint8_t to the I2C address of the magnetometer of the ICM_20948.  <a href="_i_c_m20948_8c.html#a7ed83e84f5d14637ea91c05174e84dcd">More...</a><br /></td></tr>
<tr class="separator:a7ed83e84f5d14637ea91c05174e84dcd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae81d4cfd5ba0ab7962bdc2ad2c002468"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#ae81d4cfd5ba0ab7962bdc2ad2c002468">ICM_20948_set_mag_mode</a> (uint8_t magMode)</td></tr>
<tr class="separator:ae81d4cfd5ba0ab7962bdc2ad2c002468"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad8d065bfe65cd7233c5916e2fa57bb1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#aad8d065bfe65cd7233c5916e2fa57bb1">ICM_20948_magRawDataRead</a> (float *raw_magn)</td></tr>
<tr class="separator:aad8d065bfe65cd7233c5916e2fa57bb1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8fa2097274ad4e2b81faf5917a62679"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#ad8fa2097274ad4e2b81faf5917a62679">ICM_20948_magDataRead</a> (float *magn)</td></tr>
<tr class="separator:ad8fa2097274ad4e2b81faf5917a62679"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed55c84082bcb8765a603d0e09f236a7"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#aed55c84082bcb8765a603d0e09f236a7">ICM_20948_reset_mag</a> (void)</td></tr>
<tr class="separator:aed55c84082bcb8765a603d0e09f236a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30bf26e63d6d09171b0200b4f1416039"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#a30bf26e63d6d09171b0200b4f1416039">ICM_20948_magn_to_angle</a> (float *magn, float *angle)</td></tr>
<tr class="separator:a30bf26e63d6d09171b0200b4f1416039"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad503b9efac873146ca6401db153afe3e"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#ad503b9efac873146ca6401db153afe3e">ICM_20948_accelGyroCalibrate</a> (float *accelBiasScaled, float *gyroBiasScaled)</td></tr>
<tr class="memdesc:ad503b9efac873146ca6401db153afe3e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Accelerometer and gyroscope calibration function. Reads the gyroscope and accelerometer values while the device is at rest and in level. The resulting values are loaded to the accel and gyro bias registers to cancel the static offset error.  <a href="_i_c_m20948_8c.html#ad503b9efac873146ca6401db153afe3e">More...</a><br /></td></tr>
<tr class="separator:ad503b9efac873146ca6401db153afe3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9adb9bb0176c243589f94aee803a8bb3"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#a9adb9bb0176c243589f94aee803a8bb3">ICM_20948_gyroCalibrate</a> (float *gyroBiasScaled)</td></tr>
<tr class="memdesc:a9adb9bb0176c243589f94aee803a8bb3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gyroscope calibration function. Reads the gyroscope values while the device is at rest and in level. The resulting values are loaded to the gyro bias registers to cancel the static offset error.  <a href="_i_c_m20948_8c.html#a9adb9bb0176c243589f94aee803a8bb3">More...</a><br /></td></tr>
<tr class="separator:a9adb9bb0176c243589f94aee803a8bb3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d8a914c518d9d869d3e4d9b7afeb672"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#a0d8a914c518d9d869d3e4d9b7afeb672">ICM_20948_min_max_mag</a> (int16_t *minMag, int16_t *maxMag)</td></tr>
<tr class="memdesc:a0d8a914c518d9d869d3e4d9b7afeb672"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate minimum and maximum magnetometer values, which are used for calibration.  <a href="_i_c_m20948_8c.html#a0d8a914c518d9d869d3e4d9b7afeb672">More...</a><br /></td></tr>
<tr class="separator:a0d8a914c518d9d869d3e4d9b7afeb672"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95260c22db2bcec4bf69a71c967d5667"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#a95260c22db2bcec4bf69a71c967d5667">ICM_20948_calibrate_mag</a> (float *offset, float *scale)</td></tr>
<tr class="separator:a95260c22db2bcec4bf69a71c967d5667"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ae523984fd59c5831b8ec8ee73ca1a0b5"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#ae523984fd59c5831b8ec8ee73ca1a0b5">ICM_20948_Initialized</a> = false</td></tr>
<tr class="separator:ae523984fd59c5831b8ec8ee73ca1a0b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83301b3809fa28a7a800258bae36d074"><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#a83301b3809fa28a7a800258bae36d074">mag_minimumRange</a> = 40</td></tr>
<tr class="separator:a83301b3809fa28a7a800258bae36d074"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae69cca96b2cbb9eddab9295fad1a1e07"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#ae69cca96b2cbb9eddab9295fad1a1e07">mag_res</a> = 4912.0f / 32752.0f</td></tr>
<tr class="separator:ae69cca96b2cbb9eddab9295fad1a1e07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f779573a3b06192892ce82c7cd94307"><td class="memItemLeft" align="right" valign="top">int16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#a4f779573a3b06192892ce82c7cd94307">_hxcounts</a></td></tr>
<tr class="separator:a4f779573a3b06192892ce82c7cd94307"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26e7f879fbdd01ab7d0fe3a2326e6269"><td class="memItemLeft" align="right" valign="top">int16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#a26e7f879fbdd01ab7d0fe3a2326e6269">_hycounts</a></td></tr>
<tr class="separator:a26e7f879fbdd01ab7d0fe3a2326e6269"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad58c847bfe6019ce99e3de59609912ed"><td class="memItemLeft" align="right" valign="top">int16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#ad58c847bfe6019ce99e3de59609912ed">_hzcounts</a></td></tr>
<tr class="separator:ad58c847bfe6019ce99e3de59609912ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0adc3826aa3bd34b685205b20864ae12"><td class="memItemLeft" align="right" valign="top">int16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#a0adc3826aa3bd34b685205b20864ae12">tX</a> [3] = {1, 0, 0}</td></tr>
<tr class="separator:a0adc3826aa3bd34b685205b20864ae12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab96f756fc510c74bd93e749b09a016c"><td class="memItemLeft" align="right" valign="top">int16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#aab96f756fc510c74bd93e749b09a016c">tY</a> [3] = {0, -1, 0}</td></tr>
<tr class="separator:aab96f756fc510c74bd93e749b09a016c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a230ea1bf4635586a5b870d567d0f7a46"><td class="memItemLeft" align="right" valign="top">int16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#a230ea1bf4635586a5b870d567d0f7a46">tZ</a> [3] = {0, 0, -1}</td></tr>
<tr class="separator:a230ea1bf4635586a5b870d567d0f7a46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4f8b3c99a79c4980865579a1c46827c"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#af4f8b3c99a79c4980865579a1c46827c">_hx</a></td></tr>
<tr class="separator:af4f8b3c99a79c4980865579a1c46827c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8acf1481814813e8f32de4964cea8784"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#a8acf1481814813e8f32de4964cea8784">_hy</a></td></tr>
<tr class="separator:a8acf1481814813e8f32de4964cea8784"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a2efefd564ede42017c7d42dc51816b"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#a5a2efefd564ede42017c7d42dc51816b">_hz</a></td></tr>
<tr class="separator:a5a2efefd564ede42017c7d42dc51816b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49bc476f8f7d212fb1c59f1304f2a522"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#a49bc476f8f7d212fb1c59f1304f2a522">accRawScaling</a> = 32767.5f</td></tr>
<tr class="separator:a49bc476f8f7d212fb1c59f1304f2a522"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a673e9a567be61e4d8421ecff57bfd4f4"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#a673e9a567be61e4d8421ecff57bfd4f4">gyroRawScaling</a> = 32767.5f</td></tr>
<tr class="separator:a673e9a567be61e4d8421ecff57bfd4f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab305f17de293bdb7011e83d6c6636005"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#ab305f17de293bdb7011e83d6c6636005">magRawScaling</a> = 32767.5f</td></tr>
<tr class="separator:ab305f17de293bdb7011e83d6c6636005"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a498e73167c4bbbdc1221f2d409d44aa1"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#a498e73167c4bbbdc1221f2d409d44aa1">_magScale</a> = (4912.0f) / (32767.5f)</td></tr>
<tr class="separator:a498e73167c4bbbdc1221f2d409d44aa1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1737d020ba0806fbcf944bea838b2024"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_i_c_m20948_8c.html#a1737d020ba0806fbcf944bea838b2024">IMU_MEASURING</a></td></tr>
<tr class="separator:a1737d020ba0806fbcf944bea838b2024"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Advanced funcions to control and read data from the ICM-20948. </p>
<p>Partly copied from silabs thunderboard code for ICM-20689, partly self written </p><dl class="section version"><dt>Version</dt><dd>1.0 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Jona Cappelle </dd></dl>

<p class="definition">Definition in file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ae71449b1cc6e6250b91f539153a7a0d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae71449b1cc6e6250b91f539153a7a0d3">&#9670;&nbsp;</a></span>M_PI</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define M_PI&#160;&#160;&#160;3.14159265358979323846</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Declaration of PI as a constant, used for conversion angle &lt;--&gt; rad </p>

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l00041">41</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ab6d2dbd77995c450b5cab0068291cc37"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab6d2dbd77995c450b5cab0068291cc37">&#9670;&nbsp;</a></span>ICM_20948_accelBandwidthSet()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t ICM_20948_accelBandwidthSet </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>accelBw</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l01192">1192</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;{</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;  uint8_t reg;</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160; </div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;  <span class="comment">/* Read the GYRO_CONFIG_1 register */</span></div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#a9f8e3ac3e31a7d1a441e1a8ceb3470c8">ICM_20948_registerRead</a>(<a class="code" href="pinout_8h.html#aa527cd2683d444f64c67228d15c67dfd">ICM_20948_REG_ACCEL_CONFIG</a>, 1, &amp;reg);</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;  reg &amp;= ~(<a class="code" href="pinout_8h.html#a3d05c6f5584419cd8a5dd9840ecce0a2">ICM_20948_MASK_ACCEL_BW</a>);</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160; </div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;  <span class="comment">/* Write the new bandwidth value to the gyro config register */</span></div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;  reg |= (accelBw &amp; <a class="code" href="pinout_8h.html#a3d05c6f5584419cd8a5dd9840ecce0a2">ICM_20948_MASK_ACCEL_BW</a>);</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#aa527cd2683d444f64c67228d15c67dfd">ICM_20948_REG_ACCEL_CONFIG</a>, reg);</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160; </div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="pinout_8h.html#a13373833ae00ffd733f408836a1eacc1">ICM_20948_OK</a>;</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="pinout_8h_source.html#l00282">ICM_20948_MASK_ACCEL_BW</a>, <a class="el" href="pinout_8h_source.html#l00043">ICM_20948_OK</a>, <a class="el" href="pinout_8h_source.html#l00277">ICM_20948_REG_ACCEL_CONFIG</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00654">ICM_20948_registerRead()</a>, and <a class="el" href="_i_c_m20948_8c_source.html#l00697">ICM_20948_registerWrite()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_i_c_m20948_8c_source.html#l01525">ICM_20948_accelGyroCalibrate()</a>, and <a class="el" href="_i_c_m20948_8c_source.html#l01130">ICM_20948_wakeOnMotionITEnable()</a>.</p>

</div>
</div>
<a id="a2f821ffac36d4f9a97b9f0868b21c03f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f821ffac36d4f9a97b9f0868b21c03f">&#9670;&nbsp;</a></span>ICM_20948_accelDataRead()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t ICM_20948_accelDataRead </td>
          <td>(</td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>accel</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l01050">1050</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;{</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;  uint8_t rawData[6];</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;  <span class="keywordtype">float</span> accelRes;</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;  int16_t temp;</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160; </div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;  <span class="comment">/* Retrieve the current resolution */</span></div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#a4c64c7bd58f7e6dafb61fddd98fe9250">ICM_20948_accelResolutionGet</a>(&amp;accelRes);</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160; </div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;  <span class="comment">/* Read the six raw data registers into data array */</span></div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#a9f8e3ac3e31a7d1a441e1a8ceb3470c8">ICM_20948_registerRead</a>(<a class="code" href="pinout_8h.html#a6e4cc3b3e25b0e91f36c40a3a0cc0caf">ICM_20948_REG_ACCEL_XOUT_H_SH</a>, 6, &amp;rawData[0]);</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160; </div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;  <span class="comment">/* Convert the MSB and LSB into a signed 16-bit value and multiply by the resolution to get the G value */</span></div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;  temp = ( (int16_t) rawData[0] &lt;&lt; 8) | rawData[1];</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;  accel[0] = (float) temp * accelRes;</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;  temp = ( (int16_t) rawData[2] &lt;&lt; 8) | rawData[3];</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;  accel[1] = (float) temp * accelRes;</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;  temp = ( (int16_t) rawData[4] &lt;&lt; 8) | rawData[5];</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;  accel[2] = (float) temp * accelRes;</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160; </div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="pinout_8h.html#a13373833ae00ffd733f408836a1eacc1">ICM_20948_OK</a>;</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="_i_c_m20948_8c_source.html#l01074">ICM_20948_accelResolutionGet()</a>, <a class="el" href="pinout_8h_source.html#l00043">ICM_20948_OK</a>, <a class="el" href="pinout_8h_source.html#l00181">ICM_20948_REG_ACCEL_XOUT_H_SH</a>, and <a class="el" href="_i_c_m20948_8c_source.html#l00654">ICM_20948_registerRead()</a>.</p>

<p class="reference">Referenced by <a class="el" href="main_8c_source.html#l00234">measure_send()</a>.</p>

</div>
</div>
<a id="a1d964813062ec77bcd52135dab29654d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d964813062ec77bcd52135dab29654d">&#9670;&nbsp;</a></span>ICM_20948_accelFullscaleSet()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t ICM_20948_accelFullscaleSet </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>accelFs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l01104">1104</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;{</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;  uint8_t reg;</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160; </div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;  accelFs &amp;= <a class="code" href="pinout_8h.html#a38e7d91cf85ad7c73099aa8c0bdb107a">ICM_20948_MASK_ACCEL_FULLSCALE</a>;</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#a9f8e3ac3e31a7d1a441e1a8ceb3470c8">ICM_20948_registerRead</a>(<a class="code" href="pinout_8h.html#aa527cd2683d444f64c67228d15c67dfd">ICM_20948_REG_ACCEL_CONFIG</a>, 1, &amp;reg);</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;  reg &amp;= ~(<a class="code" href="pinout_8h.html#a38e7d91cf85ad7c73099aa8c0bdb107a">ICM_20948_MASK_ACCEL_FULLSCALE</a>);</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;  reg |= accelFs;</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#aa527cd2683d444f64c67228d15c67dfd">ICM_20948_REG_ACCEL_CONFIG</a>, reg);</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160; </div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="pinout_8h.html#a13373833ae00ffd733f408836a1eacc1">ICM_20948_OK</a>;</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="pinout_8h_source.html#l00281">ICM_20948_MASK_ACCEL_FULLSCALE</a>, <a class="el" href="pinout_8h_source.html#l00043">ICM_20948_OK</a>, <a class="el" href="pinout_8h_source.html#l00277">ICM_20948_REG_ACCEL_CONFIG</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00654">ICM_20948_registerRead()</a>, and <a class="el" href="_i_c_m20948_8c_source.html#l00697">ICM_20948_registerWrite()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_i_c_m20948_8c_source.html#l01525">ICM_20948_accelGyroCalibrate()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00169">ICM_20948_Init2()</a>, and <a class="el" href="_i_c_m20948_8c_source.html#l01130">ICM_20948_wakeOnMotionITEnable()</a>.</p>

</div>
</div>
<a id="ad503b9efac873146ca6401db153afe3e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad503b9efac873146ca6401db153afe3e">&#9670;&nbsp;</a></span>ICM_20948_accelGyroCalibrate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t ICM_20948_accelGyroCalibrate </td>
          <td>(</td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>accelBiasScaled</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>gyroBiasScaled</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Accelerometer and gyroscope calibration function. Reads the gyroscope and accelerometer values while the device is at rest and in level. The resulting values are loaded to the accel and gyro bias registers to cancel the static offset error. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">accelBiasScaled</td><td>The mesured acceleration sensor bias in mg</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">gyroBiasScaled</td><td>The mesured gyro sensor bias in deg/sec</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns zero on OK, non-zero otherwise </dd></dl>

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l01525">1525</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;{</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;  uint8_t <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[12];</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;  uint16_t i, packetCount, fifoCount;</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;  int32_t gyroBias[3] = { 0, 0, 0 };</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;  int32_t accelBias[3] = { 0, 0, 0 };</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;  int32_t accelTemp[3];</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;  int32_t gyroTemp[3];</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;  int32_t accelBiasFactory[3];</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;  int32_t gyroBiasStored[3];</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;  <span class="keywordtype">float</span> gyroRes, accelRes;</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160; </div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;  <span class="comment">/* Enable the accelerometer and the gyro */</span></div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#afafb9e426c5a0c760268db0cffd7f46e">ICM_20948_sensorEnable</a>(<span class="keyword">true</span>, <span class="keyword">true</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160; </div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;  <span class="comment">/* Set 1kHz sample rate */</span></div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#ad640eb781cd8b92ce54c6e51754b36a5">ICM_20948_sampleRateSet</a>(1100.0);</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160; </div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;  <span class="comment">/* 246Hz BW for the accelerometer and 200Hz for the gyroscope */</span></div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#ab6d2dbd77995c450b5cab0068291cc37">ICM_20948_accelBandwidthSet</a>(<a class="code" href="pinout_8h.html#a9b41d4bcc632c0bb90dd3102c866e992">ICM_20948_ACCEL_BW_246HZ</a>);</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#ad7988a26a892dc9f22714fef8005f42e">ICM_20948_gyroBandwidthSet</a>(<a class="code" href="pinout_8h.html#ae581a6346270cbca97bf1f8ef1779929">ICM_20948_GYRO_BW_12HZ</a>);</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160; </div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;  <span class="comment">/* Set the most sensitive range: 2G full scale and 250dps full scale */</span></div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#a1d964813062ec77bcd52135dab29654d">ICM_20948_accelFullscaleSet</a>(<a class="code" href="pinout_8h.html#a846c2742256a4baae9fdeca2d8d31214">ICM_20948_ACCEL_FULLSCALE_2G</a>);</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#a128cc4107e5e547f6c9e1c4dd87cfbe8">ICM_20948_gyroFullscaleSet</a>(<a class="code" href="pinout_8h.html#add11763f890c38ef1ee2ec575bde6b04">ICM_20948_GYRO_FULLSCALE_250DPS</a>);</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160; </div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;  <span class="comment">/* Retrieve the resolution per bit */</span></div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#a4c64c7bd58f7e6dafb61fddd98fe9250">ICM_20948_accelResolutionGet</a>(&amp;accelRes);</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#ae6ae090b120ceda0265da1df5a25c185">ICM_20948_gyroResolutionGet</a>(&amp;gyroRes);</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160; </div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;  <span class="comment">/* The accel sensor needs max 30ms, the gyro max 35ms to fully start */</span></div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;  <span class="comment">/* Experiments show that the gyro needs more time to get reliable results */</span></div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;  <a class="code" href="delay_8c.html#adb46f4276f5ddf111153701858f85df6">delay</a>(50);</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160; </div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;  <span class="comment">/* Disable the FIFO */</span></div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#a8e84a66c29d07e5d0814f0e01082b9e3">ICM_20948_REG_USER_CTRL</a>, <a class="code" href="pinout_8h.html#a8cd33f6dc4502e60bb6d1c3a962018e2">ICM_20948_BIT_FIFO_EN</a>);</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#a9440aae0a94561e6eb963b31e808847d">ICM_20948_REG_FIFO_MODE</a>, 0x0F);</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160; </div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;  <span class="comment">/* Enable accelerometer and gyro to store the data in FIFO */</span></div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#adcbd4695e0846db7c093b2346b5a1c99">ICM_20948_REG_FIFO_EN_2</a>, <a class="code" href="pinout_8h.html#a2b9e2b8a1852e9e0f4b21596881d5217">ICM_20948_BIT_ACCEL_FIFO_EN</a> | <a class="code" href="pinout_8h.html#a7f2042e7b2ac7ad4fe753558788aca1c">ICM_20948_BITS_GYRO_FIFO_EN</a>);</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160; </div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;  <span class="comment">/* Reset the FIFO */</span></div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#a53aaddcfcc2e63e14abc3bebefc26277">ICM_20948_REG_FIFO_RST</a>, 0x0F);</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#a53aaddcfcc2e63e14abc3bebefc26277">ICM_20948_REG_FIFO_RST</a>, 0x00);</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160; </div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;  <span class="comment">/* Enable the FIFO */</span></div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#a8e84a66c29d07e5d0814f0e01082b9e3">ICM_20948_REG_USER_CTRL</a>, <a class="code" href="pinout_8h.html#a8cd33f6dc4502e60bb6d1c3a962018e2">ICM_20948_BIT_FIFO_EN</a>);</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160; </div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;  <span class="comment">/* The max FIFO size is 4096 bytes, one set of measurements takes 12 bytes */</span></div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;  <span class="comment">/* (3 axes, 2 sensors, 2 bytes each value ) 340 samples use 4080 bytes of FIFO */</span></div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;  <span class="comment">/* Loop until at least 4080 samples gathered */</span></div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;  fifoCount = 0;</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;  <span class="keywordflow">while</span> ( fifoCount &lt; 4080 ) {</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;    <a class="code" href="delay_8c.html#adb46f4276f5ddf111153701858f85df6">delay</a>(5);</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;    <span class="comment">/* Read FIFO sample count */</span></div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;    <a class="code" href="_i_c_m20948_8c.html#a9f8e3ac3e31a7d1a441e1a8ceb3470c8">ICM_20948_registerRead</a>(<a class="code" href="pinout_8h.html#a95d2daf38dcdee5ab42ec6b7bb7447e9">ICM_20948_REG_FIFO_COUNT_H</a>, 2, &amp;<a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[0]);</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;    <span class="comment">/* Convert to a 16 bit value */</span></div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;    fifoCount = ( (uint16_t) (<a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[0] &lt;&lt; 8) | <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[1]);</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;  }</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160; </div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;  <span class="comment">/* Disable accelerometer and gyro to store the data in FIFO */</span></div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#adcbd4695e0846db7c093b2346b5a1c99">ICM_20948_REG_FIFO_EN_2</a>, 0x00);</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160; </div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;  <span class="comment">/* Read FIFO sample count */</span></div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#a9f8e3ac3e31a7d1a441e1a8ceb3470c8">ICM_20948_registerRead</a>(<a class="code" href="pinout_8h.html#a95d2daf38dcdee5ab42ec6b7bb7447e9">ICM_20948_REG_FIFO_COUNT_H</a>, 2, &amp;<a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[0]);</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160; </div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;  <span class="comment">/* Convert to a 16 bit value */</span></div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;  fifoCount = ( (uint16_t) (<a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[0] &lt;&lt; 8) | <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[1]);</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160; </div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;  <span class="comment">/* Calculate the number of data sets (3 axis of accel an gyro, two bytes each = 12 bytes) */</span></div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;  packetCount = fifoCount / 12;</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160; </div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;  <span class="comment">/* Retrieve the data from the FIFO */</span></div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;  <span class="keywordflow">for</span> ( i = 0; i &lt; packetCount; i++ ) {</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;    <a class="code" href="_i_c_m20948_8c.html#a9f8e3ac3e31a7d1a441e1a8ceb3470c8">ICM_20948_registerRead</a>(<a class="code" href="pinout_8h.html#a00b373a61a80ab610518bd076b53b4d9">ICM_20948_REG_FIFO_R_W</a>, 12, &amp;<a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[0]);</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;    <span class="comment">/* Convert to 16 bit signed accel and gyro x,y and z values */</span></div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;    accelTemp[0] = ( (int16_t) (<a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[0] &lt;&lt; 8) | <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[1]);</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;    accelTemp[1] = ( (int16_t) (<a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[2] &lt;&lt; 8) | <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[3]);</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;    accelTemp[2] = ( (int16_t) (<a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[4] &lt;&lt; 8) | <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[5]);</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;    gyroTemp[0] = ( (int16_t) (<a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[6] &lt;&lt; 8) | <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[7]);</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;    gyroTemp[1] = ( (int16_t) (<a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[8] &lt;&lt; 8) | <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[9]);</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;    gyroTemp[2] = ( (int16_t) (<a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[10] &lt;&lt; 8) | <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[11]);</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160; </div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;    <span class="comment">/* Sum the values */</span></div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;    accelBias[0] += accelTemp[0];</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;    accelBias[1] += accelTemp[1];</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;    accelBias[2] += accelTemp[2];</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;    gyroBias[0] += gyroTemp[0];</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;    gyroBias[1] += gyroTemp[1];</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;    gyroBias[2] += gyroTemp[2];</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;  }</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160; </div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;  <span class="comment">/* Divide by packet count to get the average */</span></div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;  accelBias[0] /= packetCount;</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;  accelBias[1] /= packetCount;</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;  accelBias[2] /= packetCount;</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;  gyroBias[0] /= packetCount;</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;  gyroBias[1] /= packetCount;</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;  gyroBias[2] /= packetCount;</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160; </div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;  <span class="comment">/* Acceleormeter: add or remove (depending on the orientation of the chip) 1G (gravity) from the Z axis value */</span></div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;  <span class="keywordflow">if</span> ( accelBias[2] &gt; 0L ) {</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;    accelBias[2] -= (int32_t) (1.0 / accelRes);</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;    accelBias[2] += (int32_t) (1.0 / accelRes);</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;  }</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160; </div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;  <span class="comment">/* Convert the values to degrees per sec for displaying */</span></div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;  gyroBiasScaled[0] = (float) gyroBias[0] * gyroRes;</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;  gyroBiasScaled[1] = (float) gyroBias[1] * gyroRes;</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;  gyroBiasScaled[2] = (float) gyroBias[2] * gyroRes;</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160; </div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;  <span class="comment">/* Read stored gyro trim values. After reset these values are all 0 */</span></div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#a9f8e3ac3e31a7d1a441e1a8ceb3470c8">ICM_20948_registerRead</a>(<a class="code" href="pinout_8h.html#a559f5e3cf33135820776dc875da00766">ICM_20948_REG_XG_OFFS_USRH</a>, 2, &amp;<a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[0]);</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;  gyroBiasStored[0] = ( (int16_t) (<a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[0] &lt;&lt; 8) | <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[1]);</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#a9f8e3ac3e31a7d1a441e1a8ceb3470c8">ICM_20948_registerRead</a>(<a class="code" href="pinout_8h.html#aa59a7f4f3f88a8f60e0726224cdfd1d4">ICM_20948_REG_YG_OFFS_USRH</a>, 2, &amp;<a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[0]);</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;  gyroBiasStored[1] = ( (int16_t) (<a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[0] &lt;&lt; 8) | <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[1]);</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#a9f8e3ac3e31a7d1a441e1a8ceb3470c8">ICM_20948_registerRead</a>(<a class="code" href="pinout_8h.html#ab8cba5978077c7abf4cfc104c4905da5">ICM_20948_REG_ZG_OFFS_USRH</a>, 2, &amp;<a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[0]);</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;  gyroBiasStored[2] = ( (int16_t) (<a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[0] &lt;&lt; 8) | <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[1]);</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160; </div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;  <span class="comment">/* The gyro bias should be stored in 1000dps full scaled format. We measured in 250dps to get */</span></div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;  <span class="comment">/* the best sensitivity, so need to divide by 4 */</span></div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;  <span class="comment">/* Substract from the stored calibration value */</span></div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;  gyroBiasStored[0] -= gyroBias[0] / 4;</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;  gyroBiasStored[1] -= gyroBias[1] / 4;</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;  gyroBiasStored[2] -= gyroBias[2] / 4;</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160; </div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;  <span class="comment">/* Split the values into two bytes */</span></div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;  <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[0] = (gyroBiasStored[0] &gt;&gt; 8) &amp; 0xFF;</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;  <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[1] = (gyroBiasStored[0]) &amp; 0xFF;</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;  <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[2] = (gyroBiasStored[1] &gt;&gt; 8) &amp; 0xFF;</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;  <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[3] = (gyroBiasStored[1]) &amp; 0xFF;</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;  <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[4] = (gyroBiasStored[2] &gt;&gt; 8) &amp; 0xFF;</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;  <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[5] = (gyroBiasStored[2]) &amp; 0xFF;</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160; </div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;  <span class="comment">/* Write the  gyro bias values to the chip */</span></div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#a559f5e3cf33135820776dc875da00766">ICM_20948_REG_XG_OFFS_USRH</a>, <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[0]);</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#a7cf7d10cffb3c1fce9e43ab116b0f869">ICM_20948_REG_XG_OFFS_USRL</a>, <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[1]);</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#aa59a7f4f3f88a8f60e0726224cdfd1d4">ICM_20948_REG_YG_OFFS_USRH</a>, <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[2]);</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#a5ebf48f2fe9665273b6985b18ecd1c79">ICM_20948_REG_YG_OFFS_USRL</a>, <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[3]);</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#ab8cba5978077c7abf4cfc104c4905da5">ICM_20948_REG_ZG_OFFS_USRH</a>, <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[4]);</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#ae987da54cf2c6dfac776c7c1796da068">ICM_20948_REG_ZG_OFFS_USRL</a>, <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[5]);</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160; </div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;  <span class="comment">/* Calculate the accelerometer bias values to store in the hardware accelerometer bias registers. These registers contain */</span></div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;  <span class="comment">/* factory trim values which must be added to the calculated accelerometer biases; on boot up these registers will hold */</span></div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;  <span class="comment">/* non-zero values. In addition, bit 0 of the lower byte must be preserved since it is used for temperature */</span></div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;  <span class="comment">/* compensation calculations(? the datasheet is not clear). Accelerometer bias registers expect bias input */</span></div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;  <span class="comment">/* as 2048 LSB per g, so that the accelerometer biases calculated above must be divided by 8. */</span></div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160; </div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;  <span class="comment">/* Read factory accelerometer trim values */</span></div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#a9f8e3ac3e31a7d1a441e1a8ceb3470c8">ICM_20948_registerRead</a>(<a class="code" href="pinout_8h.html#a5645d53425645ed575721d1eee6d3e66">ICM_20948_REG_XA_OFFSET_H</a>, 2, &amp;<a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[0]);</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;  accelBiasFactory[0] = ( (int16_t) (<a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[0] &lt;&lt; 8) | <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[1]);</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#a9f8e3ac3e31a7d1a441e1a8ceb3470c8">ICM_20948_registerRead</a>(<a class="code" href="pinout_8h.html#a97d6879075986a07b27a990bac9c8e4e">ICM_20948_REG_YA_OFFSET_H</a>, 2, &amp;<a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[0]);</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;  accelBiasFactory[1] = ( (int16_t) (<a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[0] &lt;&lt; 8) | <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[1]);</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#a9f8e3ac3e31a7d1a441e1a8ceb3470c8">ICM_20948_registerRead</a>(<a class="code" href="pinout_8h.html#a1be8ebcf9873010af11b8962da3dbb91">ICM_20948_REG_ZA_OFFSET_H</a>, 2, &amp;<a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[0]);</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;  accelBiasFactory[2] = ( (int16_t) (<a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[0] &lt;&lt; 8) | <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[1]);</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160; </div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;  <span class="comment">/* Construct total accelerometer bias, including calculated average accelerometer bias from above */</span></div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;  <span class="comment">/* Scale the 2g full scale (most sensitive range) results to 16g full scale - divide by 8 */</span></div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;  <span class="comment">/* Clear the last bit (temperature compensation? - the datasheet is not clear) */</span></div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;  <span class="comment">/* Substract from the factory calibration value */</span></div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160; </div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;  accelBiasFactory[0] -= ( (accelBias[0] / 8) &amp; ~1);</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;  accelBiasFactory[1] -= ( (accelBias[1] / 8) &amp; ~1);</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;  accelBiasFactory[2] -= ( (accelBias[2] / 8) &amp; ~1);</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160; </div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;  <span class="comment">/* Split the values into two bytes */</span></div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;  <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[0] = (accelBiasFactory[0] &gt;&gt; 8) &amp; 0xFF;</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;  <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[1] = (accelBiasFactory[0]) &amp; 0xFF;</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;  <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[2] = (accelBiasFactory[1] &gt;&gt; 8) &amp; 0xFF;</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;  <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[3] = (accelBiasFactory[1]) &amp; 0xFF;</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;  <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[4] = (accelBiasFactory[2] &gt;&gt; 8) &amp; 0xFF;</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;  <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[5] = (accelBiasFactory[2]) &amp; 0xFF;</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160; </div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;  <span class="comment">/* Store them in the accelerometer offset registers */</span></div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#a5645d53425645ed575721d1eee6d3e66">ICM_20948_REG_XA_OFFSET_H</a>, <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[0]);</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#a8411d9aa97e8979df80e4d5e451c1716">ICM_20948_REG_XA_OFFSET_L</a>, <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[1]);</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#a97d6879075986a07b27a990bac9c8e4e">ICM_20948_REG_YA_OFFSET_H</a>, <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[2]);</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#abdc0ec272bbc6775cad4fd9af0002836">ICM_20948_REG_YA_OFFSET_L</a>, <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[3]);</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#a1be8ebcf9873010af11b8962da3dbb91">ICM_20948_REG_ZA_OFFSET_H</a>, <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[4]);</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#a72251db0c0d0d4ebc9e17abafc5b077c">ICM_20948_REG_ZA_OFFSET_L</a>, <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[5]);</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160; </div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;  <span class="comment">/* Convert the values to G for displaying */</span></div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;  accelBiasScaled[0] = (float) accelBias[0] * accelRes;</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;  accelBiasScaled[1] = (float) accelBias[1] * accelRes;</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;  accelBiasScaled[2] = (float) accelBias[2] * accelRes;</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160; </div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;  <span class="comment">/* Turn off FIFO */</span></div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#a8e84a66c29d07e5d0814f0e01082b9e3">ICM_20948_REG_USER_CTRL</a>, 0x00);</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160; </div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;  <span class="comment">/* Disable all sensors */</span></div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#afafb9e426c5a0c760268db0cffd7f46e">ICM_20948_sensorEnable</a>(<span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160; </div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="pinout_8h.html#a13373833ae00ffd733f408836a1eacc1">ICM_20948_OK</a>;</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="main_8c_source.html#l00122">data</a>, <a class="el" href="delay_8c_source.html#l00116">delay()</a>, <a class="el" href="pinout_8h_source.html#l00289">ICM_20948_ACCEL_BW_246HZ</a>, <a class="el" href="pinout_8h_source.html#l00283">ICM_20948_ACCEL_FULLSCALE_2G</a>, <a class="el" href="_i_c_m20948_8c_source.html#l01192">ICM_20948_accelBandwidthSet()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l01104">ICM_20948_accelFullscaleSet()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l01074">ICM_20948_accelResolutionGet()</a>, <a class="el" href="pinout_8h_source.html#l00202">ICM_20948_BIT_ACCEL_FIFO_EN</a>, <a class="el" href="pinout_8h_source.html#l00123">ICM_20948_BIT_FIFO_EN</a>, <a class="el" href="pinout_8h_source.html#l00203">ICM_20948_BITS_GYRO_FIFO_EN</a>, <a class="el" href="pinout_8h_source.html#l00253">ICM_20948_GYRO_BW_12HZ</a>, <a class="el" href="pinout_8h_source.html#l00242">ICM_20948_GYRO_FULLSCALE_250DPS</a>, <a class="el" href="_i_c_m20948_8c_source.html#l01177">ICM_20948_gyroBandwidthSet()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l01117">ICM_20948_gyroFullscaleSet()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00817">ICM_20948_gyroResolutionGet()</a>, <a class="el" href="pinout_8h_source.html#l00043">ICM_20948_OK</a>, <a class="el" href="pinout_8h_source.html#l00208">ICM_20948_REG_FIFO_COUNT_H</a>, <a class="el" href="pinout_8h_source.html#l00201">ICM_20948_REG_FIFO_EN_2</a>, <a class="el" href="pinout_8h_source.html#l00206">ICM_20948_REG_FIFO_MODE</a>, <a class="el" href="pinout_8h_source.html#l00210">ICM_20948_REG_FIFO_R_W</a>, <a class="el" href="pinout_8h_source.html#l00205">ICM_20948_REG_FIFO_RST</a>, <a class="el" href="pinout_8h_source.html#l00121">ICM_20948_REG_USER_CTRL</a>, <a class="el" href="pinout_8h_source.html#l00222">ICM_20948_REG_XA_OFFSET_H</a>, <a class="el" href="pinout_8h_source.html#l00223">ICM_20948_REG_XA_OFFSET_L</a>, <a class="el" href="pinout_8h_source.html#l00259">ICM_20948_REG_XG_OFFS_USRH</a>, <a class="el" href="pinout_8h_source.html#l00260">ICM_20948_REG_XG_OFFS_USRL</a>, <a class="el" href="pinout_8h_source.html#l00224">ICM_20948_REG_YA_OFFSET_H</a>, <a class="el" href="pinout_8h_source.html#l00225">ICM_20948_REG_YA_OFFSET_L</a>, <a class="el" href="pinout_8h_source.html#l00261">ICM_20948_REG_YG_OFFS_USRH</a>, <a class="el" href="pinout_8h_source.html#l00262">ICM_20948_REG_YG_OFFS_USRL</a>, <a class="el" href="pinout_8h_source.html#l00226">ICM_20948_REG_ZA_OFFSET_H</a>, <a class="el" href="pinout_8h_source.html#l00227">ICM_20948_REG_ZA_OFFSET_L</a>, <a class="el" href="pinout_8h_source.html#l00263">ICM_20948_REG_ZG_OFFS_USRH</a>, <a class="el" href="pinout_8h_source.html#l00264">ICM_20948_REG_ZG_OFFS_USRL</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00654">ICM_20948_registerRead()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00697">ICM_20948_registerWrite()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00898">ICM_20948_sampleRateSet()</a>, and <a class="el" href="_i_c_m20948_8c_source.html#l00999">ICM_20948_sensorEnable()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_i_c_m20948_8c_source.html#l00085">ICM_20948_Init()</a>.</p>

</div>
</div>
<a id="a4c64c7bd58f7e6dafb61fddd98fe9250"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c64c7bd58f7e6dafb61fddd98fe9250">&#9670;&nbsp;</a></span>ICM_20948_accelResolutionGet()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t ICM_20948_accelResolutionGet </td>
          <td>(</td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>accelRes</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l01074">1074</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;{</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;  uint8_t reg;</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160; </div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;  <span class="comment">/* Read the actual acceleration full scale setting */</span></div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#a9f8e3ac3e31a7d1a441e1a8ceb3470c8">ICM_20948_registerRead</a>(<a class="code" href="pinout_8h.html#aa527cd2683d444f64c67228d15c67dfd">ICM_20948_REG_ACCEL_CONFIG</a>, 1, &amp;reg);</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;  reg &amp;= <a class="code" href="pinout_8h.html#a38e7d91cf85ad7c73099aa8c0bdb107a">ICM_20948_MASK_ACCEL_FULLSCALE</a>;</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160; </div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;  <span class="comment">/* Calculate the resolution */</span></div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;  <span class="keywordflow">switch</span> ( reg ) {</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="pinout_8h.html#a846c2742256a4baae9fdeca2d8d31214">ICM_20948_ACCEL_FULLSCALE_2G</a>:</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;      *accelRes = 2.0 / 32768.0;</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160; </div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="pinout_8h.html#a6dfa2dd0acd27971e3fa251fa541fb5b">ICM_20948_ACCEL_FULLSCALE_4G</a>:</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;      *accelRes = 4.0 / 32768.0;</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160; </div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="pinout_8h.html#ae89bf6882283104289a3be37ddfb5880">ICM_20948_ACCEL_FULLSCALE_8G</a>:</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;      *accelRes = 8.0 / 32768.0;</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160; </div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="pinout_8h.html#a1d30f6d19c0cb220ac9109273e7224ee">ICM_20948_ACCEL_FULLSCALE_16G</a>:</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;      *accelRes = 16.0 / 32768.0;</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;  }</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160; </div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="pinout_8h.html#a13373833ae00ffd733f408836a1eacc1">ICM_20948_OK</a>;</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="pinout_8h_source.html#l00286">ICM_20948_ACCEL_FULLSCALE_16G</a>, <a class="el" href="pinout_8h_source.html#l00283">ICM_20948_ACCEL_FULLSCALE_2G</a>, <a class="el" href="pinout_8h_source.html#l00284">ICM_20948_ACCEL_FULLSCALE_4G</a>, <a class="el" href="pinout_8h_source.html#l00285">ICM_20948_ACCEL_FULLSCALE_8G</a>, <a class="el" href="pinout_8h_source.html#l00281">ICM_20948_MASK_ACCEL_FULLSCALE</a>, <a class="el" href="pinout_8h_source.html#l00043">ICM_20948_OK</a>, <a class="el" href="pinout_8h_source.html#l00277">ICM_20948_REG_ACCEL_CONFIG</a>, and <a class="el" href="_i_c_m20948_8c_source.html#l00654">ICM_20948_registerRead()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_i_c_m20948_8c_source.html#l01050">ICM_20948_accelDataRead()</a>, and <a class="el" href="_i_c_m20948_8c_source.html#l01525">ICM_20948_accelGyroCalibrate()</a>.</p>

</div>
</div>
<a id="afca99859e232ac24c63406fb22a8bd46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afca99859e232ac24c63406fb22a8bd46">&#9670;&nbsp;</a></span>ICM_20948_accelSampleRateSet()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float ICM_20948_accelSampleRateSet </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>sampleRate</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l00934">934</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;{</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;  uint16_t accelDiv;</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;  <span class="keywordtype">float</span> accelSampleRate;</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160; </div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;  <span class="comment">/* Calculate the sample rate divider */</span></div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;  accelSampleRate = (1125.0 / sampleRate) - 1.0;</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160; </div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;  <span class="comment">/* Check if it fits in the divider registers */</span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;  <span class="keywordflow">if</span> ( accelSampleRate &gt; 4095.0 ) {</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    accelSampleRate = 4095.0;</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;  }</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160; </div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;  <span class="keywordflow">if</span> ( accelSampleRate &lt; 0 ) {</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    accelSampleRate = 0.0;</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;  }</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160; </div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;  <span class="comment">/* Write the value to the registers */</span></div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;  accelDiv = (uint16_t) accelSampleRate;</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#a9bb6dda54a5d15491c813023b363a7ae">ICM_20948_REG_ACCEL_SMPLRT_DIV_1</a>, (uint8_t) (accelDiv &gt;&gt; 8) );</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#acf0092735df1a1b40aeedcfbb4ea8d8f">ICM_20948_REG_ACCEL_SMPLRT_DIV_2</a>, (uint8_t) (accelDiv &amp; 0xFF) );</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160; </div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;  <span class="comment">/* Calculate the actual sample rate from the divider value */</span></div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;  accelSampleRate = 1125.0 / (accelDiv + 1);</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160; </div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;  <span class="keywordflow">return</span> accelSampleRate;</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="pinout_8h_source.html#l00268">ICM_20948_REG_ACCEL_SMPLRT_DIV_1</a>, <a class="el" href="pinout_8h_source.html#l00269">ICM_20948_REG_ACCEL_SMPLRT_DIV_2</a>, and <a class="el" href="_i_c_m20948_8c_source.html#l00697">ICM_20948_registerWrite()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_i_c_m20948_8c_source.html#l00898">ICM_20948_sampleRateSet()</a>.</p>

</div>
</div>
<a id="aa9c1a0462c03c5af6e1ccff792128450"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa9c1a0462c03c5af6e1ccff792128450">&#9670;&nbsp;</a></span>ICM_20948_bankSelect()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ICM_20948_bankSelect </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>bank</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Select appropriate bank in ICM20948 based on first bits of address. </p>
<dl class="section note"><dt>Note</dt><dd>Works only with I2C</dd></dl>
<p>wBuffer[0] = ICM_20948_REG_BANK_SEL; wBuffer[1] = (bank &lt;&lt; 4);</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">bank</td><td>Register to be read </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l00528">528</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;{</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    uint8_t wBuffer[2];</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    wBuffer[0] = <a class="code" href="pinout_8h.html#a03e8f839a9d7005f414ce4011ed6a8cb">ICM_20948_REG_BANK_SEL</a>;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    wBuffer[1] = (bank &lt;&lt; 4);</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160; </div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <a class="code" href="_i2_c_8c.html#a47431e985fd340e0e1d8a112bfe9ddcc">IIC_WriteBuffer</a>(<a class="code" href="pinout_8h.html#a531e6eb9bdda040f6d5e56a02dec7c36">ICM_20948_I2C_ADDRESS</a>, wBuffer, 2);</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="pinout_8h_source.html#l00026">ICM_20948_I2C_ADDRESS</a>, <a class="el" href="pinout_8h_source.html#l00346">ICM_20948_REG_BANK_SEL</a>, and <a class="el" href="_i2_c_8c_source.html#l00112">IIC_WriteBuffer()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_i_c_m20948_8c_source.html#l00545">ICM_20948_read()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00654">ICM_20948_registerRead()</a>, and <a class="el" href="_i_c_m20948_8c_source.html#l00697">ICM_20948_registerWrite()</a>.</p>

</div>
</div>
<a id="a95260c22db2bcec4bf69a71c967d5667"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95260c22db2bcec4bf69a71c967d5667">&#9670;&nbsp;</a></span>ICM_20948_calibrate_mag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ICM_20948_calibrate_mag </td>
          <td>(</td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>scale</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Magnetometer calibration function. Get magnetometer minimum and maximum values, while moving the device in a figure eight. Those values are then used to cancel out hard and soft iron distortions.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">offset</td><td>Magnetometer XYZ axis hard iron distortion correction. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">scale</td><td>Magnetometer XYZ axis soft iron distortion correction.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>'true' if successful, 'false' on error. </dd></dl>

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l01987">1987</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;                                                          {</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;    int16_t minMag[3];</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;    int16_t maxMag[3];</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;    int32_t sum_mx, sum_my, sum_mz;</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;    int32_t dif_mx, dif_my, dif_mz, dif_m;</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160; </div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;<span class="comment">//    /* Reset hard and soft iron correction before calibration. */</span></div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;    _hxb = 0.0f;</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;    _hyb = 0.0f;</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;    _hzb = 0.0f;</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;    _hxs = 1.0f;</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;    _hys = 1.0f;</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;    _hzs = 1.0f;</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160; </div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;<span class="comment">//    DEBUG_PRINTLN(F(&quot;Calibrating magnetometer. Move the device in a figure eight ...&quot;));</span></div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160; </div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;    <a class="code" href="_i_c_m20948_8c.html#a0d8a914c518d9d869d3e4d9b7afeb672">ICM_20948_min_max_mag</a>( minMag, maxMag );</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160; </div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;    sum_mx = (int32_t) maxMag[0] + minMag[0];</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;    sum_my = (int32_t) maxMag[1] + minMag[1];</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;    sum_mz = (int32_t) maxMag[2] + minMag[2];</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160; </div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;    dif_mx = (int32_t) maxMag[0] - minMag[0];</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;    dif_my = (int32_t) maxMag[1] - minMag[1];</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;    dif_mz = (int32_t) maxMag[2] - minMag[2];</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160; </div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;    offset[0] = -0.5f * sum_mx;</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;    offset[1] = -0.5f * sum_my;</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;    offset[2] = -0.5f * sum_mz;</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160; </div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;    dif_m = (dif_mx + dif_my + dif_mz) / 3;</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160; </div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;    scale[0] = (float) dif_m / dif_mx;</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;    scale[1] = (float) dif_m / dif_my;</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;    scale[2] = (float) dif_m / dif_mz;</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160; </div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;<span class="comment">//    Store offset values in local variables, to be accessable by magread functions</span></div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;    _hxb = offset[0];</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;    _hyb = offset[1];</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;    _hzb = offset[2];</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160; </div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;    _hxs = scale[0];</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;    _hys = scale[1];</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;    _hzs = scale[2];</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160; </div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160; </div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;<span class="comment">//    DEBUG_PRINTLN(F(&quot;Hard iron correction values (center values):&quot;));</span></div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;<span class="comment">//    DEBUG_PRINT2(offset_mx, 1);</span></div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;<span class="comment">//    DEBUG_PRINT(&quot;\t&quot;);</span></div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;<span class="comment">//    DEBUG_PRINT2(offset_my, 1);</span></div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;<span class="comment">//    DEBUG_PRINT(&quot;\t&quot;);</span></div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;<span class="comment">//    DEBUG_PRINT2(offset_mz, 1);</span></div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;<span class="comment">//    DEBUG_PRINT(&quot;\t&quot;);</span></div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;<span class="comment">//    DEBUG_PRINTLN();</span></div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;<span class="comment">//    DEBUG_PRINTLN(F(&quot;Soft iron correction values (scale values):&quot;));</span></div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;<span class="comment">//    DEBUG_PRINT2(scale_mx, 4);</span></div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;<span class="comment">//    DEBUG_PRINT(&quot;\t&quot;);</span></div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;<span class="comment">//    DEBUG_PRINT2(scale_my, 4);</span></div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;<span class="comment">//    DEBUG_PRINT(&quot;\t&quot;);</span></div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;<span class="comment">//    DEBUG_PRINT2(scale_mz, 4);</span></div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;<span class="comment">//    DEBUG_PRINTLN();</span></div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160; </div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="_i_c_m20948_8c_source.html#l00085">ICM_20948_Init()</a>.</p>

</div>
</div>
<a id="a7a337faefa825f447fde6495c735a064"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a337faefa825f447fde6495c735a064">&#9670;&nbsp;</a></span>ICM_20948_check_WhoAmI()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ICM_20948_check_WhoAmI </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check WhoAmI register of ICM20948. </p>
<dl class="section note"><dt>Note</dt><dd>Hangs when WhoAmI is not found or is not correct </dd></dl>

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l00459">459</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;{</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    uint8_t WhoAmI;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="keywordflow">while</span>( WhoAmI != 0xEA )</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    {</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        WhoAmI = <a class="code" href="_i_c_m20948_8c.html#a67648f0e4d9239b0624c22f87a23014c">ICM_20948_read</a>( <a class="code" href="pinout_8h.html#a78784b662e6c45e07b95b3abbaf5889c">ICM_20948_BANK_0</a> | 0x00 );</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    }</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="pinout_8h_source.html#l00070">ICM_20948_BANK_0</a>, and <a class="el" href="_i_c_m20948_8c_source.html#l00545">ICM_20948_read()</a>.</p>

</div>
</div>
<a id="a2e019e8fd51a6ca5c169d3e6ee48542f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e019e8fd51a6ca5c169d3e6ee48542f">&#9670;&nbsp;</a></span>ICM_20948_chipSelectSet()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ICM_20948_chipSelectSet </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>enable</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set chipselect pin for SPI functionality. </p>
<p>Only when using SPI</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">enable</td><td><ul>
<li>'true' - CS pin high </li>
<li>'false' - CS pin low </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l00480">480</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;{</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="keywordflow">if</span> ( enable )</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    {</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        <span class="comment">/* Set CS low (active low) to start transmission */</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;        GPIO_PinOutClear(<a class="code" href="pinout_8h.html#a0cad2c4edc5886780be003d69741ec37">ICM_20948_CS_PORT</a>, <a class="code" href="pinout_8h.html#a5a99e1ad936b41f267baafe25c865afc">ICM_20948_CS_PIN</a>);</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    }</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    {</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        <span class="comment">/* Set CS high (active low) */</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        GPIO_PinOutSet(<a class="code" href="pinout_8h.html#a0cad2c4edc5886780be003d69741ec37">ICM_20948_CS_PORT</a>, <a class="code" href="pinout_8h.html#a5a99e1ad936b41f267baafe25c865afc">ICM_20948_CS_PIN</a>);</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    }</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="pinout_8h_source.html#l00048">ICM_20948_CS_PIN</a>, and <a class="el" href="pinout_8h_source.html#l00049">ICM_20948_CS_PORT</a>.</p>

<p class="reference">Referenced by <a class="el" href="_i_c_m20948_8c_source.html#l00545">ICM_20948_read()</a>.</p>

</div>
</div>
<a id="aa97147c0f9f71cfaea563fb4b1d64306"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa97147c0f9f71cfaea563fb4b1d64306">&#9670;&nbsp;</a></span>ICM_20948_cycleModeEnable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t ICM_20948_cycleModeEnable </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>enable</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l01035">1035</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;{</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;  uint8_t reg;</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160; </div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;  reg = 0x00;</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160; </div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;  <span class="keywordflow">if</span> ( enable ) {</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    reg = <a class="code" href="pinout_8h.html#ad81b648867cec861909b82395796f384">ICM_20948_BIT_ACCEL_CYCLE</a> | <a class="code" href="pinout_8h.html#aaf6de67942c3c78b0272790078630d85">ICM_20948_BIT_GYRO_CYCLE</a>;</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;  }</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160; </div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#a5491921059825463f0139bab0b42d146">ICM_20948_REG_LP_CONFIG</a>, reg);</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160; </div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="pinout_8h.html#a13373833ae00ffd733f408836a1eacc1">ICM_20948_OK</a>;</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="pinout_8h_source.html#l00131">ICM_20948_BIT_ACCEL_CYCLE</a>, <a class="el" href="pinout_8h_source.html#l00132">ICM_20948_BIT_GYRO_CYCLE</a>, <a class="el" href="pinout_8h_source.html#l00043">ICM_20948_OK</a>, <a class="el" href="pinout_8h_source.html#l00129">ICM_20948_REG_LP_CONFIG</a>, and <a class="el" href="_i_c_m20948_8c_source.html#l00697">ICM_20948_registerWrite()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_i_c_m20948_8c_source.html#l00963">ICM_20948_lowPowerModeEnter()</a>, and <a class="el" href="_i_c_m20948_8c_source.html#l01130">ICM_20948_wakeOnMotionITEnable()</a>.</p>

</div>
</div>
<a id="a53932d6c16bbfbfe8603d62195bed2ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53932d6c16bbfbfe8603d62195bed2ea">&#9670;&nbsp;</a></span>ICM_20948_enable_SPI()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ICM_20948_enable_SPI </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>enable</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enables the necessary SPI interface to communicate with ICM20948. </p>
<dl class="section note"><dt>Note</dt><dd>SPI can draw some power</dd>
<dd>
SPI is not used</dd>
<dd>
By setting the GPIO's to 0 state when going to sleep 150 micro A &lt;--&gt; 270 micro A</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">enable</td><td><ul>
<li><code>true</code> - Enable SPI communication. </li>
<li><code>false</code> - Disable SPI communication. </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l00344">344</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;{</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="keywordflow">if</span> (enable)</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    {</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        <span class="comment">/* Enable USART clock and peripheral */</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        CMU_ClockEnable(cmuClock_USART0, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160; </div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        USART_Enable(USART0, usartEnable);</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160; </div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        <span class="comment">/* Configure GPIO */</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        <span class="comment">/* In the case of gpioModePushPull&quot;, the last argument directly sets the pin state */</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        GPIO_PinModeSet(<a class="code" href="pinout_8h.html#a8336d4c1009349fb62b2b41c324df6d4">ICM_20948_CLK_PORT</a>, <a class="code" href="pinout_8h.html#a789cde66e41f680ffdad9150073b52c1">ICM_20948_CLK_PIN</a>, gpioModePushPull, 0); <span class="comment">// US0_CLK is push pull</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        <span class="comment">/* Normally this is gpioPortE: pin 13 */</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        <span class="comment">/* Apparently, can&#39;t use the US0_CS port (PE13) to manually set/clear CS line */</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        GPIO_PinModeSet(<a class="code" href="pinout_8h.html#a0cad2c4edc5886780be003d69741ec37">ICM_20948_CS_PORT</a>, <a class="code" href="pinout_8h.html#a5a99e1ad936b41f267baafe25c865afc">ICM_20948_CS_PIN</a>, gpioModePushPull, 1); <span class="comment">// US0_CS is push pull</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        GPIO_PinModeSet(<a class="code" href="pinout_8h.html#a84e24442a29c6513274636f22615cd2a">ICM_20948_MISO_PORT</a>, <a class="code" href="pinout_8h.html#a902981b99c2eaa27bdc951fbc917e7bb">ICM_20948_MISO_PIN</a>, gpioModeInput, 1);    <span class="comment">// US0_RX (MISO) is input</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        GPIO_PinModeSet(<a class="code" href="pinout_8h.html#aa133915b0d77dca50e7251cc8ee11ab2">ICM_20948_MOSI_PORT</a>, <a class="code" href="pinout_8h.html#a469908674e4f0c229b8fbd8c53f7001e">ICM_20948_MOSI_PIN</a>, gpioModePushPull, 1); <span class="comment">// US0_TX (MOSI) is push pull</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    }</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    {</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        <span class="comment">/* Disable USART clock and peripheral */</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        CMU_ClockEnable(cmuClock_USART0, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160; </div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        USART_Enable(USART0, usartDisable);</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160; </div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        <span class="comment">/* Configure GPIO */</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        <span class="comment">/* In the case of gpioModePushPull&quot;, the last argument directly sets the pin state */</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        GPIO_PinModeSet(<a class="code" href="pinout_8h.html#a8336d4c1009349fb62b2b41c324df6d4">ICM_20948_CLK_PORT</a>, <a class="code" href="pinout_8h.html#a789cde66e41f680ffdad9150073b52c1">ICM_20948_CLK_PIN</a>, gpioModeDisabled, 0); <span class="comment">// US0_CLK is push pull</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        <span class="comment">/* Normally this is gpioPortE: pin 13 */</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        <span class="comment">/* Apparently, can&#39;t use the US0_CS port (PE13) to manually set/clear CS line */</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        GPIO_PinModeSet(<a class="code" href="pinout_8h.html#a0cad2c4edc5886780be003d69741ec37">ICM_20948_CS_PORT</a>, <a class="code" href="pinout_8h.html#a5a99e1ad936b41f267baafe25c865afc">ICM_20948_CS_PIN</a>, gpioModeDisabled, 1); <span class="comment">// US0_CS is push pull</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        GPIO_PinModeSet(<a class="code" href="pinout_8h.html#a84e24442a29c6513274636f22615cd2a">ICM_20948_MISO_PORT</a>, <a class="code" href="pinout_8h.html#a902981b99c2eaa27bdc951fbc917e7bb">ICM_20948_MISO_PIN</a>, gpioModeDisabled, 1);    <span class="comment">// US0_RX (MISO) is input</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        GPIO_PinModeSet(<a class="code" href="pinout_8h.html#aa133915b0d77dca50e7251cc8ee11ab2">ICM_20948_MOSI_PORT</a>, <a class="code" href="pinout_8h.html#a469908674e4f0c229b8fbd8c53f7001e">ICM_20948_MOSI_PIN</a>, gpioModeDisabled, 1); <span class="comment">// US0_TX (MOSI) is push pull</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160; </div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    }</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="pinout_8h_source.html#l00051">ICM_20948_CLK_PIN</a>, <a class="el" href="pinout_8h_source.html#l00052">ICM_20948_CLK_PORT</a>, <a class="el" href="pinout_8h_source.html#l00048">ICM_20948_CS_PIN</a>, <a class="el" href="pinout_8h_source.html#l00049">ICM_20948_CS_PORT</a>, <a class="el" href="pinout_8h_source.html#l00053">ICM_20948_MISO_PIN</a>, <a class="el" href="pinout_8h_source.html#l00054">ICM_20948_MISO_PORT</a>, <a class="el" href="pinout_8h_source.html#l00055">ICM_20948_MOSI_PIN</a>, and <a class="el" href="pinout_8h_source.html#l00056">ICM_20948_MOSI_PORT</a>.</p>

</div>
</div>
<a id="ad7988a26a892dc9f22714fef8005f42e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7988a26a892dc9f22714fef8005f42e">&#9670;&nbsp;</a></span>ICM_20948_gyroBandwidthSet()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t ICM_20948_gyroBandwidthSet </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>gyroBw</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l01177">1177</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;{</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;  uint8_t reg;</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160; </div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;  <span class="comment">/* Read the GYRO_CONFIG_1 register */</span></div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#a9f8e3ac3e31a7d1a441e1a8ceb3470c8">ICM_20948_registerRead</a>(<a class="code" href="pinout_8h.html#ad7223a43f4e8f1389232e6b559209550">ICM_20948_REG_GYRO_CONFIG_1</a>, 1, &amp;reg);</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;  reg &amp;= ~(<a class="code" href="pinout_8h.html#ac06d5a35f573d3861c7bdad67c209250">ICM_20948_MASK_GYRO_BW</a>);</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160; </div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;  <span class="comment">/* Write the new bandwidth value to the gyro config register */</span></div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;  reg |= (gyroBw &amp; <a class="code" href="pinout_8h.html#ac06d5a35f573d3861c7bdad67c209250">ICM_20948_MASK_GYRO_BW</a>);</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#ad7223a43f4e8f1389232e6b559209550">ICM_20948_REG_GYRO_CONFIG_1</a>, reg);</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160; </div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="pinout_8h.html#a13373833ae00ffd733f408836a1eacc1">ICM_20948_OK</a>;</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="pinout_8h_source.html#l00241">ICM_20948_MASK_GYRO_BW</a>, <a class="el" href="pinout_8h_source.html#l00043">ICM_20948_OK</a>, <a class="el" href="pinout_8h_source.html#l00236">ICM_20948_REG_GYRO_CONFIG_1</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00654">ICM_20948_registerRead()</a>, and <a class="el" href="_i_c_m20948_8c_source.html#l00697">ICM_20948_registerWrite()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_i_c_m20948_8c_source.html#l01525">ICM_20948_accelGyroCalibrate()</a>, and <a class="el" href="_i_c_m20948_8c_source.html#l01736">ICM_20948_gyroCalibrate()</a>.</p>

</div>
</div>
<a id="a9adb9bb0176c243589f94aee803a8bb3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9adb9bb0176c243589f94aee803a8bb3">&#9670;&nbsp;</a></span>ICM_20948_gyroCalibrate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t ICM_20948_gyroCalibrate </td>
          <td>(</td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>gyroBiasScaled</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gyroscope calibration function. Reads the gyroscope values while the device is at rest and in level. The resulting values are loaded to the gyro bias registers to cancel the static offset error. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">gyroBiasScaled</td><td>The mesured gyro sensor bias in deg/sec</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns zero on OK, non-zero otherwise </dd></dl>

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l01736">1736</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;{</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;  uint8_t <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[12];</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;  uint16_t i, packetCount, fifoCount;</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;  int32_t gyroBias[3] = { 0, 0, 0 };</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;  int32_t gyroTemp[3];</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;  int32_t gyroBiasStored[3];</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;  <span class="keywordtype">float</span> gyroRes;</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160; </div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;  <span class="comment">/* Enable the accelerometer and the gyro */</span></div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#afafb9e426c5a0c760268db0cffd7f46e">ICM_20948_sensorEnable</a>(<span class="keyword">true</span>, <span class="keyword">true</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160; </div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;  <span class="comment">/* Set 1kHz sample rate */</span></div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#ad640eb781cd8b92ce54c6e51754b36a5">ICM_20948_sampleRateSet</a>(1100.0);</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160; </div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;  <span class="comment">/* Configure bandwidth for gyroscope to 12Hz */</span></div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#ad7988a26a892dc9f22714fef8005f42e">ICM_20948_gyroBandwidthSet</a>(<a class="code" href="pinout_8h.html#ae581a6346270cbca97bf1f8ef1779929">ICM_20948_GYRO_BW_12HZ</a>);</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160; </div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;  <span class="comment">/* Configure sensitivity to 250dps full scale */</span></div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#a128cc4107e5e547f6c9e1c4dd87cfbe8">ICM_20948_gyroFullscaleSet</a>(<a class="code" href="pinout_8h.html#add11763f890c38ef1ee2ec575bde6b04">ICM_20948_GYRO_FULLSCALE_250DPS</a>);</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160; </div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;  <span class="comment">/* Retrieve the resolution per bit */</span></div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#ae6ae090b120ceda0265da1df5a25c185">ICM_20948_gyroResolutionGet</a>(&amp;gyroRes);</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160; </div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;  <span class="comment">/* The accel sensor needs max 30ms, the gyro max 35ms to fully start */</span></div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;  <span class="comment">/* Experiments show that the gyro needs more time to get reliable results */</span></div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;  <a class="code" href="delay_8c.html#adb46f4276f5ddf111153701858f85df6">delay</a>(50);</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160; </div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;  <span class="comment">/* Disable the FIFO */</span></div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#a8e84a66c29d07e5d0814f0e01082b9e3">ICM_20948_REG_USER_CTRL</a>, <a class="code" href="pinout_8h.html#a8cd33f6dc4502e60bb6d1c3a962018e2">ICM_20948_BIT_FIFO_EN</a>);</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#a9440aae0a94561e6eb963b31e808847d">ICM_20948_REG_FIFO_MODE</a>, 0x0F);</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160; </div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;  <span class="comment">/* Enable accelerometer and gyro to store the data in FIFO */</span></div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#adcbd4695e0846db7c093b2346b5a1c99">ICM_20948_REG_FIFO_EN_2</a>, <a class="code" href="pinout_8h.html#a7f2042e7b2ac7ad4fe753558788aca1c">ICM_20948_BITS_GYRO_FIFO_EN</a>);</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160; </div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;  <span class="comment">/* Reset the FIFO */</span></div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#a53aaddcfcc2e63e14abc3bebefc26277">ICM_20948_REG_FIFO_RST</a>, 0x0F);</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#a53aaddcfcc2e63e14abc3bebefc26277">ICM_20948_REG_FIFO_RST</a>, 0x00);</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160; </div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;  <span class="comment">/* Enable the FIFO */</span></div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#a8e84a66c29d07e5d0814f0e01082b9e3">ICM_20948_REG_USER_CTRL</a>, <a class="code" href="pinout_8h.html#a8cd33f6dc4502e60bb6d1c3a962018e2">ICM_20948_BIT_FIFO_EN</a>);</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160; </div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;  <span class="comment">/* The max FIFO size is 4096 bytes, one set of measurements takes 12 bytes */</span></div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;  <span class="comment">/* (3 axes, 2 sensors, 2 bytes each value ) 340 samples use 4080 bytes of FIFO */</span></div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;  <span class="comment">/* Loop until at least 4080 samples gathered */</span></div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;  fifoCount = 0;</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;  <span class="keywordflow">while</span> ( fifoCount &lt; 4080 ) {</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;    <a class="code" href="delay_8c.html#adb46f4276f5ddf111153701858f85df6">delay</a>(5);</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160; </div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;    <span class="comment">/* Read FIFO sample count */</span></div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;    <a class="code" href="_i_c_m20948_8c.html#a9f8e3ac3e31a7d1a441e1a8ceb3470c8">ICM_20948_registerRead</a>(<a class="code" href="pinout_8h.html#a95d2daf38dcdee5ab42ec6b7bb7447e9">ICM_20948_REG_FIFO_COUNT_H</a>, 2, &amp;<a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[0]);</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160; </div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;    <span class="comment">/* Convert to a 16 bit value */</span></div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;    fifoCount = ( (uint16_t) (<a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[0] &lt;&lt; 8) | <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[1]);</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;  }</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160; </div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;  <span class="comment">/* Disable accelerometer and gyro to store the data in FIFO */</span></div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#adcbd4695e0846db7c093b2346b5a1c99">ICM_20948_REG_FIFO_EN_2</a>, 0x00);</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160; </div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;  <span class="comment">/* Read FIFO sample count */</span></div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#a9f8e3ac3e31a7d1a441e1a8ceb3470c8">ICM_20948_registerRead</a>(<a class="code" href="pinout_8h.html#a95d2daf38dcdee5ab42ec6b7bb7447e9">ICM_20948_REG_FIFO_COUNT_H</a>, 2, &amp;<a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[0]);</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160; </div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;  <span class="comment">/* Convert to a 16 bit value */</span></div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;  fifoCount = ( (uint16_t) (<a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[0] &lt;&lt; 8) | <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[1]);</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160; </div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;  <span class="comment">/* Calculate the number of data sets (3 axis of accel an gyro, two bytes each = 12 bytes) */</span></div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;  packetCount = fifoCount / 12;</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160; </div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;  <span class="comment">/* Retrieve the data from the FIFO */</span></div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;  <span class="keywordflow">for</span> ( i = 0; i &lt; packetCount; i++ ) {</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;    <a class="code" href="_i_c_m20948_8c.html#a9f8e3ac3e31a7d1a441e1a8ceb3470c8">ICM_20948_registerRead</a>(<a class="code" href="pinout_8h.html#a00b373a61a80ab610518bd076b53b4d9">ICM_20948_REG_FIFO_R_W</a>, 12, &amp;<a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[0]);</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;    <span class="comment">/* Convert to 16 bit signed accel and gyro x,y and z values */</span></div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;    gyroTemp[0] = ( (int16_t) (<a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[6] &lt;&lt; 8) | <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[7]);</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;    gyroTemp[1] = ( (int16_t) (<a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[8] &lt;&lt; 8) | <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[9]);</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;    gyroTemp[2] = ( (int16_t) (<a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[10] &lt;&lt; 8) | <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[11]);</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160; </div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;    <span class="comment">/* Sum the values */</span></div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;    gyroBias[0] += gyroTemp[0];</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;    gyroBias[1] += gyroTemp[1];</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;    gyroBias[2] += gyroTemp[2];</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;  }</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160; </div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;  <span class="comment">/* Divide by packet count to get the average */</span></div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;  gyroBias[0] /= packetCount;</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;  gyroBias[1] /= packetCount;</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;  gyroBias[2] /= packetCount;</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160; </div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;  <span class="comment">/* Convert the values to degrees per sec for displaying */</span></div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;  gyroBiasScaled[0] = (float) gyroBias[0] * gyroRes;</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;  gyroBiasScaled[1] = (float) gyroBias[1] * gyroRes;</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;  gyroBiasScaled[2] = (float) gyroBias[2] * gyroRes;</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160; </div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;  <span class="comment">/* Read stored gyro trim values. After reset these values are all 0 */</span></div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#a9f8e3ac3e31a7d1a441e1a8ceb3470c8">ICM_20948_registerRead</a>(<a class="code" href="pinout_8h.html#a559f5e3cf33135820776dc875da00766">ICM_20948_REG_XG_OFFS_USRH</a>, 2, &amp;<a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[0]);</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;  gyroBiasStored[0] = ( (int16_t) (<a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[0] &lt;&lt; 8) | <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[1]);</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160; </div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#a9f8e3ac3e31a7d1a441e1a8ceb3470c8">ICM_20948_registerRead</a>(<a class="code" href="pinout_8h.html#aa59a7f4f3f88a8f60e0726224cdfd1d4">ICM_20948_REG_YG_OFFS_USRH</a>, 2, &amp;<a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[0]);</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;  gyroBiasStored[1] = ( (int16_t) (<a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[0] &lt;&lt; 8) | <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[1]);</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160; </div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#a9f8e3ac3e31a7d1a441e1a8ceb3470c8">ICM_20948_registerRead</a>(<a class="code" href="pinout_8h.html#ab8cba5978077c7abf4cfc104c4905da5">ICM_20948_REG_ZG_OFFS_USRH</a>, 2, &amp;<a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[0]);</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;  gyroBiasStored[2] = ( (int16_t) (<a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[0] &lt;&lt; 8) | <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[1]);</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160; </div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;  <span class="comment">/* The gyro bias should be stored in 1000dps full scaled format. We measured in 250dps to get */</span></div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;  <span class="comment">/* the best sensitivity, so need to divide by 4 */</span></div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;  <span class="comment">/* Substract from the stored calibration value */</span></div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;  gyroBiasStored[0] -= gyroBias[0] / 4;</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;  gyroBiasStored[1] -= gyroBias[1] / 4;</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;  gyroBiasStored[2] -= gyroBias[2] / 4;</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160; </div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;  <span class="comment">/* Split the values into two bytes */</span></div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;  <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[0] = (gyroBiasStored[0] &gt;&gt; 8) &amp; 0xFF;</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;  <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[1] = (gyroBiasStored[0]) &amp; 0xFF;</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;  <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[2] = (gyroBiasStored[1] &gt;&gt; 8) &amp; 0xFF;</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;  <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[3] = (gyroBiasStored[1]) &amp; 0xFF;</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;  <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[4] = (gyroBiasStored[2] &gt;&gt; 8) &amp; 0xFF;</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;  <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[5] = (gyroBiasStored[2]) &amp; 0xFF;</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160; </div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;  <span class="comment">/* Write the  gyro bias values to the chip */</span></div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#a559f5e3cf33135820776dc875da00766">ICM_20948_REG_XG_OFFS_USRH</a>, <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[0]);</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#a7cf7d10cffb3c1fce9e43ab116b0f869">ICM_20948_REG_XG_OFFS_USRL</a>, <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[1]);</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#aa59a7f4f3f88a8f60e0726224cdfd1d4">ICM_20948_REG_YG_OFFS_USRH</a>, <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[2]);</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#a5ebf48f2fe9665273b6985b18ecd1c79">ICM_20948_REG_YG_OFFS_USRL</a>, <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[3]);</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#ab8cba5978077c7abf4cfc104c4905da5">ICM_20948_REG_ZG_OFFS_USRH</a>, <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[4]);</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#ae987da54cf2c6dfac776c7c1796da068">ICM_20948_REG_ZG_OFFS_USRL</a>, <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[5]);</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160; </div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;  <span class="comment">/* Turn off FIFO */</span></div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#a8e84a66c29d07e5d0814f0e01082b9e3">ICM_20948_REG_USER_CTRL</a>, 0x00);</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160; </div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;  <span class="comment">/* Disable all sensors */</span></div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#afafb9e426c5a0c760268db0cffd7f46e">ICM_20948_sensorEnable</a>(<span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160; </div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="pinout_8h.html#a13373833ae00ffd733f408836a1eacc1">ICM_20948_OK</a>;</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="main_8c_source.html#l00122">data</a>, <a class="el" href="delay_8c_source.html#l00116">delay()</a>, <a class="el" href="pinout_8h_source.html#l00123">ICM_20948_BIT_FIFO_EN</a>, <a class="el" href="pinout_8h_source.html#l00203">ICM_20948_BITS_GYRO_FIFO_EN</a>, <a class="el" href="pinout_8h_source.html#l00253">ICM_20948_GYRO_BW_12HZ</a>, <a class="el" href="pinout_8h_source.html#l00242">ICM_20948_GYRO_FULLSCALE_250DPS</a>, <a class="el" href="_i_c_m20948_8c_source.html#l01177">ICM_20948_gyroBandwidthSet()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l01117">ICM_20948_gyroFullscaleSet()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00817">ICM_20948_gyroResolutionGet()</a>, <a class="el" href="pinout_8h_source.html#l00043">ICM_20948_OK</a>, <a class="el" href="pinout_8h_source.html#l00208">ICM_20948_REG_FIFO_COUNT_H</a>, <a class="el" href="pinout_8h_source.html#l00201">ICM_20948_REG_FIFO_EN_2</a>, <a class="el" href="pinout_8h_source.html#l00206">ICM_20948_REG_FIFO_MODE</a>, <a class="el" href="pinout_8h_source.html#l00210">ICM_20948_REG_FIFO_R_W</a>, <a class="el" href="pinout_8h_source.html#l00205">ICM_20948_REG_FIFO_RST</a>, <a class="el" href="pinout_8h_source.html#l00121">ICM_20948_REG_USER_CTRL</a>, <a class="el" href="pinout_8h_source.html#l00259">ICM_20948_REG_XG_OFFS_USRH</a>, <a class="el" href="pinout_8h_source.html#l00260">ICM_20948_REG_XG_OFFS_USRL</a>, <a class="el" href="pinout_8h_source.html#l00261">ICM_20948_REG_YG_OFFS_USRH</a>, <a class="el" href="pinout_8h_source.html#l00262">ICM_20948_REG_YG_OFFS_USRL</a>, <a class="el" href="pinout_8h_source.html#l00263">ICM_20948_REG_ZG_OFFS_USRH</a>, <a class="el" href="pinout_8h_source.html#l00264">ICM_20948_REG_ZG_OFFS_USRL</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00654">ICM_20948_registerRead()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00697">ICM_20948_registerWrite()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00898">ICM_20948_sampleRateSet()</a>, and <a class="el" href="_i_c_m20948_8c_source.html#l00999">ICM_20948_sensorEnable()</a>.</p>

</div>
</div>
<a id="ae9f4be3cc42a20a835c115c7d1fa3b97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9f4be3cc42a20a835c115c7d1fa3b97">&#9670;&nbsp;</a></span>ICM_20948_gyroDataRead()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t ICM_20948_gyroDataRead </td>
          <td>(</td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>gyro</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read gyroscope data from IMU. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">gyro</td><td>pointer to store data </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l00783">783</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;{</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;  uint8_t rawData[6];</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;  <span class="keywordtype">float</span> gyroRes;</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;  int16_t temp;</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160; </div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;  <span class="comment">/* Retrieve the current resolution */</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#ae6ae090b120ceda0265da1df5a25c185">ICM_20948_gyroResolutionGet</a>(&amp;gyroRes);</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160; </div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;  <span class="comment">/* Read the six raw data registers into data array */</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#a9f8e3ac3e31a7d1a441e1a8ceb3470c8">ICM_20948_registerRead</a>(<a class="code" href="pinout_8h.html#a0016198ccf5ca2b7f41d7a23e6554373">GYRO_XOUT_H</a>, 6, &amp;rawData[0]);</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160; </div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;  <span class="comment">/* Convert the MSB and LSB into a signed 16-bit value and multiply by the resolution to get the dps value */</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;  temp = ( (int16_t) rawData[0] &lt;&lt; 8) | rawData[1];</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;  gyro[0] = (float) temp * gyroRes;</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;  temp = ( (int16_t) rawData[2] &lt;&lt; 8) | rawData[3];</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;  gyro[1] = (float) temp * gyroRes;</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;  temp = ( (int16_t) rawData[4] &lt;&lt; 8) | rawData[5];</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;  gyro[2] = (float) temp * gyroRes;</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160; </div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="pinout_8h.html#a13373833ae00ffd733f408836a1eacc1">ICM_20948_OK</a>;</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="pinout_8h_source.html#l00082">GYRO_XOUT_H</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00817">ICM_20948_gyroResolutionGet()</a>, <a class="el" href="pinout_8h_source.html#l00043">ICM_20948_OK</a>, and <a class="el" href="_i_c_m20948_8c_source.html#l00654">ICM_20948_registerRead()</a>.</p>

<p class="reference">Referenced by <a class="el" href="main_8c_source.html#l00234">measure_send()</a>.</p>

</div>
</div>
<a id="a128cc4107e5e547f6c9e1c4dd87cfbe8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a128cc4107e5e547f6c9e1c4dd87cfbe8">&#9670;&nbsp;</a></span>ICM_20948_gyroFullscaleSet()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t ICM_20948_gyroFullscaleSet </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>gyroFs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l01117">1117</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;{</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;  uint8_t reg;</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160; </div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;  gyroFs &amp;= <a class="code" href="pinout_8h.html#ac259a86b42bae1a0c3d82eda232c23ab">ICM_20948_MASK_GYRO_FULLSCALE</a>;</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#a9f8e3ac3e31a7d1a441e1a8ceb3470c8">ICM_20948_registerRead</a>(<a class="code" href="pinout_8h.html#ad7223a43f4e8f1389232e6b559209550">ICM_20948_REG_GYRO_CONFIG_1</a>, 1, &amp;reg);</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;  reg &amp;= ~(<a class="code" href="pinout_8h.html#ac259a86b42bae1a0c3d82eda232c23ab">ICM_20948_MASK_GYRO_FULLSCALE</a>);</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;  reg |= gyroFs;</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#ad7223a43f4e8f1389232e6b559209550">ICM_20948_REG_GYRO_CONFIG_1</a>, reg);</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160; </div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="pinout_8h.html#a13373833ae00ffd733f408836a1eacc1">ICM_20948_OK</a>;</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="pinout_8h_source.html#l00240">ICM_20948_MASK_GYRO_FULLSCALE</a>, <a class="el" href="pinout_8h_source.html#l00043">ICM_20948_OK</a>, <a class="el" href="pinout_8h_source.html#l00236">ICM_20948_REG_GYRO_CONFIG_1</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00654">ICM_20948_registerRead()</a>, and <a class="el" href="_i_c_m20948_8c_source.html#l00697">ICM_20948_registerWrite()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_i_c_m20948_8c_source.html#l01525">ICM_20948_accelGyroCalibrate()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l01736">ICM_20948_gyroCalibrate()</a>, and <a class="el" href="_i_c_m20948_8c_source.html#l00169">ICM_20948_Init2()</a>.</p>

</div>
</div>
<a id="ae6ae090b120ceda0265da1df5a25c185"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6ae090b120ceda0265da1df5a25c185">&#9670;&nbsp;</a></span>ICM_20948_gyroResolutionGet()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t ICM_20948_gyroResolutionGet </td>
          <td>(</td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>gyroRes</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set gyro resolution. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">[in/out]</td><td>gyroRes gyro resulution input gyro actual resolution output </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l00817">817</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;{</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;  uint8_t reg;</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160; </div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;  <span class="comment">/* Read the actual gyroscope full scale setting */</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#a9f8e3ac3e31a7d1a441e1a8ceb3470c8">ICM_20948_registerRead</a>(<a class="code" href="pinout_8h.html#ad7223a43f4e8f1389232e6b559209550">ICM_20948_REG_GYRO_CONFIG_1</a>, 1, &amp;reg);</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;  reg &amp;= <a class="code" href="pinout_8h.html#ac259a86b42bae1a0c3d82eda232c23ab">ICM_20948_MASK_GYRO_FULLSCALE</a>;</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160; </div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;  <span class="comment">/* Calculate the resolution */</span></div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;  <span class="keywordflow">switch</span> ( reg ) {</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="pinout_8h.html#add11763f890c38ef1ee2ec575bde6b04">ICM_20948_GYRO_FULLSCALE_250DPS</a>:</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;      *gyroRes = 250.0 / 32768.0;</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160; </div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="pinout_8h.html#a87f6d7ff993213f7739193e6428345c4">ICM_20948_GYRO_FULLSCALE_500DPS</a>:</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;      *gyroRes = 500.0 / 32768.0;</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160; </div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="pinout_8h.html#a03229ea158a1c4d062ba339eeed45e31">ICM_20948_GYRO_FULLSCALE_1000DPS</a>:</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;      *gyroRes = 1000.0 / 32768.0;</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160; </div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="pinout_8h.html#aaf8b8308b248e140d63fe8e0d91c771c">ICM_20948_GYRO_FULLSCALE_2000DPS</a>:</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;      *gyroRes = 2000.0 / 32768.0;</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;  }</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160; </div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="pinout_8h.html#a13373833ae00ffd733f408836a1eacc1">ICM_20948_OK</a>;</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="pinout_8h_source.html#l00244">ICM_20948_GYRO_FULLSCALE_1000DPS</a>, <a class="el" href="pinout_8h_source.html#l00245">ICM_20948_GYRO_FULLSCALE_2000DPS</a>, <a class="el" href="pinout_8h_source.html#l00242">ICM_20948_GYRO_FULLSCALE_250DPS</a>, <a class="el" href="pinout_8h_source.html#l00243">ICM_20948_GYRO_FULLSCALE_500DPS</a>, <a class="el" href="pinout_8h_source.html#l00240">ICM_20948_MASK_GYRO_FULLSCALE</a>, <a class="el" href="pinout_8h_source.html#l00043">ICM_20948_OK</a>, <a class="el" href="pinout_8h_source.html#l00236">ICM_20948_REG_GYRO_CONFIG_1</a>, and <a class="el" href="_i_c_m20948_8c_source.html#l00654">ICM_20948_registerRead()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_i_c_m20948_8c_source.html#l01525">ICM_20948_accelGyroCalibrate()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l01736">ICM_20948_gyroCalibrate()</a>, and <a class="el" href="_i_c_m20948_8c_source.html#l00783">ICM_20948_gyroDataRead()</a>.</p>

</div>
</div>
<a id="a2a480bb1caa28241f1cc1e77a3445961"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a480bb1caa28241f1cc1e77a3445961">&#9670;&nbsp;</a></span>ICM_20948_gyroSampleRateSet()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float ICM_20948_gyroSampleRateSet </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>sampleRate</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l00907">907</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;{</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;  uint8_t gyroDiv;</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;  <span class="keywordtype">float</span> gyroSampleRate;</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160; </div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;  <span class="comment">/* Calculate the sample rate divider */</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;  gyroSampleRate = (1125.0 / sampleRate) - 1.0;</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160; </div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;  <span class="comment">/* Check if it fits in the divider register */</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;  <span class="keywordflow">if</span> ( gyroSampleRate &gt; 255.0 ) {</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    gyroSampleRate = 255.0;</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;  }</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160; </div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;  <span class="keywordflow">if</span> ( gyroSampleRate &lt; 0 ) {</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    gyroSampleRate = 0.0;</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;  }</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160; </div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;  <span class="comment">/* Write the value to the register */</span></div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;  gyroDiv = (uint8_t) gyroSampleRate;</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#ab3282b1476aecb42bb3863432bbc7221">ICM_20948_REG_GYRO_SMPLRT_DIV</a>, gyroDiv);</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160; </div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;  <span class="comment">/* Calculate the actual sample rate from the divider value */</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;  gyroSampleRate = 1125.0 / (gyroDiv + 1);</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160; </div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;  <span class="keywordflow">return</span> gyroSampleRate;</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="pinout_8h_source.html#l00234">ICM_20948_REG_GYRO_SMPLRT_DIV</a>, and <a class="el" href="_i_c_m20948_8c_source.html#l00697">ICM_20948_registerWrite()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_i_c_m20948_8c_source.html#l00898">ICM_20948_sampleRateSet()</a>.</p>

</div>
</div>
<a id="abe547d7b034f54274da0607f457f2ac2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe547d7b034f54274da0607f457f2ac2">&#9670;&nbsp;</a></span>ICM_20948_Init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ICM_20948_Init </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Init function for ICM20948. </p>
<p>I2C init Power on IMU Reset IMU Init 2 Calibrate Gyro + Accel Calibrate Magn </p>

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l00085">85</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;{</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="comment">/* Enable GPIO clock in order to set pin states */</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    CMU_ClockEnable(cmuClock_HFPER, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    CMU_ClockEnable(cmuClock_GPIO, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <a class="code" href="delay_8c.html#adb46f4276f5ddf111153701858f85df6">delay</a>(10);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="comment">/* Setup SPI / IIC interface for ICM_20948 */</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="comment">/* Comment / Uncomment to select */</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="comment">//ICM_20948_Init_SPI();</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <a class="code" href="_i2_c_8c.html#adc2aa003a8bc13c866e90661fa908189">IIC_Init</a>();</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <a class="code" href="delay_8c.html#adb46f4276f5ddf111153701858f85df6">delay</a>(10);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="comment">/* Power the ICM_20948 */</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <a class="code" href="_i_c_m20948_8c.html#ace147474f6cfc16fee8390c478b66b5e">ICM_20948_power</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <a class="code" href="delay_8c.html#adb46f4276f5ddf111153701858f85df6">delay</a>(200);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="comment">/* Reset ICM_20948, just to be sure */</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <a class="code" href="_i_c_m20948_8c.html#a32e5e81e275f3fecca06ca62cccd8ad5">ICM_20948_reset</a>();</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <a class="code" href="delay_8c.html#adb46f4276f5ddf111153701858f85df6">delay</a>(100); <span class="comment">// 100ms delay needed for reset sequence</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <a class="code" href="_i_c_m20948_8c.html#a784752c7cf3630129dfd34f57cc5b440">ICM_20948_Init2</a>();</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="preprocessor">#if DIY == 0</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    BSP_LedSet(0);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="comment">/* CALIBRATION */</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;     <span class="keywordtype">float</span> accelCal[3];</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;     <span class="keywordtype">float</span> gyroCal[3];</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;     <span class="keywordtype">float</span> magOffset[3];</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;     <span class="keywordtype">float</span> magScale[3];</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;     <a class="code" href="_i_c_m20948_8c.html#ad503b9efac873146ca6401db153afe3e">ICM_20948_accelGyroCalibrate</a>( accelCal, gyroCal );</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160; </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="preprocessor">#if DIY == 0</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;     BSP_LedClear(0);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="preprocessor">#if DIY == 0</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    BSP_LedSet(1);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <a class="code" href="_i_c_m20948_8c.html#a784752c7cf3630129dfd34f57cc5b440">ICM_20948_Init2</a>();</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="preprocessor">#if DIY == 1</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    GPIO_PinModeSet(<a class="code" href="pinout_8h.html#a663daa01e565aee93c6f20c5845b90b4">LED_PORT</a>, <a class="code" href="pinout_8h.html#ab4553be4db9860d940f81d7447173b2f">LED_PIN</a>, gpioModePushPull, 0);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    GPIO_PinOutSet(<a class="code" href="pinout_8h.html#a663daa01e565aee93c6f20c5845b90b4">LED_PORT</a>, <a class="code" href="pinout_8h.html#ab4553be4db9860d940f81d7447173b2f">LED_PIN</a>);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    uint8_t temp[1];</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <a class="code" href="_i_c_m20948_8c.html#ae81d4cfd5ba0ab7962bdc2ad2c002468">ICM_20948_set_mag_mode</a>(<a class="code" href="pinout_8h.html#a73c721aa21e9714bd8f15150994975d1">AK09916_MODE_100HZ</a>);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <a class="code" href="delay_8c.html#adb46f4276f5ddf111153701858f85df6">delay</a>(100);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <a class="code" href="_i_c_m20948_8c.html#afa39af5c47122519a8bed2bcafd5ee06">ICM_20948_read_mag_register</a>(0x31, 1, temp);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <a class="code" href="_i_c_m20948_8c.html#afa39af5c47122519a8bed2bcafd5ee06">ICM_20948_read_mag_register</a>(0x11, 8, temp);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <a class="code" href="_i_c_m20948_8c.html#a95260c22db2bcec4bf69a71c967d5667">ICM_20948_calibrate_mag</a>( magOffset, magScale );</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="preprocessor">#if DIY == 1</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    GPIO_PinOutClear(<a class="code" href="pinout_8h.html#a663daa01e565aee93c6f20c5845b90b4">LED_PORT</a>, <a class="code" href="pinout_8h.html#ab4553be4db9860d940f81d7447173b2f">LED_PIN</a>);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    GPIO_PinModeSet(<a class="code" href="pinout_8h.html#a663daa01e565aee93c6f20c5845b90b4">LED_PORT</a>, <a class="code" href="pinout_8h.html#ab4553be4db9860d940f81d7447173b2f">LED_PIN</a>, gpioModeDisabled, 0);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="preprocessor">#if DIY == 0</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    BSP_LedClear(1);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160; </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <a class="code" href="_i_c_m20948_8c.html#ae523984fd59c5831b8ec8ee73ca1a0b5">ICM_20948_Initialized</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="pinout_8h_source.html#l00389">AK09916_MODE_100HZ</a>, <a class="el" href="delay_8c_source.html#l00116">delay()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l01525">ICM_20948_accelGyroCalibrate()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l01987">ICM_20948_calibrate_mag()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00169">ICM_20948_Init2()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00040">ICM_20948_Initialized</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00392">ICM_20948_power()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l01354">ICM_20948_read_mag_register()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00762">ICM_20948_reset()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l01416">ICM_20948_set_mag_mode()</a>, <a class="el" href="_i2_c_8c_source.html#l00052">IIC_Init()</a>, <a class="el" href="pinout_8h_source.html#l00021">LED_PIN</a>, and <a class="el" href="pinout_8h_source.html#l00020">LED_PORT</a>.</p>

</div>
</div>
<a id="a784752c7cf3630129dfd34f57cc5b440"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a784752c7cf3630129dfd34f57cc5b440">&#9670;&nbsp;</a></span>ICM_20948_Init2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ICM_20948_Init2 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Second init function for ICM20948, use when waking from sleep. </p>
<p>Set sample rates, bandwidths, check whoAmI, enable sensors </p>

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l00169">169</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;{</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160; </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <span class="comment">/* Auto select best available clock source PLL if ready, else use internal oscillator */</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#a8a5e88ca0ad999c59cc428b8656d4bc1">ICM_20948_REG_PWR_MGMT_1</a>, <a class="code" href="pinout_8h.html#a8e9a5640699c35a0fee78b5013c31cfd">ICM_20948_BIT_CLK_PLL</a>);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <span class="comment">/* PLL startup time - no spec in data sheet */</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <a class="code" href="delay_8c.html#adb46f4276f5ddf111153701858f85df6">delay</a>(30);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        <span class="comment">/* Reset I2C Slave module and use SPI */</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <span class="comment">/* Enable I2C Master I/F module */</span>                  <span class="comment">/* ICM_20948_BIT_I2C_IF_DIS om te vermijden dat toch I2C zal gebruikt worden */</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <span class="comment">//ICM_20948_registerWrite(ICM_20948_REG_USER_CTRL, ICM_20948_BIT_I2C_MST_EN);//ICM_20948_BIT_I2C_IF_DIS | ICM_20948_BIT_I2C_MST_EN);</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <span class="comment">/* Set I2C Master clock frequency */</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        <span class="comment">//ICM_20948_registerWrite(ICM_20948_REG_I2C_MST_CTRL, ICM_20948_I2C_MST_CTRL_CLK_400KHZ);</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160; </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        uint8_t temp[8];</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160; </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        <span class="comment">/* Read ICM20948 &quot;Who am I&quot; register */</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        <a class="code" href="_i_c_m20948_8c.html#a9f8e3ac3e31a7d1a441e1a8ceb3470c8">ICM_20948_registerRead</a>(<a class="code" href="pinout_8h.html#a15d711ac3d5e10d14ff4cb66dd643ec4">ICM_20948_REG_WHO_AM_I</a>, 1, temp);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160; </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        <span class="comment">/* Check if &quot;Who am I&quot; register was successfully read */</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        <span class="keywordflow">if</span> (temp[0] == <a class="code" href="pinout_8h.html#a5289e29f8f2c93a7bdc2bcad610e3f89">ICM20948_DEVICE_ID</a>) {</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="preprocessor">    #if DEBUG_DBPRINT == 1 </span><span class="comment">/* DEBUG_DBPRINT */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            <a class="code" href="dbprint_8h.html#a48c1f5d07dde14219473ff6a89a3f7ba">dbprint</a>(<span class="stringliteral">&quot;ICM20948 WHOAMI OKE&quot;</span>);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="preprocessor">    #endif </span><span class="comment">/* DEBUG_DBPRINT */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160; </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        }</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160; </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160; </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        <span class="comment">/* Make sure ICM_20948 is not in sleep mode */</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <a class="code" href="_i_c_m20948_8c.html#a8f1159f4f75b1eaed9a091d01fe76c3d">ICM_20948_sleepModeEnable</a>( <span class="keyword">false</span> );</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        <span class="comment">/* Enable all ICM_20948 sensors */</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <a class="code" href="_i_c_m20948_8c.html#afafb9e426c5a0c760268db0cffd7f46e">ICM_20948_sensorEnable</a>(<span class="keyword">true</span>, <span class="keyword">true</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        <a class="code" href="delay_8c.html#adb46f4276f5ddf111153701858f85df6">delay</a>(10);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        <span class="comment">/* Set ICM_20948 gyro and accel sample rate to 75Hz */</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        <a class="code" href="_i_c_m20948_8c.html#ad640eb781cd8b92ce54c6e51754b36a5">ICM_20948_sampleRateSet</a>(50);</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160; </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        <span class="comment">/* Set full scale range: gyro &amp; accel */</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        <a class="code" href="_i_c_m20948_8c.html#a128cc4107e5e547f6c9e1c4dd87cfbe8">ICM_20948_gyroFullscaleSet</a>(<a class="code" href="pinout_8h.html#aaf8b8308b248e140d63fe8e0d91c771c">ICM_20948_GYRO_FULLSCALE_2000DPS</a>);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        <a class="code" href="_i_c_m20948_8c.html#a1d964813062ec77bcd52135dab29654d">ICM_20948_accelFullscaleSet</a>(<a class="code" href="pinout_8h.html#a6dfa2dd0acd27971e3fa251fa541fb5b">ICM_20948_ACCEL_FULLSCALE_4G</a>);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160; </div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <span class="comment">/* Setup 50us interrupt */</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <a class="code" href="_i_c_m20948_8c.html#ab79679ad6161de947d8bfb16a34b4187">ICM_20948_latchEnable</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160; </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        <span class="comment">// TODO: Bandwidth gyro + accel</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        <span class="comment">// Standard low pass filters are enabled</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">//      ICM_20948_accelBandwidthSet( ICM_20948_ACCEL_BW_1210HZ );</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">//      ICM_20948_gyroBandwidthSet( ICM_20948_GYRO_BW_120HZ );</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160; </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        <span class="comment">/* Auto select best available clock source PLL if ready, else use internal oscillator */</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#a8a5e88ca0ad999c59cc428b8656d4bc1">ICM_20948_REG_PWR_MGMT_1</a>, <a class="code" href="pinout_8h.html#a8e9a5640699c35a0fee78b5013c31cfd">ICM_20948_BIT_CLK_PLL</a>);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        <a class="code" href="delay_8c.html#adb46f4276f5ddf111153701858f85df6">delay</a>(30);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160; </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        <span class="comment">/* Magnetometer */</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        <span class="comment">/* IIC passtrough: magnetometer can be accessed on IIC bus */</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#af1f87a2f8a403005c59d91e6085fcd18">ICM_20948_REG_INT_PIN_CFG</a>, 0x02);</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <a class="code" href="delay_8c.html#adb46f4276f5ddf111153701858f85df6">delay</a>(10);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160; </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        <span class="comment">/* Reset magnetometer */</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        <a class="code" href="_i_c_m20948_8c.html#a7ed83e84f5d14637ea91c05174e84dcd">ICM_20948_write_mag_register</a>(0x32, 0x01);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        <a class="code" href="delay_8c.html#adb46f4276f5ddf111153701858f85df6">delay</a>(100); <span class="comment">// reset takes 100ms</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160; </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        <span class="comment">/* Read AK09916 &quot;Who am I&quot; register */</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        <a class="code" href="_i_c_m20948_8c.html#afa39af5c47122519a8bed2bcafd5ee06">ICM_20948_read_mag_register</a>(<a class="code" href="pinout_8h.html#a9686a67d02b1d84561f98fed7c93bfd6">AK09916_REG_WHO_AM_I</a>, 1, temp);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <span class="comment">/* Check if AK09916 &quot;Who am I&quot; register was successfully read */</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        <span class="keywordflow">if</span> (temp[0] == <a class="code" href="pinout_8h.html#a9c748891e6a5448e0b676ab17651de8c">AK09916_DEVICE_ID</a>) {</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="preprocessor">    #if DEBUG_DBPRINT == 1 </span><span class="comment">/* DEBUG_DBPRINT */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;            <a class="code" href="dbprint_8h.html#a48c1f5d07dde14219473ff6a89a3f7ba">dbprint</a>(<span class="stringliteral">&quot;AK09916 WHOAMI OKE&quot;</span>);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="preprocessor">    #endif </span><span class="comment">/* DEBUG_DBPRINT */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160; </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        }</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160; </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        <span class="comment">/* Configure magnetometer */</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        <a class="code" href="_i_c_m20948_8c.html#ae81d4cfd5ba0ab7962bdc2ad2c002468">ICM_20948_set_mag_mode</a>(<a class="code" href="pinout_8h.html#a160112184cf205149c6cebe1cdc77a4a">AK09916_MODE_50HZ</a>);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        <a class="code" href="delay_8c.html#adb46f4276f5ddf111153701858f85df6">delay</a>(10);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        <a class="code" href="_i_c_m20948_8c.html#afa39af5c47122519a8bed2bcafd5ee06">ICM_20948_read_mag_register</a>(0x31, 1, temp);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        <span class="comment">/* Update data by reading through till ST2 register */</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        <a class="code" href="_i_c_m20948_8c.html#afa39af5c47122519a8bed2bcafd5ee06">ICM_20948_read_mag_register</a>(0x11, 8, temp);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160; </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160; </div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160; </div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="comment">//  /* Set interrupt to trigger every 100ms when the data is ready */</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="comment">//  IMU_MEASURING = true;</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="comment">//  ICM_20948_interruptEnable(true, false);</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160; </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="pinout_8h_source.html#l00368">AK09916_DEVICE_ID</a>, <a class="el" href="pinout_8h_source.html#l00388">AK09916_MODE_50HZ</a>, <a class="el" href="pinout_8h_source.html#l00395">AK09916_REG_WHO_AM_I</a>, <a class="el" href="dbprint_8h.html#a48c1f5d07dde14219473ff6a89a3f7ba">dbprint()</a>, <a class="el" href="delay_8c_source.html#l00116">delay()</a>, <a class="el" href="pinout_8h_source.html#l00351">ICM20948_DEVICE_ID</a>, <a class="el" href="pinout_8h_source.html#l00284">ICM_20948_ACCEL_FULLSCALE_4G</a>, <a class="el" href="_i_c_m20948_8c_source.html#l01104">ICM_20948_accelFullscaleSet()</a>, <a class="el" href="pinout_8h_source.html#l00139">ICM_20948_BIT_CLK_PLL</a>, <a class="el" href="pinout_8h_source.html#l00245">ICM_20948_GYRO_FULLSCALE_2000DPS</a>, <a class="el" href="_i_c_m20948_8c_source.html#l01117">ICM_20948_gyroFullscaleSet()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l01219">ICM_20948_latchEnable()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l01354">ICM_20948_read_mag_register()</a>, <a class="el" href="pinout_8h_source.html#l00146">ICM_20948_REG_INT_PIN_CFG</a>, <a class="el" href="pinout_8h_source.html#l00134">ICM_20948_REG_PWR_MGMT_1</a>, <a class="el" href="pinout_8h_source.html#l00119">ICM_20948_REG_WHO_AM_I</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00654">ICM_20948_registerRead()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00697">ICM_20948_registerWrite()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00898">ICM_20948_sampleRateSet()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00999">ICM_20948_sensorEnable()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l01416">ICM_20948_set_mag_mode()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00728">ICM_20948_sleepModeEnable()</a>, and <a class="el" href="_i_c_m20948_8c_source.html#l01408">ICM_20948_write_mag_register()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_i_c_m20948_8c_source.html#l00085">ICM_20948_Init()</a>.</p>

</div>
</div>
<a id="af59bec74c2be5e0172d4c43b99ec9c4c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af59bec74c2be5e0172d4c43b99ec9c4c">&#9670;&nbsp;</a></span>ICM_20948_Init_SPI()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ICM_20948_Init_SPI </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initiate SPI functionality for ICM20948. </p>
<dl class="section note"><dt>Note</dt><dd>SPI not used </dd></dl>

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l00273">273</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;{</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160; </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">      /*****************************/</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160; </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      <span class="comment">/* Enable necessary clocks */</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        CMU_ClockEnable(cmuClock_HFPER, <span class="keyword">true</span>); <span class="comment">/* GPIO and USART0/1 are High Frequency Peripherals */</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        CMU_ClockEnable(cmuClock_GPIO, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        CMU_ClockEnable(cmuClock_USART0, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160; </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        <span class="comment">/* Configure GPIO */</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        <span class="comment">/* In the case of gpioModePushPull&quot;, the last argument directly sets the pin state */</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        GPIO_PinModeSet(<a class="code" href="pinout_8h.html#a8336d4c1009349fb62b2b41c324df6d4">ICM_20948_CLK_PORT</a>, <a class="code" href="pinout_8h.html#a789cde66e41f680ffdad9150073b52c1">ICM_20948_CLK_PIN</a>, gpioModePushPull, 0); <span class="comment">// US0_CLK is push pull</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        <span class="comment">/* Normally this is gpioPortE: pin 13 */</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        <span class="comment">/* Apparently, can&#39;t use the US0_CS port (PE13) to manually set/clear CS line */</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        GPIO_PinModeSet(<a class="code" href="pinout_8h.html#a0cad2c4edc5886780be003d69741ec37">ICM_20948_CS_PORT</a>, <a class="code" href="pinout_8h.html#a5a99e1ad936b41f267baafe25c865afc">ICM_20948_CS_PIN</a>, gpioModePushPull, 1); <span class="comment">// US0_CS is push pull</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        GPIO_PinModeSet(<a class="code" href="pinout_8h.html#a84e24442a29c6513274636f22615cd2a">ICM_20948_MISO_PORT</a>, <a class="code" href="pinout_8h.html#a902981b99c2eaa27bdc951fbc917e7bb">ICM_20948_MISO_PIN</a>, gpioModeInput, 1);    <span class="comment">// US0_RX (MISO) is input</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        GPIO_PinModeSet(<a class="code" href="pinout_8h.html#aa133915b0d77dca50e7251cc8ee11ab2">ICM_20948_MOSI_PORT</a>, <a class="code" href="pinout_8h.html#a469908674e4f0c229b8fbd8c53f7001e">ICM_20948_MOSI_PIN</a>, gpioModePushPull, 1); <span class="comment">// US0_TX (MOSI) is push pull</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160; </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <span class="comment">// Start with default config, then modify as necessary</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;          USART_InitSync_TypeDef config = USART_INITSYNC_DEFAULT;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;          config.master       = <span class="keyword">true</span>;            <span class="comment">// master mode</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;          <span class="comment">//config.baudrate     = 1000000;         // CLK freq is 1 MHz</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;          config.autoCsEnable = <span class="keyword">true</span>;            <span class="comment">// CS pin controlled by hardware, not firmware</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;          config.clockMode    = usartClockMode0; <span class="comment">// clock idle low, sample on rising/first edge</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;          config.msbf         = <span class="keyword">true</span>;            <span class="comment">// send MSB first</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;          config.enable       = usartDisable;    <span class="comment">// making sure to keep USART disabled until we&#39;ve set everything up</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160; </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;          <span class="comment">/* Modify some settings */</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;          config.clockMode    = usartClockMode0;    <span class="comment">/* clock idle low, sample on rising/first edge (Clock polarity/phase mode = CPOL/CPHA) */</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;          config.refFreq      = 0;              <span class="comment">/* USART/UART reference clock assumed when configuring baud rate setup. Set to 0 to use the currently configured reference clock. */</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;          config.baudrate     = 4000000;         <span class="comment">// CLK freq is 4 MHz</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;          config.databits     = usartDatabits8; <span class="comment">/* master mode */</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;          config.autoTx = <span class="keyword">false</span>;                    <span class="comment">/* If enabled: Enable AUTOTX mode. Transmits as long as RX is not full. Generates underflows if TX is empty. */</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;          config.autoCsEnable = <span class="keyword">false</span>;            <span class="comment">/* CS pin controlled by hardware, not firmware */</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160; </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;          <span class="comment">/* Initialize USART0/1 with the configured parameters */</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;          USART_InitSync(USART0, &amp;config);</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160; </div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;          <span class="comment">// Set and enable USART pin locations</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;          USART0-&gt;ROUTE = USART_ROUTE_CLKPEN | USART_ROUTE_CSPEN | USART_ROUTE_TXPEN | USART_ROUTE_RXPEN | USART_ROUTE_LOCATION_LOC0;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160; </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        <span class="comment">/* Enable USART0/1 */</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        USART_Enable(USART0, usartEnable);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160; </div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        <span class="comment">/* Set CS high (active low!) */</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        <span class="comment">/* Normally this isn&#39;t needed, in the case of gpioModePushPull&quot;, the last argument directly sets the pin state */</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        GPIO_PinOutSet(gpioPortE, 13);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160; </div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160; </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment">      /*****************************/</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="pinout_8h_source.html#l00051">ICM_20948_CLK_PIN</a>, <a class="el" href="pinout_8h_source.html#l00052">ICM_20948_CLK_PORT</a>, <a class="el" href="pinout_8h_source.html#l00048">ICM_20948_CS_PIN</a>, <a class="el" href="pinout_8h_source.html#l00049">ICM_20948_CS_PORT</a>, <a class="el" href="pinout_8h_source.html#l00053">ICM_20948_MISO_PIN</a>, <a class="el" href="pinout_8h_source.html#l00054">ICM_20948_MISO_PORT</a>, <a class="el" href="pinout_8h_source.html#l00055">ICM_20948_MOSI_PIN</a>, and <a class="el" href="pinout_8h_source.html#l00056">ICM_20948_MOSI_PORT</a>.</p>

</div>
</div>
<a id="a70ee6c80001c77355f8d6f7e47ba43db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70ee6c80001c77355f8d6f7e47ba43db">&#9670;&nbsp;</a></span>ICM_20948_interruptEnable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t ICM_20948_interruptEnable </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>dataReadyEnable</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>womEnable</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l00870">870</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;{</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;  uint8_t intEnable;</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160; </div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;  <span class="comment">/* All interrupts disabled by default */</span></div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;  intEnable = 0;</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160; </div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;  <span class="comment">/* Enable one or both of the interrupt sources if required */</span></div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;  <span class="keywordflow">if</span> ( womEnable ) {</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    intEnable = <a class="code" href="pinout_8h.html#afb3b1ca4834bff9fb779999bfd05b602">ICM_20948_BIT_WOM_INT_EN</a>;</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;  }</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;  <span class="comment">/* Write value to register */</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#a990648feebc0cd0748e4bd7e44e91ec2">ICM_20948_REG_INT_ENABLE</a>, intEnable);</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160; </div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;  <span class="comment">/* All interrupts disabled by default */</span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;  intEnable = 0;</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160; </div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;  <span class="keywordflow">if</span> ( dataReadyEnable ) {</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    intEnable = <a class="code" href="pinout_8h.html#a755fc25f9872d5f5f300f892eb672c81">ICM_20948_BIT_RAW_DATA_0_RDY_EN</a>;</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;  }</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160; </div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;  <span class="comment">/* Write value to register */</span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#ae44b5f1593f857ce2cd496c6016bd965">ICM_20948_REG_INT_ENABLE_1</a>, intEnable);</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160; </div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="pinout_8h.html#a13373833ae00ffd733f408836a1eacc1">ICM_20948_OK</a>;</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="pinout_8h_source.html#l00155">ICM_20948_BIT_RAW_DATA_0_RDY_EN</a>, <a class="el" href="pinout_8h_source.html#l00152">ICM_20948_BIT_WOM_INT_EN</a>, <a class="el" href="pinout_8h_source.html#l00043">ICM_20948_OK</a>, <a class="el" href="pinout_8h_source.html#l00151">ICM_20948_REG_INT_ENABLE</a>, <a class="el" href="pinout_8h_source.html#l00154">ICM_20948_REG_INT_ENABLE_1</a>, and <a class="el" href="_i_c_m20948_8c_source.html#l00697">ICM_20948_registerWrite()</a>.</p>

<p class="reference">Referenced by <a class="el" href="main_8c_source.html#l00163">CheckIMUidle()</a>, and <a class="el" href="_i_c_m20948_8c_source.html#l01130">ICM_20948_wakeOnMotionITEnable()</a>.</p>

</div>
</div>
<a id="a3d34cc47da43d0bc629a4b28a9cc15ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d34cc47da43d0bc629a4b28a9cc15ab">&#9670;&nbsp;</a></span>ICM_20948_interruptStatusRead()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t ICM_20948_interruptStatusRead </td>
          <td>(</td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>intStatus</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read staus of interrupt IMU. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">[in/out]</td><td>intStatus pointer to store status </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l00857">857</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;{</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;  uint8_t reg[4];</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160; </div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#a9f8e3ac3e31a7d1a441e1a8ceb3470c8">ICM_20948_registerRead</a>(<a class="code" href="pinout_8h.html#ad4d7441caf358bb8eb205489ba3db74e">ICM_20948_REG_INT_STATUS</a>, 4, reg);</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;  *intStatus = (uint32_t) reg[0];</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;  *intStatus |= ( ( (uint32_t) reg[1]) &lt;&lt; 8);</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;  *intStatus |= ( ( (uint32_t) reg[2]) &lt;&lt; 16);</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;  *intStatus |= ( ( (uint32_t) reg[3]) &lt;&lt; 24);</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160; </div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="pinout_8h.html#a13373833ae00ffd733f408836a1eacc1">ICM_20948_OK</a>;</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="pinout_8h_source.html#l00043">ICM_20948_OK</a>, <a class="el" href="pinout_8h_source.html#l00172">ICM_20948_REG_INT_STATUS</a>, and <a class="el" href="_i_c_m20948_8c_source.html#l00654">ICM_20948_registerRead()</a>.</p>

</div>
</div>
<a id="ab79679ad6161de947d8bfb16a34b4187"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab79679ad6161de947d8bfb16a34b4187">&#9670;&nbsp;</a></span>ICM_20948_latchEnable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t ICM_20948_latchEnable </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>enable</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enables / disables the 50 micro seconds interrupt pin functionality. </p>
<dl class="section note"><dt>Note</dt><dd>written myself, changes the whole register, maybe not so good...</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">enable</td><td><ul>
<li><code>true</code> - Enable 50 micro second interrupt. </li>
<li><code>false</code> - INT1 pin level held until interrupt status is cleared. </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l01219">1219</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;{</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;    uint8_t temp;</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;    <a class="code" href="_i_c_m20948_8c.html#a9f8e3ac3e31a7d1a441e1a8ceb3470c8">ICM_20948_registerRead</a>(<a class="code" href="pinout_8h.html#af1f87a2f8a403005c59d91e6085fcd18">ICM_20948_REG_INT_PIN_CFG</a>, 1, &amp;temp);</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160; </div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;    <span class="keywordflow">if</span>(enable)</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;    {</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;        <span class="comment">/* Set interrupt pin to pulse, no need to read a interrupt register for proceeding */</span></div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;        <span class="comment">/*  1 ï¿½ INT1 pin level held until interrupt status is cleared.</span></div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;<span class="comment">         *  0 ï¿½ INT1 pin indicates interrupt pulse is width 50 us  &lt;----</span></div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;        <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#af1f87a2f8a403005c59d91e6085fcd18">ICM_20948_REG_INT_PIN_CFG</a>, temp | 0b00010000);</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;        <span class="comment">//ICM_20948_registerWrite(ICM_20948_REG_INT_PIN_CFG, 0b00010000);</span></div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;    }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;        <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#af1f87a2f8a403005c59d91e6085fcd18">ICM_20948_REG_INT_PIN_CFG</a>, 0b00000000);</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;    }</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160; </div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="pinout_8h.html#a13373833ae00ffd733f408836a1eacc1">ICM_20948_OK</a>;</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="pinout_8h_source.html#l00043">ICM_20948_OK</a>, <a class="el" href="pinout_8h_source.html#l00146">ICM_20948_REG_INT_PIN_CFG</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00654">ICM_20948_registerRead()</a>, and <a class="el" href="_i_c_m20948_8c_source.html#l00697">ICM_20948_registerWrite()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_i_c_m20948_8c_source.html#l00169">ICM_20948_Init2()</a>.</p>

</div>
</div>
<a id="a138a0d4e0dcbec3f93bb022ac655d3e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a138a0d4e0dcbec3f93bb022ac655d3e7">&#9670;&nbsp;</a></span>ICM_20948_lowPowerModeEnter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t ICM_20948_lowPowerModeEnter </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>enAccel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>enGyro</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>enTemp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l00963">963</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;{</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;  uint8_t <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>;</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160; </div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#a9f8e3ac3e31a7d1a441e1a8ceb3470c8">ICM_20948_registerRead</a>(<a class="code" href="pinout_8h.html#a8a5e88ca0ad999c59cc428b8656d4bc1">ICM_20948_REG_PWR_MGMT_1</a>, 1, &amp;<a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>);</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160; </div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;  <span class="keywordflow">if</span> ( enAccel || enGyro || enTemp ) {</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    <span class="comment">/* Make sure that the chip is not in sleep */</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    <a class="code" href="_i_c_m20948_8c.html#a8f1159f4f75b1eaed9a091d01fe76c3d">ICM_20948_sleepModeEnable</a>(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160; </div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    <span class="comment">/* And in continuous mode */</span></div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;    <a class="code" href="_i_c_m20948_8c.html#aa97147c0f9f71cfaea563fb4b1d64306">ICM_20948_cycleModeEnable</a>(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160; </div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;    <span class="comment">/* Enable the accelerometer and the gyroscope*/</span></div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    <a class="code" href="_i_c_m20948_8c.html#afafb9e426c5a0c760268db0cffd7f46e">ICM_20948_sensorEnable</a>(enAccel, enGyro, enTemp);</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    <a class="code" href="delay_8c.html#adb46f4276f5ddf111153701858f85df6">delay</a>(50);</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160; </div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    <span class="comment">/* Enable cycle mode */</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    <a class="code" href="_i_c_m20948_8c.html#aa97147c0f9f71cfaea563fb4b1d64306">ICM_20948_cycleModeEnable</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160; </div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    <span class="comment">/* Set the LP_EN bit to enable low power mode */</span></div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a> |= <a class="code" href="pinout_8h.html#a3bc32b18ec90ca56ec6619f5b1c6b9ab">ICM_20948_BIT_LP_EN</a>;</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    <span class="comment">/* Enable continuous mode */</span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    <a class="code" href="_i_c_m20948_8c.html#aa97147c0f9f71cfaea563fb4b1d64306">ICM_20948_cycleModeEnable</a>(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160; </div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    <span class="comment">/* Clear the LP_EN bit to disable low power mode */</span></div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a> &amp;= ~<a class="code" href="pinout_8h.html#a3bc32b18ec90ca56ec6619f5b1c6b9ab">ICM_20948_BIT_LP_EN</a>;</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;  }</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160; </div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;  <span class="comment">/* Write the updated value to the PWR_MGNT_1 register */</span></div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#a8a5e88ca0ad999c59cc428b8656d4bc1">ICM_20948_REG_PWR_MGMT_1</a>, <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>);</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160; </div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="pinout_8h.html#a13373833ae00ffd733f408836a1eacc1">ICM_20948_OK</a>;</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="main_8c_source.html#l00122">data</a>, <a class="el" href="delay_8c_source.html#l00116">delay()</a>, <a class="el" href="pinout_8h_source.html#l00137">ICM_20948_BIT_LP_EN</a>, <a class="el" href="_i_c_m20948_8c_source.html#l01035">ICM_20948_cycleModeEnable()</a>, <a class="el" href="pinout_8h_source.html#l00043">ICM_20948_OK</a>, <a class="el" href="pinout_8h_source.html#l00134">ICM_20948_REG_PWR_MGMT_1</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00654">ICM_20948_registerRead()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00697">ICM_20948_registerWrite()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00999">ICM_20948_sensorEnable()</a>, and <a class="el" href="_i_c_m20948_8c_source.html#l00728">ICM_20948_sleepModeEnable()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_i_c_m20948_8c_source.html#l01130">ICM_20948_wakeOnMotionITEnable()</a>.</p>

</div>
</div>
<a id="ad8fa2097274ad4e2b81faf5917a62679"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8fa2097274ad4e2b81faf5917a62679">&#9670;&nbsp;</a></span>ICM_20948_magDataRead()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ICM_20948_magDataRead </td>
          <td>(</td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>magn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l01468">1468</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;                                        {</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160; </div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;    uint8_t <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[8];</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;    <a class="code" href="_i_c_m20948_8c.html#afa39af5c47122519a8bed2bcafd5ee06">ICM_20948_read_mag_register</a>(0x11, 8, <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>);</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160; </div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;    <span class="comment">/* Convert the LSB and MSB into a signed 16-bit value */</span></div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;    <a class="code" href="_i_c_m20948_8c.html#a4f779573a3b06192892ce82c7cd94307">_hxcounts</a> = (((int16_t) <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[1] &lt;&lt; 8) | <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[0] );</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;    <a class="code" href="_i_c_m20948_8c.html#a26e7f879fbdd01ab7d0fe3a2326e6269">_hycounts</a> = (((int16_t) <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[3] &lt;&lt; 8) | <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[2] );</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;    <a class="code" href="_i_c_m20948_8c.html#ad58c847bfe6019ce99e3de59609912ed">_hzcounts</a> = (((int16_t) <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[5] &lt;&lt; 8) | <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[4] );</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160; </div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;    magn[0] = (((float)(<a class="code" href="_i_c_m20948_8c.html#a0adc3826aa3bd34b685205b20864ae12">tX</a>[0]*<a class="code" href="_i_c_m20948_8c.html#a4f779573a3b06192892ce82c7cd94307">_hxcounts</a> + <a class="code" href="_i_c_m20948_8c.html#a0adc3826aa3bd34b685205b20864ae12">tX</a>[1]*<a class="code" href="_i_c_m20948_8c.html#a26e7f879fbdd01ab7d0fe3a2326e6269">_hycounts</a> + <a class="code" href="_i_c_m20948_8c.html#a0adc3826aa3bd34b685205b20864ae12">tX</a>[2]*<a class="code" href="_i_c_m20948_8c.html#ad58c847bfe6019ce99e3de59609912ed">_hzcounts</a>) * <a class="code" href="_i_c_m20948_8c.html#a498e73167c4bbbdc1221f2d409d44aa1">_magScale</a>) + _hxb)*_hxs;</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;    magn[1] = (((float)(<a class="code" href="_i_c_m20948_8c.html#aab96f756fc510c74bd93e749b09a016c">tY</a>[0]*<a class="code" href="_i_c_m20948_8c.html#a4f779573a3b06192892ce82c7cd94307">_hxcounts</a> + <a class="code" href="_i_c_m20948_8c.html#aab96f756fc510c74bd93e749b09a016c">tY</a>[1]*<a class="code" href="_i_c_m20948_8c.html#a26e7f879fbdd01ab7d0fe3a2326e6269">_hycounts</a> + <a class="code" href="_i_c_m20948_8c.html#aab96f756fc510c74bd93e749b09a016c">tY</a>[2]*<a class="code" href="_i_c_m20948_8c.html#ad58c847bfe6019ce99e3de59609912ed">_hzcounts</a>) * <a class="code" href="_i_c_m20948_8c.html#a498e73167c4bbbdc1221f2d409d44aa1">_magScale</a>) + _hyb)*_hys;</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;    magn[2] = (((float)(<a class="code" href="_i_c_m20948_8c.html#a230ea1bf4635586a5b870d567d0f7a46">tZ</a>[0]*<a class="code" href="_i_c_m20948_8c.html#a4f779573a3b06192892ce82c7cd94307">_hxcounts</a> + <a class="code" href="_i_c_m20948_8c.html#a230ea1bf4635586a5b870d567d0f7a46">tZ</a>[1]*<a class="code" href="_i_c_m20948_8c.html#a26e7f879fbdd01ab7d0fe3a2326e6269">_hycounts</a> + <a class="code" href="_i_c_m20948_8c.html#a230ea1bf4635586a5b870d567d0f7a46">tZ</a>[2]*<a class="code" href="_i_c_m20948_8c.html#ad58c847bfe6019ce99e3de59609912ed">_hzcounts</a>) * <a class="code" href="_i_c_m20948_8c.html#a498e73167c4bbbdc1221f2d409d44aa1">_magScale</a>) + _hzb)*_hzs;</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160; </div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="_i_c_m20948_8c_source.html#l00047">_hxcounts</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00047">_hycounts</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00047">_hzcounts</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00063">_magScale</a>, <a class="el" href="main_8c_source.html#l00122">data</a>, <a class="el" href="_i_c_m20948_8c_source.html#l01354">ICM_20948_read_mag_register()</a>, and <a class="el" href="_i_c_m20948_8c_source.html#l00053">tX</a>.</p>

<p class="reference">Referenced by <a class="el" href="_i_c_m20948_8c_source.html#l01891">ICM_20948_min_max_mag()</a>, and <a class="el" href="main_8c_source.html#l00234">measure_send()</a>.</p>

</div>
</div>
<a id="a30bf26e63d6d09171b0200b4f1416039"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30bf26e63d6d09171b0200b4f1416039">&#9670;&nbsp;</a></span>ICM_20948_magn_to_angle()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ICM_20948_magn_to_angle </td>
          <td>(</td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>magn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>angle</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l01498">1498</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;                                                       {</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160; </div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;    angle[0] = atan2(magn[1], magn[0]) * <a class="code" href="_i_c_m20948_8c.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a>/180.0f;</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160; </div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="_i_c_m20948_8c_source.html#l00041">M_PI</a>.</p>

</div>
</div>
<a id="aad8d065bfe65cd7233c5916e2fa57bb1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad8d065bfe65cd7233c5916e2fa57bb1">&#9670;&nbsp;</a></span>ICM_20948_magRawDataRead()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ICM_20948_magRawDataRead </td>
          <td>(</td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>raw_magn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l01441">1441</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;                                               {</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160; </div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;    uint8_t <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[8];</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;    <a class="code" href="_i_c_m20948_8c.html#afa39af5c47122519a8bed2bcafd5ee06">ICM_20948_read_mag_register</a>(0x11, 8, <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>);</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160; </div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;    <span class="comment">/* Convert the LSB and MSB into a signed 16-bit value */</span></div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;    <a class="code" href="_i_c_m20948_8c.html#a4f779573a3b06192892ce82c7cd94307">_hxcounts</a> = (((int16_t) <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[1] &lt;&lt; 8) | <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[0] );</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;    <a class="code" href="_i_c_m20948_8c.html#a26e7f879fbdd01ab7d0fe3a2326e6269">_hycounts</a> = (((int16_t) <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[3] &lt;&lt; 8) | <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[2] );</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;    <a class="code" href="_i_c_m20948_8c.html#ad58c847bfe6019ce99e3de59609912ed">_hzcounts</a> = (((int16_t) <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[5] &lt;&lt; 8) | <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>[4] );</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160; </div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;    <span class="comment">/* Transform to same coordinate system as gyro &amp; accel */</span></div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;    raw_magn[0] = (float)(<a class="code" href="_i_c_m20948_8c.html#a0adc3826aa3bd34b685205b20864ae12">tX</a>[0]*<a class="code" href="_i_c_m20948_8c.html#a4f779573a3b06192892ce82c7cd94307">_hxcounts</a> + <a class="code" href="_i_c_m20948_8c.html#a0adc3826aa3bd34b685205b20864ae12">tX</a>[1]*<a class="code" href="_i_c_m20948_8c.html#a26e7f879fbdd01ab7d0fe3a2326e6269">_hycounts</a> + <a class="code" href="_i_c_m20948_8c.html#a0adc3826aa3bd34b685205b20864ae12">tX</a>[2]*<a class="code" href="_i_c_m20948_8c.html#ad58c847bfe6019ce99e3de59609912ed">_hzcounts</a>);</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;    raw_magn[1] = (float)(<a class="code" href="_i_c_m20948_8c.html#aab96f756fc510c74bd93e749b09a016c">tY</a>[0]*<a class="code" href="_i_c_m20948_8c.html#a4f779573a3b06192892ce82c7cd94307">_hxcounts</a> + <a class="code" href="_i_c_m20948_8c.html#aab96f756fc510c74bd93e749b09a016c">tY</a>[1]*<a class="code" href="_i_c_m20948_8c.html#a26e7f879fbdd01ab7d0fe3a2326e6269">_hycounts</a> + <a class="code" href="_i_c_m20948_8c.html#aab96f756fc510c74bd93e749b09a016c">tY</a>[2]*<a class="code" href="_i_c_m20948_8c.html#ad58c847bfe6019ce99e3de59609912ed">_hzcounts</a>);</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;    raw_magn[2] = (float)(<a class="code" href="_i_c_m20948_8c.html#a230ea1bf4635586a5b870d567d0f7a46">tZ</a>[0]*<a class="code" href="_i_c_m20948_8c.html#a4f779573a3b06192892ce82c7cd94307">_hxcounts</a> + <a class="code" href="_i_c_m20948_8c.html#a230ea1bf4635586a5b870d567d0f7a46">tZ</a>[1]*<a class="code" href="_i_c_m20948_8c.html#a26e7f879fbdd01ab7d0fe3a2326e6269">_hycounts</a> + <a class="code" href="_i_c_m20948_8c.html#a230ea1bf4635586a5b870d567d0f7a46">tZ</a>[2]*<a class="code" href="_i_c_m20948_8c.html#ad58c847bfe6019ce99e3de59609912ed">_hzcounts</a>);</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160; </div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;<span class="preprocessor">#if DEBUG_DBPRINTs == 1 </span><span class="comment">/* DEBUG_DBPRINT */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;            <a class="code" href="dbprint_8h.html#a48c1f5d07dde14219473ff6a89a3f7ba">dbprint</a>(<span class="stringliteral">&quot;rawMag x:  &quot;</span>);</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;            <a class="code" href="dbprint_8h.html#a4e4e18f85e358d8cc702ea8c2f190503">dbprintInt</a>((<span class="keywordtype">int</span>) raw_magn[0]);</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;            <a class="code" href="dbprint_8h.html#a48c1f5d07dde14219473ff6a89a3f7ba">dbprint</a>(<span class="stringliteral">&quot;   rawMag y:  &quot;</span>);</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;            <a class="code" href="dbprint_8h.html#a4e4e18f85e358d8cc702ea8c2f190503">dbprintInt</a>((<span class="keywordtype">int</span>) raw_magn[1]);</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;            <a class="code" href="dbprint_8h.html#a48c1f5d07dde14219473ff6a89a3f7ba">dbprint</a>(<span class="stringliteral">&quot;   minMag z:  &quot;</span>);</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;            <a class="code" href="dbprint_8h.html#a4e4e18f85e358d8cc702ea8c2f190503">dbprintInt</a>((<span class="keywordtype">int</span>) raw_magn[2]);</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;            <a class="code" href="dbprint_8h.html#a5e059a469cca8341eb0a84e5c352f518">dbprintln</a>(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* DEBUG_DBPRINT */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160; </div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="_i_c_m20948_8c_source.html#l00047">_hxcounts</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00047">_hycounts</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00047">_hzcounts</a>, <a class="el" href="main_8c_source.html#l00122">data</a>, <a class="el" href="dbprint_8h.html#a48c1f5d07dde14219473ff6a89a3f7ba">dbprint()</a>, <a class="el" href="dbprint_8h.html#a4e4e18f85e358d8cc702ea8c2f190503">dbprintInt()</a>, <a class="el" href="dbprint_8h.html#a5e059a469cca8341eb0a84e5c352f518">dbprintln()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l01354">ICM_20948_read_mag_register()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00053">tX</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00054">tY</a>, and <a class="el" href="_i_c_m20948_8c_source.html#l00055">tZ</a>.</p>

</div>
</div>
<a id="a0d8a914c518d9d869d3e4d9b7afeb672"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d8a914c518d9d869d3e4d9b7afeb672">&#9670;&nbsp;</a></span>ICM_20948_min_max_mag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t ICM_20948_min_max_mag </td>
          <td>(</td>
          <td class="paramtype">int16_t *&#160;</td>
          <td class="paramname"><em>minMag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int16_t *&#160;</td>
          <td class="paramname"><em>maxMag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate minimum and maximum magnetometer values, which are used for calibration. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">minMag</td><td>pointer to minima from each axis </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">maxMag</td><td>pointer to maxima from each axis</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>'OK' if successful, 'ERROR' on error. </dd></dl>

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l01891">1891</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;                                                                 {</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;    <span class="keywordtype">float</span> m[3];</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160; </div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;    minMag[0] = 32767; <span class="comment">// alles kleiner dan dit wordt het minimum, daar staat er hier geen &#39;-&#39;!</span></div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;    minMag[1] = 32767;</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;    minMag[2] = 32767;</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160; </div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;    maxMag[0] = -32768; <span class="comment">// hier hetzelfde, starten met de kleinste waarde, dan aanpassen dat het groter en groter wordt tot het maximum gevonden wordt!</span></div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;    maxMag[1] = -32768;</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;    maxMag[2] = -32768;</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160; </div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;    uint32_t max_time = 15000;</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;    uint32_t t_start = <a class="code" href="timer_8c.html#acd8d13c328bebdf9eddea27ff9448c2d">millis</a>();</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160; </div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;    <span class="comment">/* Flags for if axis mag_minimumRange is fulfilled */</span></div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;    <span class="keywordtype">bool</span> miniumRange_mx = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;    <span class="keywordtype">bool</span> miniumRange_my = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;    <span class="keywordtype">bool</span> miniumRange_mz = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160; </div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160; </div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;    <span class="keywordflow">while</span> (!miniumRange_mx || !miniumRange_my || !miniumRange_mz) {</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;        <span class="keywordflow">while</span> ((<a class="code" href="timer_8c.html#acd8d13c328bebdf9eddea27ff9448c2d">millis</a>() - t_start) &lt; max_time)  {</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160; </div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;            <span class="comment">/* read magnetometer measurement */</span></div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;            <a class="code" href="_i_c_m20948_8c.html#ad8fa2097274ad4e2b81faf5917a62679">ICM_20948_magDataRead</a>( m );</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160; </div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;            <span class="keywordflow">if</span> (m[0] &lt; minMag[0]) {</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;                minMag[0] = m[0];</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;            }</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;            <span class="keywordflow">if</span> (m[0] &gt; maxMag[0]) {</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;                maxMag[0] = m[0];</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;            }</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160; </div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;            <span class="keywordflow">if</span> (m[1] &lt; minMag[1]) {</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;                minMag[1] = m[1];</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;            }</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;            <span class="keywordflow">if</span> (m[1] &gt; maxMag[1]) {</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;                maxMag[1] = m[1];</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;            }</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160; </div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;            <span class="keywordflow">if</span> (m[2] &lt; minMag[2]) {</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;                minMag[2] = m[2];</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;            }</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;            <span class="keywordflow">if</span> (m[2] &gt; maxMag[2]) {</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;                maxMag[2] = m[2];</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;            }</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160; </div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;            <span class="keywordflow">if</span> ((maxMag[0] - minMag[0]) &gt; <a class="code" href="_i_c_m20948_8c.html#a83301b3809fa28a7a800258bae36d074">mag_minimumRange</a>) {</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;                miniumRange_mx = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;            }</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;            <span class="keywordflow">if</span> ((maxMag[1] - minMag[1]) &gt; <a class="code" href="_i_c_m20948_8c.html#a83301b3809fa28a7a800258bae36d074">mag_minimumRange</a>) {</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;                miniumRange_my = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;            }</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;            <span class="keywordflow">if</span> ((maxMag[2] - minMag[2]) &gt; <a class="code" href="_i_c_m20948_8c.html#a83301b3809fa28a7a800258bae36d074">mag_minimumRange</a>) {</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;                miniumRange_mz = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;            }</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160; </div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;<span class="comment">//                DEBUG_PRINT(min_mx); DEBUG_PRINT(&quot;\t&quot;); DEBUG_PRINT(min_my); DEBUG_PRINT(&quot;\t&quot;); DEBUG_PRINTLN(min_mz);</span></div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;<span class="comment">//                DEBUG_PRINT(max_mx); DEBUG_PRINT(&quot;\t&quot;); DEBUG_PRINT(max_my); DEBUG_PRINT(&quot;\t&quot;); DEBUG_PRINTLN(max_mz);</span></div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;<span class="comment">//                DEBUG_PRINTLN();</span></div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;<span class="preprocessor">#if DEBUG_DBPRINT == 1 </span><span class="comment">/* DEBUG_DBPRINT */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;            <a class="code" href="dbprint_8h.html#a48c1f5d07dde14219473ff6a89a3f7ba">dbprint</a>(<span class="stringliteral">&quot;minMag:  &quot;</span>);</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;            <a class="code" href="dbprint_8h.html#a4e4e18f85e358d8cc702ea8c2f190503">dbprintInt</a>((<span class="keywordtype">int</span>) minMag[0]);</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;            <a class="code" href="dbprint_8h.html#a48c1f5d07dde14219473ff6a89a3f7ba">dbprint</a>(<span class="stringliteral">&quot;   minMag:  &quot;</span>);</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;            <a class="code" href="dbprint_8h.html#a4e4e18f85e358d8cc702ea8c2f190503">dbprintInt</a>((<span class="keywordtype">int</span>) minMag[1]);</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;            <a class="code" href="dbprint_8h.html#a48c1f5d07dde14219473ff6a89a3f7ba">dbprint</a>(<span class="stringliteral">&quot;   minMag:  &quot;</span>);</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;            <a class="code" href="dbprint_8h.html#a4e4e18f85e358d8cc702ea8c2f190503">dbprintInt</a>((<span class="keywordtype">int</span>) minMag[2]);</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;            <a class="code" href="dbprint_8h.html#a48c1f5d07dde14219473ff6a89a3f7ba">dbprint</a>(<span class="stringliteral">&quot;   maxMag:  &quot;</span>);</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;            <a class="code" href="dbprint_8h.html#a4e4e18f85e358d8cc702ea8c2f190503">dbprintInt</a>((<span class="keywordtype">int</span>) maxMag[0]);</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;            <a class="code" href="dbprint_8h.html#a48c1f5d07dde14219473ff6a89a3f7ba">dbprint</a>(<span class="stringliteral">&quot;   maxMag:  &quot;</span>);</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;            <a class="code" href="dbprint_8h.html#a4e4e18f85e358d8cc702ea8c2f190503">dbprintInt</a>((<span class="keywordtype">int</span>) maxMag[1]);</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;            <a class="code" href="dbprint_8h.html#a48c1f5d07dde14219473ff6a89a3f7ba">dbprint</a>(<span class="stringliteral">&quot;   maxMag:  &quot;</span>);</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;            <a class="code" href="dbprint_8h.html#a4e4e18f85e358d8cc702ea8c2f190503">dbprintInt</a>((<span class="keywordtype">int</span>) maxMag[2]);</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;            <a class="code" href="dbprint_8h.html#a5e059a469cca8341eb0a84e5c352f518">dbprintln</a>(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* DEBUG_DBPRINT */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;        }</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;    }</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160; </div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="pinout_8h.html#aba51915c87d64af47fb1cc59348961c9">OK</a>;</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="dbprint_8h.html#a48c1f5d07dde14219473ff6a89a3f7ba">dbprint()</a>, <a class="el" href="dbprint_8h.html#a4e4e18f85e358d8cc702ea8c2f190503">dbprintInt()</a>, <a class="el" href="dbprint_8h.html#a5e059a469cca8341eb0a84e5c352f518">dbprintln()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l01468">ICM_20948_magDataRead()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00042">mag_minimumRange</a>, <a class="el" href="timer_8c_source.html#l00024">millis()</a>, and <a class="el" href="pinout_8h_source.html#l00402">OK</a>.</p>

</div>
</div>
<a id="ace147474f6cfc16fee8390c478b66b5e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace147474f6cfc16fee8390c478b66b5e">&#9670;&nbsp;</a></span>ICM_20948_power()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ICM_20948_power </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>enable</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Turns the GPIO pin high to provide power to the ICM20948. </p>
<dl class="section note"><dt>Note</dt><dd>max current 20mA, in total max 100mA (all GPIO pins combined)</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">enable</td><td><ul>
<li><code>true</code> - Provide power to the IMU. </li>
<li><code>false</code> - Cut-off power to the IMU. </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l00392">392</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;{</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="comment">/* Initialize VDD pin if not already the case */</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment">//  if (!ICM_20948_Initialized)</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment">//  {</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment">//      /* In the case of gpioModePushPull&quot;, the last argument directly sets the pin state */</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment">//      GPIO_PinModeSet(ICM_20948_POWER_PORT, ICM_20948_POWER_PIN, gpioModePushPull, enable);</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160; </div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment">//      ICM_20948_Initialized = true;</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment">//  }</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment">//  else</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="comment">//  {</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        <span class="keywordflow">if</span> (enable) GPIO_PinModeSet(<a class="code" href="pinout_8h.html#a69c539b22f71fe2bad24af7e3ccfe8b2">ICM_20948_POWER_PORT</a>, <a class="code" href="pinout_8h.html#ad568402dff8559f29934806865f9b3ad">ICM_20948_POWER_PIN</a>, gpioModePushPull, enable); <span class="comment">/* Enable VDD pin */</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        <span class="keywordflow">else</span> GPIO_PinModeSet(<a class="code" href="pinout_8h.html#a69c539b22f71fe2bad24af7e3ccfe8b2">ICM_20948_POWER_PORT</a>, <a class="code" href="pinout_8h.html#ad568402dff8559f29934806865f9b3ad">ICM_20948_POWER_PIN</a>, gpioModeDisabled, 0); <span class="comment">/* Disable VDD pin */</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment">//  }</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="pinout_8h_source.html#l00030">ICM_20948_POWER_PIN</a>, and <a class="el" href="pinout_8h_source.html#l00031">ICM_20948_POWER_PORT</a>.</p>

<p class="reference">Referenced by <a class="el" href="_i_c_m20948_8c_source.html#l00085">ICM_20948_Init()</a>.</p>

</div>
</div>
<a id="adac3c17a3cdba84cde8bad432e1b2e58"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adac3c17a3cdba84cde8bad432e1b2e58">&#9670;&nbsp;</a></span>ICM_20948_printAllData()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ICM_20948_printAllData </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Print all gyro + accel + magn data using dbprint. </p>

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l00414">414</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;{</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <span class="comment">/* Gyro [DPS]</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment">     * Accel [G *1000] (to print it in Integers</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160; </div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;      <span class="comment">/* Variables to store gyro &amp; accel data</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment">       * GYRO:  X --&gt; ICM_20948_gyro[0];</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment">       *        Y --&gt; ICM_20948_gyro[1];</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment">       *        Z --&gt; ICM_20948_gyro[2];</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment">       * ACCEL: X --&gt; ICM_20948_accel[0]:</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment">       *        Y --&gt; ICM_20948_accel[1]:</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment">       *        Z --&gt; ICM_20948_accel[2]:</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment">       */</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="preprocessor">#if DEBUG_DBPRINTs == 1 </span><span class="comment">/* DEBUG_DBPRINT */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;      <a class="code" href="dbprint_8h.html#a48c1f5d07dde14219473ff6a89a3f7ba">dbprint</a>(<span class="stringliteral">&quot; Gyro x: &quot;</span>);</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;      <a class="code" href="dbprint_8h.html#a4e4e18f85e358d8cc702ea8c2f190503">dbprintInt</a>((<span class="keywordtype">int</span>) ICM_20948_gyro[0] );</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;      <a class="code" href="dbprint_8h.html#a48c1f5d07dde14219473ff6a89a3f7ba">dbprint</a>(<span class="stringliteral">&quot; Gyro y: &quot;</span>);</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;      <a class="code" href="dbprint_8h.html#a4e4e18f85e358d8cc702ea8c2f190503">dbprintInt</a>((<span class="keywordtype">int</span>) ICM_20948_gyro[1] );</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;      <a class="code" href="dbprint_8h.html#a48c1f5d07dde14219473ff6a89a3f7ba">dbprint</a>(<span class="stringliteral">&quot; Gyro z: &quot;</span>);</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;      <a class="code" href="dbprint_8h.html#a4e4e18f85e358d8cc702ea8c2f190503">dbprintInt</a>((<span class="keywordtype">int</span>) ICM_20948_gyro[2] );</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;      <a class="code" href="dbprint_8h.html#a48c1f5d07dde14219473ff6a89a3f7ba">dbprint</a>(<span class="stringliteral">&quot; Accel x: &quot;</span>);</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;      <a class="code" href="dbprint_8h.html#a4e4e18f85e358d8cc702ea8c2f190503">dbprintInt</a>((<span class="keywordtype">int</span>) (ICM_20948_accel[0]*1000) );</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      <a class="code" href="dbprint_8h.html#a48c1f5d07dde14219473ff6a89a3f7ba">dbprint</a>(<span class="stringliteral">&quot; Accel y: &quot;</span>);</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;      <a class="code" href="dbprint_8h.html#a4e4e18f85e358d8cc702ea8c2f190503">dbprintInt</a>((<span class="keywordtype">int</span>) (ICM_20948_accel[1]*1000) );</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;      <a class="code" href="dbprint_8h.html#a48c1f5d07dde14219473ff6a89a3f7ba">dbprint</a>(<span class="stringliteral">&quot; Accel z: &quot;</span>);</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;      <a class="code" href="dbprint_8h.html#a4e4e18f85e358d8cc702ea8c2f190503">dbprintInt</a>((<span class="keywordtype">int</span>) (ICM_20948_accel[2]*1000) );</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;      <a class="code" href="dbprint_8h.html#a48c1f5d07dde14219473ff6a89a3f7ba">dbprint</a>(<span class="stringliteral">&quot; Magn x: &quot;</span>);</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;      <a class="code" href="dbprint_8h.html#a4e4e18f85e358d8cc702ea8c2f190503">dbprintInt</a>((<span class="keywordtype">int</span>) ICM_20948_magn[0] );</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;      <a class="code" href="dbprint_8h.html#a48c1f5d07dde14219473ff6a89a3f7ba">dbprint</a>(<span class="stringliteral">&quot; Magn y: &quot;</span>);</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;      <a class="code" href="dbprint_8h.html#a4e4e18f85e358d8cc702ea8c2f190503">dbprintInt</a>((<span class="keywordtype">int</span>) ICM_20948_magn[1] );</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      <a class="code" href="dbprint_8h.html#a48c1f5d07dde14219473ff6a89a3f7ba">dbprint</a>(<span class="stringliteral">&quot; Magn z: &quot;</span>);</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;      <a class="code" href="dbprint_8h.html#a05cd4086fbb7c752337b52c49c31d16b">dbprintlnInt</a>((<span class="keywordtype">int</span>) ICM_20948_magn[2] );</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* DEBUG_DBPRINT */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160; </div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="dbprint_8h.html#a48c1f5d07dde14219473ff6a89a3f7ba">dbprint()</a>, <a class="el" href="dbprint_8h.html#a4e4e18f85e358d8cc702ea8c2f190503">dbprintInt()</a>, and <a class="el" href="dbprint_8h.html#a05cd4086fbb7c752337b52c49c31d16b">dbprintlnInt()</a>.</p>

</div>
</div>
<a id="a67648f0e4d9239b0624c22f87a23014c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67648f0e4d9239b0624c22f87a23014c">&#9670;&nbsp;</a></span>ICM_20948_read()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t ICM_20948_read </td>
          <td>(</td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>addr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read single register from IMU using SPI. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">addr</td><td>address 16 bits - first bits are bank, the rest of the bits is the address </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l00545">545</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;{</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    uint8_t <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>;</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    uint8_t reg_address;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    uint8_t bank;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160; </div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <span class="comment">/* Select last 7 bytes (A6 - A0) to use as register address */</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <span class="comment">/* Address format: | R/W | A6 | A5 | A4 | A3 | A2 | A1 | A0 | */</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <span class="comment">/* Use AND to change only last 7 bytes */</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    reg_address = (uint8_t) (addr &amp; 0b01111111);</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160; </div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    bank = (uint8_t) (addr &gt;&gt; 7);</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160; </div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="comment">/* Select right bank */</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <a class="code" href="_i_c_m20948_8c.html#aa9c1a0462c03c5af6e1ccff792128450">ICM_20948_bankSelect</a>(bank);</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160; </div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <span class="comment">/* Enable CS */</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <a class="code" href="_i_c_m20948_8c.html#a2e019e8fd51a6ca5c169d3e6ee48542f">ICM_20948_chipSelectSet</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160; </div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <span class="comment">/* Set the first byte to 1 to read (according to data sheet) */</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <span class="comment">/* Address format: | R/W | A6 | A5 | A4 | A3 | A2 | A1 | A0 | */</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <span class="comment">/* Read setup */</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    USART_SpiTransfer(<a class="code" href="pinout_8h.html#aadd93900fc87105fa3ef514675d4133b">SPI</a>, (reg_address | 0b10000000));</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160; </div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <span class="comment">/* Read data */</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a> = USART_SpiTransfer(<a class="code" href="pinout_8h.html#aadd93900fc87105fa3ef514675d4133b">SPI</a>, 0x00);</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160; </div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <span class="comment">/* Disable CS */</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <a class="code" href="_i_c_m20948_8c.html#a2e019e8fd51a6ca5c169d3e6ee48542f">ICM_20948_chipSelectSet</a>(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160; </div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <span class="keywordflow">return</span> (<a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>);</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="main_8c_source.html#l00122">data</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00528">ICM_20948_bankSelect()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00480">ICM_20948_chipSelectSet()</a>, and <a class="el" href="pinout_8h_source.html#l00064">SPI</a>.</p>

<p class="reference">Referenced by <a class="el" href="_i_c_m20948_8c_source.html#l00459">ICM_20948_check_WhoAmI()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l01285">readMagRegister()</a>, and <a class="el" href="_i_c_m20948_8c_source.html#l01265">waitForSlave4()</a>.</p>

</div>
</div>
<a id="afa39af5c47122519a8bed2bcafd5ee06"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa39af5c47122519a8bed2bcafd5ee06">&#9670;&nbsp;</a></span>ICM_20948_read_mag_register()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ICM_20948_read_mag_register </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>numBytes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read register in the AK09916 magnetometer device. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">addr</td><td>Register address to read from Bit[6:0] - register address</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">numBytes</td><td>Number of bytes to read</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">data</td><td>Data read from register</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>None </dd></dl>

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l01354">1354</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;                                                                                {</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;    uint8_t wBuffer[2];</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;    wBuffer[0] = addr;</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;    wBuffer[1] = 0x00;</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160; </div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;    <a class="code" href="_i2_c_8c.html#a06104f2b83b9e221737ba5a75c6edc4c">IIC_WriteReadBuffer</a>( ( <a class="code" href="pinout_8h.html#a61f3332e075b6fde0cbdb5b9c499dba2">AK09916_BIT_I2C_SLV_ADDR</a> &lt;&lt; 1 ), wBuffer, 1, <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>, numBytes);</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="pinout_8h_source.html#l00396">AK09916_BIT_I2C_SLV_ADDR</a>, <a class="el" href="main_8c_source.html#l00122">data</a>, and <a class="el" href="_i2_c_8c_source.html#l00190">IIC_WriteReadBuffer()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_i_c_m20948_8c_source.html#l00085">ICM_20948_Init()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00169">ICM_20948_Init2()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l01468">ICM_20948_magDataRead()</a>, and <a class="el" href="_i_c_m20948_8c_source.html#l01441">ICM_20948_magRawDataRead()</a>.</p>

</div>
</div>
<a id="a9f8e3ac3e31a7d1a441e1a8ceb3470c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f8e3ac3e31a7d1a441e1a8ceb3470c8">&#9670;&nbsp;</a></span>ICM_20948_registerRead()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ICM_20948_registerRead </td>
          <td>(</td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numBytes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read registers from IMU. </p>
<p>Using I2C</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">addr</td><td>address </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">numBytes</td><td>numer of bytes to read </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">data</td><td>pointer to store data </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l00654">654</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;{</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    uint8_t regAddr;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    uint8_t bank;</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160; </div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160; </div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160; </div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    uint8_t rLength = (uint8_t) numBytes;</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160; </div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160; </div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    regAddr = (uint8_t) (addr &amp; 0x7F);</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    bank = (uint8_t) (addr &gt;&gt; 7);</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160; </div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <a class="code" href="_i_c_m20948_8c.html#aa9c1a0462c03c5af6e1ccff792128450">ICM_20948_bankSelect</a>(bank);</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160; </div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    uint8_t wBuffer[2];</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    wBuffer[0] = regAddr;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    wBuffer[1] = 0x00;  <span class="comment">/* 0x00 to read */</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160; </div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    <span class="comment">// TODO</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160; </div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    <a class="code" href="_i2_c_8c.html#a06104f2b83b9e221737ba5a75c6edc4c">IIC_WriteReadBuffer</a>(<a class="code" href="pinout_8h.html#a531e6eb9bdda040f6d5e56a02dec7c36">ICM_20948_I2C_ADDRESS</a>, wBuffer, 1, <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>, rLength);</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160; </div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160; </div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="main_8c_source.html#l00122">data</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00528">ICM_20948_bankSelect()</a>, <a class="el" href="pinout_8h_source.html#l00026">ICM_20948_I2C_ADDRESS</a>, and <a class="el" href="_i2_c_8c_source.html#l00190">IIC_WriteReadBuffer()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_i_c_m20948_8c_source.html#l01192">ICM_20948_accelBandwidthSet()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l01050">ICM_20948_accelDataRead()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l01104">ICM_20948_accelFullscaleSet()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l01525">ICM_20948_accelGyroCalibrate()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l01074">ICM_20948_accelResolutionGet()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l01177">ICM_20948_gyroBandwidthSet()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l01736">ICM_20948_gyroCalibrate()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00783">ICM_20948_gyroDataRead()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l01117">ICM_20948_gyroFullscaleSet()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00817">ICM_20948_gyroResolutionGet()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00169">ICM_20948_Init2()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00857">ICM_20948_interruptStatusRead()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l01219">ICM_20948_latchEnable()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00963">ICM_20948_lowPowerModeEnter()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00999">ICM_20948_sensorEnable()</a>, and <a class="el" href="_i_c_m20948_8c_source.html#l00728">ICM_20948_sleepModeEnable()</a>.</p>

</div>
</div>
<a id="aa22d0eb7ceca8855eb2eece3d875f65e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa22d0eb7ceca8855eb2eece3d875f65e">&#9670;&nbsp;</a></span>ICM_20948_registerWrite()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ICM_20948_registerWrite </td>
          <td>(</td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes registers from IMU. </p>
<p>Using I2C</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">addr</td><td>address </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">data</td><td>data to be written </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l00697">697</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;{</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    uint8_t regAddr;</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    uint8_t bank;</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160; </div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    regAddr = (uint8_t) (addr &amp; 0x7F);</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    bank = (uint8_t) (addr &gt;&gt; 7);</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160; </div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    <a class="code" href="_i_c_m20948_8c.html#aa9c1a0462c03c5af6e1ccff792128450">ICM_20948_bankSelect</a>(bank);</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160; </div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    uint8_t wBuffer[2];</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    wBuffer[0] = regAddr;</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    wBuffer[1] = <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>;</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160; </div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160; </div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    <a class="code" href="_i2_c_8c.html#a47431e985fd340e0e1d8a112bfe9ddcc">IIC_WriteBuffer</a>(<a class="code" href="pinout_8h.html#a531e6eb9bdda040f6d5e56a02dec7c36">ICM_20948_I2C_ADDRESS</a>, wBuffer, 2);</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160; </div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="main_8c_source.html#l00122">data</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00528">ICM_20948_bankSelect()</a>, <a class="el" href="pinout_8h_source.html#l00026">ICM_20948_I2C_ADDRESS</a>, and <a class="el" href="_i2_c_8c_source.html#l00112">IIC_WriteBuffer()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_i_c_m20948_8c_source.html#l01192">ICM_20948_accelBandwidthSet()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l01104">ICM_20948_accelFullscaleSet()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l01525">ICM_20948_accelGyroCalibrate()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00934">ICM_20948_accelSampleRateSet()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l01035">ICM_20948_cycleModeEnable()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l01177">ICM_20948_gyroBandwidthSet()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l01736">ICM_20948_gyroCalibrate()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l01117">ICM_20948_gyroFullscaleSet()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00907">ICM_20948_gyroSampleRateSet()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00169">ICM_20948_Init2()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00870">ICM_20948_interruptEnable()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l01219">ICM_20948_latchEnable()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00963">ICM_20948_lowPowerModeEnter()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00762">ICM_20948_reset()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00999">ICM_20948_sensorEnable()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l01246">ICM_20948_set_mag_transfer()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00728">ICM_20948_sleepModeEnable()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l01130">ICM_20948_wakeOnMotionITEnable()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l01285">readMagRegister()</a>, and <a class="el" href="_i_c_m20948_8c_source.html#l01298">writeMagRegister()</a>.</p>

</div>
</div>
<a id="a32e5e81e275f3fecca06ca62cccd8ad5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a32e5e81e275f3fecca06ca62cccd8ad5">&#9670;&nbsp;</a></span>ICM_20948_reset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t ICM_20948_reset </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reset IMU. </p>

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l00762">762</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;{</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;  <span class="comment">/* Set H_RESET bit to initiate soft reset */</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#a8a5e88ca0ad999c59cc428b8656d4bc1">ICM_20948_REG_PWR_MGMT_1</a>, <a class="code" href="pinout_8h.html#a374a20bea1db9d4341c467bf92097f65">ICM_20948_BIT_H_RESET</a>);</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160; </div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;  <span class="comment">/* Wait 100ms to complete the reset sequence */</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;  <a class="code" href="delay_8c.html#adb46f4276f5ddf111153701858f85df6">delay</a>(100);</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160; </div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="pinout_8h.html#a13373833ae00ffd733f408836a1eacc1">ICM_20948_OK</a>;</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="delay_8c_source.html#l00116">delay()</a>, <a class="el" href="pinout_8h_source.html#l00135">ICM_20948_BIT_H_RESET</a>, <a class="el" href="pinout_8h_source.html#l00043">ICM_20948_OK</a>, <a class="el" href="pinout_8h_source.html#l00134">ICM_20948_REG_PWR_MGMT_1</a>, and <a class="el" href="_i_c_m20948_8c_source.html#l00697">ICM_20948_registerWrite()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_i_c_m20948_8c_source.html#l00085">ICM_20948_Init()</a>.</p>

</div>
</div>
<a id="aed55c84082bcb8765a603d0e09f236a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed55c84082bcb8765a603d0e09f236a7">&#9670;&nbsp;</a></span>ICM_20948_reset_mag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t ICM_20948_reset_mag </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l01486">1486</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;                                   {</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;    <span class="comment">/* Set SRST bit to initiate soft reset */</span></div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;    <a class="code" href="_i_c_m20948_8c.html#a7ed83e84f5d14637ea91c05174e84dcd">ICM_20948_write_mag_register</a>(<a class="code" href="pinout_8h.html#aa63441f6bf3dba9851a7c6d37666757f">AK09916_REG_CONTROL_3</a>, <a class="code" href="pinout_8h.html#a49ea8558a01e1792f7798229b131f4e4">AK09916_BIT_SRST</a>);</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160; </div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;    <span class="comment">/* Wait 100ms to complete reset sequence */</span></div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;    <a class="code" href="delay_8c.html#adb46f4276f5ddf111153701858f85df6">delay</a>(100);</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160; </div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="pinout_8h.html#aba51915c87d64af47fb1cc59348961c9">OK</a>;</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="pinout_8h_source.html#l00393">AK09916_BIT_SRST</a>, <a class="el" href="pinout_8h_source.html#l00392">AK09916_REG_CONTROL_3</a>, <a class="el" href="delay_8c_source.html#l00116">delay()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l01408">ICM_20948_write_mag_register()</a>, and <a class="el" href="pinout_8h_source.html#l00402">OK</a>.</p>

</div>
</div>
<a id="ad640eb781cd8b92ce54c6e51754b36a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad640eb781cd8b92ce54c6e51754b36a5">&#9670;&nbsp;</a></span>ICM_20948_sampleRateSet()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t ICM_20948_sampleRateSet </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>sampleRate</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l00898">898</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;{</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#a2a480bb1caa28241f1cc1e77a3445961">ICM_20948_gyroSampleRateSet</a>(sampleRate);</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#afca99859e232ac24c63406fb22a8bd46">ICM_20948_accelSampleRateSet</a>(sampleRate);</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160; </div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="pinout_8h.html#a13373833ae00ffd733f408836a1eacc1">ICM_20948_OK</a>;</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="_i_c_m20948_8c_source.html#l00934">ICM_20948_accelSampleRateSet()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00907">ICM_20948_gyroSampleRateSet()</a>, and <a class="el" href="pinout_8h_source.html#l00043">ICM_20948_OK</a>.</p>

<p class="reference">Referenced by <a class="el" href="_i_c_m20948_8c_source.html#l01525">ICM_20948_accelGyroCalibrate()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l01736">ICM_20948_gyroCalibrate()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00169">ICM_20948_Init2()</a>, and <a class="el" href="_i_c_m20948_8c_source.html#l01130">ICM_20948_wakeOnMotionITEnable()</a>.</p>

</div>
</div>
<a id="afafb9e426c5a0c760268db0cffd7f46e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afafb9e426c5a0c760268db0cffd7f46e">&#9670;&nbsp;</a></span>ICM_20948_sensorEnable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t ICM_20948_sensorEnable </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>accel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>gyro</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>temp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l00999">999</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;{</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;  uint8_t pwrManagement1;</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;  uint8_t pwrManagement2;</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160; </div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#a9f8e3ac3e31a7d1a441e1a8ceb3470c8">ICM_20948_registerRead</a>(<a class="code" href="pinout_8h.html#a8a5e88ca0ad999c59cc428b8656d4bc1">ICM_20948_REG_PWR_MGMT_1</a>, 1, &amp;pwrManagement1);</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;  pwrManagement2 = 0;</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160; </div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;  <span class="comment">/* To enable the accelerometer clear the DISABLE_ACCEL bits in PWR_MGMT_2 */</span></div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;  <span class="keywordflow">if</span> ( accel ) {</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    pwrManagement2 &amp;= ~(<a class="code" href="pinout_8h.html#ac280fd4992257ea4ae9dea6b84808003">ICM_20948_BIT_PWR_ACCEL_STBY</a>);</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;    pwrManagement2 |= <a class="code" href="pinout_8h.html#ac280fd4992257ea4ae9dea6b84808003">ICM_20948_BIT_PWR_ACCEL_STBY</a>;</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;  }</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160; </div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;  <span class="comment">/* To enable gyro clear the DISABLE_GYRO bits in PWR_MGMT_2 */</span></div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;  <span class="keywordflow">if</span> ( gyro ) {</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    pwrManagement2 &amp;= ~(<a class="code" href="pinout_8h.html#aa232f09e04ad357d8ca276fd6be0cd2b">ICM_20948_BIT_PWR_GYRO_STBY</a>);</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    pwrManagement2 |= <a class="code" href="pinout_8h.html#aa232f09e04ad357d8ca276fd6be0cd2b">ICM_20948_BIT_PWR_GYRO_STBY</a>;</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;  }</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160; </div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;  <span class="comment">/* To enable the temperature sensor clear the TEMP_DIS bit in PWR_MGMT_1 */</span></div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;  <span class="keywordflow">if</span> ( temp ) {</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    pwrManagement1 &amp;= ~(<a class="code" href="pinout_8h.html#a4416d485823527daa43078cd8ca8f2ad">ICM_20948_BIT_TEMP_DIS</a>);</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    pwrManagement1 |= <a class="code" href="pinout_8h.html#a4416d485823527daa43078cd8ca8f2ad">ICM_20948_BIT_TEMP_DIS</a>;</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;  }</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160; </div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;  <span class="comment">/* Write back the modified values */</span></div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#a8a5e88ca0ad999c59cc428b8656d4bc1">ICM_20948_REG_PWR_MGMT_1</a>, pwrManagement1);</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#a713816cc5b0ab71a1ec0e42e4ae4075e">ICM_20948_REG_PWR_MGMT_2</a>, pwrManagement2);</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160; </div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="pinout_8h.html#a13373833ae00ffd733f408836a1eacc1">ICM_20948_OK</a>;</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="pinout_8h_source.html#l00142">ICM_20948_BIT_PWR_ACCEL_STBY</a>, <a class="el" href="pinout_8h_source.html#l00143">ICM_20948_BIT_PWR_GYRO_STBY</a>, <a class="el" href="pinout_8h_source.html#l00138">ICM_20948_BIT_TEMP_DIS</a>, <a class="el" href="pinout_8h_source.html#l00043">ICM_20948_OK</a>, <a class="el" href="pinout_8h_source.html#l00134">ICM_20948_REG_PWR_MGMT_1</a>, <a class="el" href="pinout_8h_source.html#l00141">ICM_20948_REG_PWR_MGMT_2</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00654">ICM_20948_registerRead()</a>, and <a class="el" href="_i_c_m20948_8c_source.html#l00697">ICM_20948_registerWrite()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_i_c_m20948_8c_source.html#l01525">ICM_20948_accelGyroCalibrate()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l01736">ICM_20948_gyroCalibrate()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00169">ICM_20948_Init2()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00963">ICM_20948_lowPowerModeEnter()</a>, and <a class="el" href="_i_c_m20948_8c_source.html#l01130">ICM_20948_wakeOnMotionITEnable()</a>.</p>

</div>
</div>
<a id="ae81d4cfd5ba0ab7962bdc2ad2c002468"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae81d4cfd5ba0ab7962bdc2ad2c002468">&#9670;&nbsp;</a></span>ICM_20948_set_mag_mode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t ICM_20948_set_mag_mode </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>magMode</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l01416">1416</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;                                                {</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;    <span class="keywordflow">switch</span> ( magMode ) {</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="pinout_8h.html#aaf607133986cc433db4c0b97b1d9bd5b">AK09916_BIT_MODE_POWER_DOWN</a>:</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="pinout_8h.html#a16f777b55cb5d93d7d0b870f59579186">AK09916_MODE_SINGLE</a>:</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="pinout_8h.html#aae65925e0df0c418431e90baaf0de47c">AK09916_MODE_10HZ</a>:</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="pinout_8h.html#a83026c54f9cd8f7e0d8278f087f191d1">AK09916_MODE_20HZ</a>:</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="pinout_8h.html#a160112184cf205149c6cebe1cdc77a4a">AK09916_MODE_50HZ</a>:</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="pinout_8h.html#a73c721aa21e9714bd8f15150994975d1">AK09916_MODE_100HZ</a>:</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="pinout_8h.html#a19ed57fde4beb29017b3ae16e97b2c0f">AK09916_MODE_ST</a>:</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="pinout_8h.html#a8fe83ac76edc595f6b98cd4a4127aed5">ERROR</a>;</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;    }</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160; </div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;    <a class="code" href="_i_c_m20948_8c.html#a7ed83e84f5d14637ea91c05174e84dcd">ICM_20948_write_mag_register</a>(<a class="code" href="pinout_8h.html#a67dc220bec5bd3c3c95c909c2629159b">AK09916_REG_CONTROL_2</a>, magMode);</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160; </div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="pinout_8h.html#aba51915c87d64af47fb1cc59348961c9">OK</a>;</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="pinout_8h_source.html#l00384">AK09916_BIT_MODE_POWER_DOWN</a>, <a class="el" href="pinout_8h_source.html#l00389">AK09916_MODE_100HZ</a>, <a class="el" href="pinout_8h_source.html#l00386">AK09916_MODE_10HZ</a>, <a class="el" href="pinout_8h_source.html#l00387">AK09916_MODE_20HZ</a>, <a class="el" href="pinout_8h_source.html#l00388">AK09916_MODE_50HZ</a>, <a class="el" href="pinout_8h_source.html#l00385">AK09916_MODE_SINGLE</a>, <a class="el" href="pinout_8h_source.html#l00390">AK09916_MODE_ST</a>, <a class="el" href="pinout_8h_source.html#l00383">AK09916_REG_CONTROL_2</a>, <a class="el" href="pinout_8h_source.html#l00401">ERROR</a>, <a class="el" href="_i_c_m20948_8c_source.html#l01408">ICM_20948_write_mag_register()</a>, and <a class="el" href="pinout_8h_source.html#l00402">OK</a>.</p>

<p class="reference">Referenced by <a class="el" href="_i_c_m20948_8c_source.html#l00085">ICM_20948_Init()</a>, and <a class="el" href="_i_c_m20948_8c_source.html#l00169">ICM_20948_Init2()</a>.</p>

</div>
</div>
<a id="a0a8b698432306e6b555992507ffaf6ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a8b698432306e6b555992507ffaf6ac">&#9670;&nbsp;</a></span>ICM_20948_set_mag_transfer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ICM_20948_set_mag_transfer </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>read</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l01246">1246</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;                                           {</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    uint8_t MAG_BIT_READ   = <a class="code" href="pinout_8h.html#a61f3332e075b6fde0cbdb5b9c499dba2">AK09916_BIT_I2C_SLV_ADDR</a> | <a class="code" href="pinout_8h.html#a38e158b2dc4b9cbd5daa42cebecd8db1">ICM_20948_BIT_I2C_SLV_READ</a>;</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;    uint8_t MAG_BIT_WRITE  = <a class="code" href="pinout_8h.html#a61f3332e075b6fde0cbdb5b9c499dba2">AK09916_BIT_I2C_SLV_ADDR</a>;</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160; </div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;    <span class="keywordtype">bool</span> read_old = !read;</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160; </div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;    <span class="comment">/* Set transfer mode if it has changed */</span></div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;    <span class="keywordflow">if</span> (read != read_old) {</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;        <span class="keywordflow">if</span> (read) {</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;            <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#adbfa0056aaa35c2a5129ebb66d2a2463">ICM_20948_REG_I2C_SLV0_ADDR</a>, MAG_BIT_READ);</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;        }</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;            <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#adbfa0056aaa35c2a5129ebb66d2a2463">ICM_20948_REG_I2C_SLV0_ADDR</a>, MAG_BIT_WRITE);</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;        }</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;        read_old = read;</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;    }</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="pinout_8h_source.html#l00396">AK09916_BIT_I2C_SLV_ADDR</a>, <a class="el" href="pinout_8h_source.html#l00360">ICM_20948_BIT_I2C_SLV_READ</a>, <a class="el" href="pinout_8h_source.html#l00313">ICM_20948_REG_I2C_SLV0_ADDR</a>, and <a class="el" href="_i_c_m20948_8c_source.html#l00697">ICM_20948_registerWrite()</a>.</p>

</div>
</div>
<a id="a8f1159f4f75b1eaed9a091d01fe76c3d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f1159f4f75b1eaed9a091d01fe76c3d">&#9670;&nbsp;</a></span>ICM_20948_sleepModeEnable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t ICM_20948_sleepModeEnable </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>enable</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sleep mode enable function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">enable</td><td><ul>
<li>'true' - sleep </li>
<li>'false' - active </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l00728">728</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;{</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;  uint8_t reg;</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160; </div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;  <span class="comment">/* Read the Sleep Enable register */</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#a9f8e3ac3e31a7d1a441e1a8ceb3470c8">ICM_20948_registerRead</a>(<a class="code" href="pinout_8h.html#a8a5e88ca0ad999c59cc428b8656d4bc1">ICM_20948_REG_PWR_MGMT_1</a>, 1, &amp;reg);</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160; </div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;  <span class="keywordflow">if</span> ( enable ) {</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    <span class="comment">/* Sleep: set the SLEEP bit */</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    reg |= <a class="code" href="pinout_8h.html#a2203279520f949123d726600a98a1277">ICM_20948_BIT_SLEEP</a>;</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    <span class="comment">/* Wake up: clear the SLEEP bit */</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    <span class="comment">//reg &amp;= ~(ICM_20948_BIT_SLEEP); /* this was the provided code */</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160; </div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    <span class="comment">/* My own solution */</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    <span class="comment">/* AND to define the bits that can be changed: here bit nr 6 */</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    reg &amp;= 0b10111111;</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    <span class="comment">/*OR met 0 to set the SLEEP bit to 0, not really necessary in this case */</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    reg |= 0b00000000;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;  }</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160; </div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#a8a5e88ca0ad999c59cc428b8656d4bc1">ICM_20948_REG_PWR_MGMT_1</a>, reg);</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160; </div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160; </div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="pinout_8h.html#a13373833ae00ffd733f408836a1eacc1">ICM_20948_OK</a>;</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="pinout_8h_source.html#l00136">ICM_20948_BIT_SLEEP</a>, <a class="el" href="pinout_8h_source.html#l00043">ICM_20948_OK</a>, <a class="el" href="pinout_8h_source.html#l00134">ICM_20948_REG_PWR_MGMT_1</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00654">ICM_20948_registerRead()</a>, and <a class="el" href="_i_c_m20948_8c_source.html#l00697">ICM_20948_registerWrite()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_i_c_m20948_8c_source.html#l00169">ICM_20948_Init2()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00963">ICM_20948_lowPowerModeEnter()</a>, and <a class="el" href="_i_c_m20948_8c_source.html#l01130">ICM_20948_wakeOnMotionITEnable()</a>.</p>

</div>
</div>
<a id="a8d0bf2e4c95719f9dfb2e8c286d7a8d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d0bf2e4c95719f9dfb2e8c286d7a8d6">&#9670;&nbsp;</a></span>ICM_20948_wakeOnMotionITEnable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t ICM_20948_wakeOnMotionITEnable </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>enable</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>womThreshold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>sampleRate</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l01130">1130</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;{</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;  <span class="keywordflow">if</span> ( enable ) {</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;    <span class="comment">/* Make sure that the chip is not in sleep */</span></div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;    <a class="code" href="_i_c_m20948_8c.html#a8f1159f4f75b1eaed9a091d01fe76c3d">ICM_20948_sleepModeEnable</a>(<span class="keyword">false</span>);</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160; </div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;    <span class="comment">/* And in continuous mode */</span></div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;    <a class="code" href="_i_c_m20948_8c.html#aa97147c0f9f71cfaea563fb4b1d64306">ICM_20948_cycleModeEnable</a>(<span class="keyword">false</span>);</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160; </div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;    <span class="comment">/* Enable only the accelerometer */</span></div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;    <a class="code" href="_i_c_m20948_8c.html#afafb9e426c5a0c760268db0cffd7f46e">ICM_20948_sensorEnable</a>(<span class="keyword">true</span>, <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160; </div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;    <span class="comment">/* Set sample rate */</span></div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;    <a class="code" href="_i_c_m20948_8c.html#ad640eb781cd8b92ce54c6e51754b36a5">ICM_20948_sampleRateSet</a>(sampleRate);</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160; </div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;    <span class="comment">/* Set the bandwidth to 1210Hz */</span></div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;    <a class="code" href="_i_c_m20948_8c.html#ab6d2dbd77995c450b5cab0068291cc37">ICM_20948_accelBandwidthSet</a>(<a class="code" href="pinout_8h.html#ae757703d2528c846864cc685b22bdbdc">ICM_20948_ACCEL_BW_1210HZ</a>);</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160; </div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;    <span class="comment">/* Accel: 2G full scale */</span></div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;    <a class="code" href="_i_c_m20948_8c.html#a1d964813062ec77bcd52135dab29654d">ICM_20948_accelFullscaleSet</a>(<a class="code" href="pinout_8h.html#a846c2742256a4baae9fdeca2d8d31214">ICM_20948_ACCEL_FULLSCALE_2G</a>);</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160; </div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;    <span class="comment">/* Enable the Wake On Motion interrupt */</span></div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;    <a class="code" href="_i_c_m20948_8c.html#a70ee6c80001c77355f8d6f7e47ba43db">ICM_20948_interruptEnable</a>(<span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;    <a class="code" href="delay_8c.html#adb46f4276f5ddf111153701858f85df6">delay</a>(50);</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160; </div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;    <span class="comment">/* Enable Wake On Motion feature */</span></div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#ab5848846969bfeafb00f106e24e74d90">ICM_20948_REG_ACCEL_INTEL_CTRL</a>, <a class="code" href="pinout_8h.html#a03a286b0c524b0c86eea26404bc7111b">ICM_20948_BIT_ACCEL_INTEL_EN</a> | <a class="code" href="pinout_8h.html#a73e873ebc352fc7cf43e5c85cb546cd9">ICM_20948_BIT_ACCEL_INTEL_MODE</a>);</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160; </div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;    <span class="comment">/* Set the wake on motion threshold value */</span></div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;    <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#a02fd0f7cd6d0e076008a9dac77a717b3">ICM_20948_REG_ACCEL_WOM_THR</a>, womThreshold);</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160; </div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;    <span class="comment">/* Enable low power mode */</span></div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    <a class="code" href="_i_c_m20948_8c.html#a138a0d4e0dcbec3f93bb022ac655d3e7">ICM_20948_lowPowerModeEnter</a>(<span class="keyword">true</span>, <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;    <span class="comment">/* Disable Wake On Motion feature */</span></div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;    <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#ab5848846969bfeafb00f106e24e74d90">ICM_20948_REG_ACCEL_INTEL_CTRL</a>, 0x00);</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160; </div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;    <span class="comment">/* Disable the Wake On Motion interrupt */</span></div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;    <a class="code" href="_i_c_m20948_8c.html#a70ee6c80001c77355f8d6f7e47ba43db">ICM_20948_interruptEnable</a>(<span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160; </div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;    <span class="comment">/* Disable cycle mode */</span></div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;    <a class="code" href="_i_c_m20948_8c.html#aa97147c0f9f71cfaea563fb4b1d64306">ICM_20948_cycleModeEnable</a>(<span class="keyword">false</span>);</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;  }</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160; </div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="pinout_8h.html#a13373833ae00ffd733f408836a1eacc1">ICM_20948_OK</a>;</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="delay_8c_source.html#l00116">delay()</a>, <a class="el" href="pinout_8h_source.html#l00287">ICM_20948_ACCEL_BW_1210HZ</a>, <a class="el" href="pinout_8h_source.html#l00283">ICM_20948_ACCEL_FULLSCALE_2G</a>, <a class="el" href="_i_c_m20948_8c_source.html#l01192">ICM_20948_accelBandwidthSet()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l01104">ICM_20948_accelFullscaleSet()</a>, <a class="el" href="pinout_8h_source.html#l00272">ICM_20948_BIT_ACCEL_INTEL_EN</a>, <a class="el" href="pinout_8h_source.html#l00273">ICM_20948_BIT_ACCEL_INTEL_MODE</a>, <a class="el" href="_i_c_m20948_8c_source.html#l01035">ICM_20948_cycleModeEnable()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00870">ICM_20948_interruptEnable()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00963">ICM_20948_lowPowerModeEnter()</a>, <a class="el" href="pinout_8h_source.html#l00043">ICM_20948_OK</a>, <a class="el" href="pinout_8h_source.html#l00271">ICM_20948_REG_ACCEL_INTEL_CTRL</a>, <a class="el" href="pinout_8h_source.html#l00275">ICM_20948_REG_ACCEL_WOM_THR</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00697">ICM_20948_registerWrite()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00898">ICM_20948_sampleRateSet()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00999">ICM_20948_sensorEnable()</a>, and <a class="el" href="_i_c_m20948_8c_source.html#l00728">ICM_20948_sleepModeEnable()</a>.</p>

</div>
</div>
<a id="a7ed83e84f5d14637ea91c05174e84dcd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ed83e84f5d14637ea91c05174e84dcd">&#9670;&nbsp;</a></span>ICM_20948_write_mag_register()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ICM_20948_write_mag_register </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes a uint8_t to the I2C address of the magnetometer of the ICM_20948. </p>
<dl class="section warning"><dt>Warning</dt><dd>Values not updating, register must be read to update...</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">addr</td><td>The address that needs to be written to. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>The data that needs to be written. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l01408">1408</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;                                                              {</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;    uint8_t wBuffer[2];</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;    wBuffer[0] = addr;</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;    wBuffer[1] = <a class="code" href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a>;</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160; </div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;    <a class="code" href="_i2_c_8c.html#a47431e985fd340e0e1d8a112bfe9ddcc">IIC_WriteBuffer</a>( ( <a class="code" href="pinout_8h.html#a61f3332e075b6fde0cbdb5b9c499dba2">AK09916_BIT_I2C_SLV_ADDR</a> &lt;&lt; 1 ), wBuffer, 2);</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="pinout_8h_source.html#l00396">AK09916_BIT_I2C_SLV_ADDR</a>, <a class="el" href="main_8c_source.html#l00122">data</a>, and <a class="el" href="_i2_c_8c_source.html#l00112">IIC_WriteBuffer()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_i_c_m20948_8c_source.html#l00169">ICM_20948_Init2()</a>, <a class="el" href="_i_c_m20948_8c_source.html#l01486">ICM_20948_reset_mag()</a>, and <a class="el" href="_i_c_m20948_8c_source.html#l01416">ICM_20948_set_mag_mode()</a>.</p>

</div>
</div>
<a id="a0556327f5e2a9693e8928ef676943851"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0556327f5e2a9693e8928ef676943851">&#9670;&nbsp;</a></span>readMagRegister()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char readMagRegister </td>
          <td>(</td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>magreg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l01285">1285</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;{</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;  <span class="comment">// We use slave4, which is oneshot:</span></div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;    <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#a892abfa89a52e8ba9361da738c85c7b5">ICM_20948_REG_I2C_SLV4_ADDR</a>, <a class="code" href="pinout_8h.html#a28de9b6408bb83f4bef537464c6b43f4">ICM_20948_BIT_I2C_READ</a> | <a class="code" href="pinout_8h.html#a61f3332e075b6fde0cbdb5b9c499dba2">AK09916_BIT_I2C_SLV_ADDR</a>);</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#ac8aa6fa64b970326bb6c8cd2c821a99f">ICM_20948_REG_I2C_SLV4_REG</a>, magreg);</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;    <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#aca8df047487d29bd72feed821ae3f408">ICM_20948_REG_I2C_SLV4_CTRL</a>, <a class="code" href="pinout_8h.html#afe0ab3ec567eaa506dd89d9e18bb0640">ICM_20948_BIT_I2C_SLV_EN</a>);</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160; </div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#ab25e7c803027dbf8de4c205763ac39ab">waitForSlave4</a>();</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160; </div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="_i_c_m20948_8c.html#a67648f0e4d9239b0624c22f87a23014c">ICM_20948_read</a>(<a class="code" href="pinout_8h.html#acd987f19674a4aa99b0a902fd97f5b7f">ICM_20948_REG_I2C_SLV4_DI</a>);</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="pinout_8h_source.html#l00396">AK09916_BIT_I2C_SLV_ADDR</a>, <a class="el" href="pinout_8h_source.html#l00343">ICM_20948_BIT_I2C_READ</a>, <a class="el" href="pinout_8h_source.html#l00339">ICM_20948_BIT_I2C_SLV_EN</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00545">ICM_20948_read()</a>, <a class="el" href="pinout_8h_source.html#l00333">ICM_20948_REG_I2C_SLV4_ADDR</a>, <a class="el" href="pinout_8h_source.html#l00335">ICM_20948_REG_I2C_SLV4_CTRL</a>, <a class="el" href="pinout_8h_source.html#l00337">ICM_20948_REG_I2C_SLV4_DI</a>, <a class="el" href="pinout_8h_source.html#l00334">ICM_20948_REG_I2C_SLV4_REG</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00697">ICM_20948_registerWrite()</a>, and <a class="el" href="_i_c_m20948_8c_source.html#l01265">waitForSlave4()</a>.</p>

</div>
</div>
<a id="ab25e7c803027dbf8de4c205763ac39ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab25e7c803027dbf8de4c205763ac39ab">&#9670;&nbsp;</a></span>waitForSlave4()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void waitForSlave4 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l01265">1265</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;{</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;  <span class="comment">// Wait until the data is ready:</span></div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160; </div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;    <a class="code" href="delay_8c.html#adb46f4276f5ddf111153701858f85df6">delay</a>(100);</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> status = <a class="code" href="_i_c_m20948_8c.html#a67648f0e4d9239b0624c22f87a23014c">ICM_20948_read</a>(<a class="code" href="pinout_8h.html#a45b340573ef962261c8641a9401ba691">ICM_20948_REG_I2C_MST_STATUS</a>);</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;    <span class="keywordflow">if</span> (status &amp; <a class="code" href="pinout_8h.html#a979c3313cb8acd9070c677ff2b5e3c60">ICM_20948_BIT_SLV4_NACK</a>)</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;    {</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;<span class="preprocessor">#if DEBUG_DBPRINT == 1 </span><span class="comment">/* DEBUG_DBPRINT */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;        <a class="code" href="dbprint_8h.html#a48c1f5d07dde14219473ff6a89a3f7ba">dbprint</a>(<span class="stringliteral">&quot;Failed to communicate with compass: NACK&quot;</span>);</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* DEBUG_DBPRINT */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;    }</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;    <span class="keywordflow">if</span> (status &amp; <a class="code" href="pinout_8h.html#a4912ec501e0a13e30f34620158979491">ICM_20948_BIT_SLV4_DONE</a>)</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;    {</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;<span class="preprocessor">#if DEBUG_DBPRINT == 1 </span><span class="comment">/* DEBUG_DBPRINT */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;        <a class="code" href="dbprint_8h.html#a48c1f5d07dde14219473ff6a89a3f7ba">dbprint</a>(<span class="stringliteral">&quot;Transaction Done&quot;</span>);</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* DEBUG_DBPRINT */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;    }</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="dbprint_8h.html#a48c1f5d07dde14219473ff6a89a3f7ba">dbprint()</a>, <a class="el" href="delay_8c_source.html#l00116">delay()</a>, <a class="el" href="pinout_8h_source.html#l00164">ICM_20948_BIT_SLV4_DONE</a>, <a class="el" href="pinout_8h_source.html#l00166">ICM_20948_BIT_SLV4_NACK</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00545">ICM_20948_read()</a>, and <a class="el" href="pinout_8h_source.html#l00162">ICM_20948_REG_I2C_MST_STATUS</a>.</p>

<p class="reference">Referenced by <a class="el" href="_i_c_m20948_8c_source.html#l01285">readMagRegister()</a>, and <a class="el" href="_i_c_m20948_8c_source.html#l01298">writeMagRegister()</a>.</p>

</div>
</div>
<a id="a139d96443873e815a9301c1432e640b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a139d96443873e815a9301c1432e640b6">&#9670;&nbsp;</a></span>writeMagRegister()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void writeMagRegister </td>
          <td>(</td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>magreg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>val</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l01298">1298</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;{</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;  <span class="comment">// We use slave4, which is oneshot:</span></div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;    <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#a892abfa89a52e8ba9361da738c85c7b5">ICM_20948_REG_I2C_SLV4_ADDR</a>, <a class="code" href="pinout_8h.html#a61f3332e075b6fde0cbdb5b9c499dba2">AK09916_BIT_I2C_SLV_ADDR</a>);</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;    <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#ac8aa6fa64b970326bb6c8cd2c821a99f">ICM_20948_REG_I2C_SLV4_REG</a>, magreg);</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;    <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#a27828fa2da5bd4751ffea6ef4be5fb77">ICM_20948_REG_I2C_SLV4_DO</a>, val);</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;    <a class="code" href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a>(<a class="code" href="pinout_8h.html#aca8df047487d29bd72feed821ae3f408">ICM_20948_REG_I2C_SLV4_CTRL</a>, <a class="code" href="pinout_8h.html#afe0ab3ec567eaa506dd89d9e18bb0640">ICM_20948_BIT_I2C_SLV_EN</a>);</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160; </div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;  <a class="code" href="_i_c_m20948_8c.html#ab25e7c803027dbf8de4c205763ac39ab">waitForSlave4</a>();</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="pinout_8h_source.html#l00396">AK09916_BIT_I2C_SLV_ADDR</a>, <a class="el" href="pinout_8h_source.html#l00339">ICM_20948_BIT_I2C_SLV_EN</a>, <a class="el" href="pinout_8h_source.html#l00333">ICM_20948_REG_I2C_SLV4_ADDR</a>, <a class="el" href="pinout_8h_source.html#l00335">ICM_20948_REG_I2C_SLV4_CTRL</a>, <a class="el" href="pinout_8h_source.html#l00336">ICM_20948_REG_I2C_SLV4_DO</a>, <a class="el" href="pinout_8h_source.html#l00334">ICM_20948_REG_I2C_SLV4_REG</a>, <a class="el" href="_i_c_m20948_8c_source.html#l00697">ICM_20948_registerWrite()</a>, and <a class="el" href="_i_c_m20948_8c_source.html#l01265">waitForSlave4()</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="af4f8b3c99a79c4980865579a1c46827c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4f8b3c99a79c4980865579a1c46827c">&#9670;&nbsp;</a></span>_hx</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float _hx</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l00057">57</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>

</div>
</div>
<a id="a4f779573a3b06192892ce82c7cd94307"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f779573a3b06192892ce82c7cd94307">&#9670;&nbsp;</a></span>_hxcounts</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int16_t _hxcounts</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l00047">47</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="_i_c_m20948_8c_source.html#l01468">ICM_20948_magDataRead()</a>, and <a class="el" href="_i_c_m20948_8c_source.html#l01441">ICM_20948_magRawDataRead()</a>.</p>

</div>
</div>
<a id="a8acf1481814813e8f32de4964cea8784"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8acf1481814813e8f32de4964cea8784">&#9670;&nbsp;</a></span>_hy</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float _hy</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l00057">57</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>

</div>
</div>
<a id="a26e7f879fbdd01ab7d0fe3a2326e6269"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26e7f879fbdd01ab7d0fe3a2326e6269">&#9670;&nbsp;</a></span>_hycounts</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int16_t _hycounts</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l00047">47</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="_i_c_m20948_8c_source.html#l01468">ICM_20948_magDataRead()</a>, and <a class="el" href="_i_c_m20948_8c_source.html#l01441">ICM_20948_magRawDataRead()</a>.</p>

</div>
</div>
<a id="a5a2efefd564ede42017c7d42dc51816b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a2efefd564ede42017c7d42dc51816b">&#9670;&nbsp;</a></span>_hz</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float _hz</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Not used, int16_t _hxcounts,_hycounts,_hzcounts are used to store magnetometer values </p>

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l00057">57</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>

</div>
</div>
<a id="ad58c847bfe6019ce99e3de59609912ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad58c847bfe6019ce99e3de59609912ed">&#9670;&nbsp;</a></span>_hzcounts</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int16_t _hzcounts</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Magnetometer x, y and z axis values (not calibrated) </p>

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l00047">47</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="_i_c_m20948_8c_source.html#l01468">ICM_20948_magDataRead()</a>, and <a class="el" href="_i_c_m20948_8c_source.html#l01441">ICM_20948_magRawDataRead()</a>.</p>

</div>
</div>
<a id="a498e73167c4bbbdc1221f2d409d44aa1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a498e73167c4bbbdc1221f2d409d44aa1">&#9670;&nbsp;</a></span>_magScale</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float _magScale = (4912.0f) / (32767.5f)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Factor to calulate magn in microTesla from raw values of registers, same as magscale </p>

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l00063">63</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="_i_c_m20948_8c_source.html#l01468">ICM_20948_magDataRead()</a>.</p>

</div>
</div>
<a id="a49bc476f8f7d212fb1c59f1304f2a522"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a49bc476f8f7d212fb1c59f1304f2a522">&#9670;&nbsp;</a></span>accRawScaling</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float accRawScaling = 32767.5f</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>=(2^16-1)/2 16 bit representation of acc value to cover +/- range </p>

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l00059">59</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>

</div>
</div>
<a id="a673e9a567be61e4d8421ecff57bfd4f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a673e9a567be61e4d8421ecff57bfd4f4">&#9670;&nbsp;</a></span>gyroRawScaling</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float gyroRawScaling = 32767.5f</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>=(2^16-1)/2 16 bit representation of gyro value to cover +/- range </p>

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l00060">60</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>

</div>
</div>
<a id="ae523984fd59c5831b8ec8ee73ca1a0b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae523984fd59c5831b8ec8ee73ca1a0b5">&#9670;&nbsp;</a></span>ICM_20948_Initialized</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ICM_20948_Initialized = false</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Variable to keep track if the IMU is initialized </p>

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l00040">40</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="_i_c_m20948_8c_source.html#l00085">ICM_20948_Init()</a>.</p>

</div>
</div>
<a id="a1737d020ba0806fbcf944bea838b2024"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1737d020ba0806fbcf944bea838b2024">&#9670;&nbsp;</a></span>IMU_MEASURING</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool IMU_MEASURING</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Variable to check if IMU is measuring</p>
<p>Keep track of the state of the IMU </p>

<p class="definition">Definition at line <a class="el" href="main_8c_source.html#l00126">126</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

</div>
</div>
<a id="a83301b3809fa28a7a800258bae36d074"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83301b3809fa28a7a800258bae36d074">&#9670;&nbsp;</a></span>mag_minimumRange</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t mag_minimumRange = 40</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Minimum value to look for on each axis of the magnetometer, to make sure the magnetomeres is being rotated </p>

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l00042">42</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="_i_c_m20948_8c_source.html#l01891">ICM_20948_min_max_mag()</a>.</p>

</div>
</div>
<a id="ae69cca96b2cbb9eddab9295fad1a1e07"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae69cca96b2cbb9eddab9295fad1a1e07">&#9670;&nbsp;</a></span>mag_res</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float mag_res = 4912.0f / 32752.0f</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Factor to calulate magn in microTesla from raw values of registers </p>

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l00046">46</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>

</div>
</div>
<a id="ab305f17de293bdb7011e83d6c6636005"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab305f17de293bdb7011e83d6c6636005">&#9670;&nbsp;</a></span>magRawScaling</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float magRawScaling = 32767.5f</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>=(2^16-1)/2 16 bit representation of gyro value to cover +/- range </p>

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l00061">61</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>

</div>
</div>
<a id="a0adc3826aa3bd34b685205b20864ae12"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0adc3826aa3bd34b685205b20864ae12">&#9670;&nbsp;</a></span>tX</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int16_t tX[3] = {1, 0, 0}</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Transformation matrix to put magnetometer in same reference frame as gyro and accel </p>

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l00053">53</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="_i_c_m20948_8c_source.html#l01468">ICM_20948_magDataRead()</a>, and <a class="el" href="_i_c_m20948_8c_source.html#l01441">ICM_20948_magRawDataRead()</a>.</p>

</div>
</div>
<a id="aab96f756fc510c74bd93e749b09a016c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab96f756fc510c74bd93e749b09a016c">&#9670;&nbsp;</a></span>tY</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int16_t tY[3] = {0, -1, 0}</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Transformation matrix to put magnetometer in same reference frame as gyro and accel </p>

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l00054">54</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="_i_c_m20948_8c_source.html#l01441">ICM_20948_magRawDataRead()</a>.</p>

</div>
</div>
<a id="a230ea1bf4635586a5b870d567d0f7a46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a230ea1bf4635586a5b870d567d0f7a46">&#9670;&nbsp;</a></span>tZ</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int16_t tZ[3] = {0, 0, -1}</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Transformation matrix to put magnetometer in same reference frame as gyro and accel </p>

<p class="definition">Definition at line <a class="el" href="_i_c_m20948_8c_source.html#l00055">55</a> of file <a class="el" href="_i_c_m20948_8c_source.html">ICM20948.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="_i_c_m20948_8c_source.html#l01441">ICM_20948_magRawDataRead()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="a_i_c_m20948_8c_html_a230ea1bf4635586a5b870d567d0f7a46"><div class="ttname"><a href="_i_c_m20948_8c.html#a230ea1bf4635586a5b870d567d0f7a46">tZ</a></div><div class="ttdeci">int16_t tZ[3]</div><div class="ttdef"><b>Definition:</b> <a href="_i_c_m20948_8c_source.html#l00055">ICM20948.c:55</a></div></div>
<div class="ttc" id="apinout_8h_html_a9440aae0a94561e6eb963b31e808847d"><div class="ttname"><a href="pinout_8h.html#a9440aae0a94561e6eb963b31e808847d">ICM_20948_REG_FIFO_MODE</a></div><div class="ttdeci">#define ICM_20948_REG_FIFO_MODE</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00206">pinout.h:206</a></div></div>
<div class="ttc" id="apinout_8h_html_a8336d4c1009349fb62b2b41c324df6d4"><div class="ttname"><a href="pinout_8h.html#a8336d4c1009349fb62b2b41c324df6d4">ICM_20948_CLK_PORT</a></div><div class="ttdeci">#define ICM_20948_CLK_PORT</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00052">pinout.h:52</a></div></div>
<div class="ttc" id="apinout_8h_html_aadd93900fc87105fa3ef514675d4133b"><div class="ttname"><a href="pinout_8h.html#aadd93900fc87105fa3ef514675d4133b">SPI</a></div><div class="ttdeci">#define SPI</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00064">pinout.h:64</a></div></div>
<div class="ttc" id="apinout_8h_html_a713816cc5b0ab71a1ec0e42e4ae4075e"><div class="ttname"><a href="pinout_8h.html#a713816cc5b0ab71a1ec0e42e4ae4075e">ICM_20948_REG_PWR_MGMT_2</a></div><div class="ttdeci">#define ICM_20948_REG_PWR_MGMT_2</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00141">pinout.h:141</a></div></div>
<div class="ttc" id="apinout_8h_html_ae44b5f1593f857ce2cd496c6016bd965"><div class="ttname"><a href="pinout_8h.html#ae44b5f1593f857ce2cd496c6016bd965">ICM_20948_REG_INT_ENABLE_1</a></div><div class="ttdeci">#define ICM_20948_REG_INT_ENABLE_1</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00154">pinout.h:154</a></div></div>
<div class="ttc" id="apinout_8h_html_a2203279520f949123d726600a98a1277"><div class="ttname"><a href="pinout_8h.html#a2203279520f949123d726600a98a1277">ICM_20948_BIT_SLEEP</a></div><div class="ttdeci">#define ICM_20948_BIT_SLEEP</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00136">pinout.h:136</a></div></div>
<div class="ttc" id="apinout_8h_html_ae89bf6882283104289a3be37ddfb5880"><div class="ttname"><a href="pinout_8h.html#ae89bf6882283104289a3be37ddfb5880">ICM_20948_ACCEL_FULLSCALE_8G</a></div><div class="ttdeci">#define ICM_20948_ACCEL_FULLSCALE_8G</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00285">pinout.h:285</a></div></div>
<div class="ttc" id="a_i_c_m20948_8c_html_ad7988a26a892dc9f22714fef8005f42e"><div class="ttname"><a href="_i_c_m20948_8c.html#ad7988a26a892dc9f22714fef8005f42e">ICM_20948_gyroBandwidthSet</a></div><div class="ttdeci">uint32_t ICM_20948_gyroBandwidthSet(uint8_t gyroBw)</div><div class="ttdef"><b>Definition:</b> <a href="_i_c_m20948_8c_source.html#l01177">ICM20948.c:1177</a></div></div>
<div class="ttc" id="apinout_8h_html_aa133915b0d77dca50e7251cc8ee11ab2"><div class="ttname"><a href="pinout_8h.html#aa133915b0d77dca50e7251cc8ee11ab2">ICM_20948_MOSI_PORT</a></div><div class="ttdeci">#define ICM_20948_MOSI_PORT</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00056">pinout.h:56</a></div></div>
<div class="ttc" id="apinout_8h_html_a3bc32b18ec90ca56ec6619f5b1c6b9ab"><div class="ttname"><a href="pinout_8h.html#a3bc32b18ec90ca56ec6619f5b1c6b9ab">ICM_20948_BIT_LP_EN</a></div><div class="ttdeci">#define ICM_20948_BIT_LP_EN</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00137">pinout.h:137</a></div></div>
<div class="ttc" id="apinout_8h_html_a03229ea158a1c4d062ba339eeed45e31"><div class="ttname"><a href="pinout_8h.html#a03229ea158a1c4d062ba339eeed45e31">ICM_20948_GYRO_FULLSCALE_1000DPS</a></div><div class="ttdeci">#define ICM_20948_GYRO_FULLSCALE_1000DPS</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00244">pinout.h:244</a></div></div>
<div class="ttc" id="a_i_c_m20948_8c_html_a2e019e8fd51a6ca5c169d3e6ee48542f"><div class="ttname"><a href="_i_c_m20948_8c.html#a2e019e8fd51a6ca5c169d3e6ee48542f">ICM_20948_chipSelectSet</a></div><div class="ttdeci">void ICM_20948_chipSelectSet(bool enable)</div><div class="ttdoc">Set chipselect pin for SPI functionality.</div><div class="ttdef"><b>Definition:</b> <a href="_i_c_m20948_8c_source.html#l00480">ICM20948.c:480</a></div></div>
<div class="ttc" id="apinout_8h_html_aaf8b8308b248e140d63fe8e0d91c771c"><div class="ttname"><a href="pinout_8h.html#aaf8b8308b248e140d63fe8e0d91c771c">ICM_20948_GYRO_FULLSCALE_2000DPS</a></div><div class="ttdeci">#define ICM_20948_GYRO_FULLSCALE_2000DPS</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00245">pinout.h:245</a></div></div>
<div class="ttc" id="apinout_8h_html_a38e7d91cf85ad7c73099aa8c0bdb107a"><div class="ttname"><a href="pinout_8h.html#a38e7d91cf85ad7c73099aa8c0bdb107a">ICM_20948_MASK_ACCEL_FULLSCALE</a></div><div class="ttdeci">#define ICM_20948_MASK_ACCEL_FULLSCALE</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00281">pinout.h:281</a></div></div>
<div class="ttc" id="amain_8c_html_ad2c9072e6e6a5758dfc647e1a08a9509"><div class="ttname"><a href="main_8c.html#ad2c9072e6e6a5758dfc647e1a08a9509">data</a></div><div class="ttdeci">MeasurementData_t data</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00122">main.c:122</a></div></div>
<div class="ttc" id="a_i_c_m20948_8c_html_a4c64c7bd58f7e6dafb61fddd98fe9250"><div class="ttname"><a href="_i_c_m20948_8c.html#a4c64c7bd58f7e6dafb61fddd98fe9250">ICM_20948_accelResolutionGet</a></div><div class="ttdeci">uint32_t ICM_20948_accelResolutionGet(float *accelRes)</div><div class="ttdef"><b>Definition:</b> <a href="_i_c_m20948_8c_source.html#l01074">ICM20948.c:1074</a></div></div>
<div class="ttc" id="apinout_8h_html_a02fd0f7cd6d0e076008a9dac77a717b3"><div class="ttname"><a href="pinout_8h.html#a02fd0f7cd6d0e076008a9dac77a717b3">ICM_20948_REG_ACCEL_WOM_THR</a></div><div class="ttdeci">#define ICM_20948_REG_ACCEL_WOM_THR</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00275">pinout.h:275</a></div></div>
<div class="ttc" id="apinout_8h_html_a5289e29f8f2c93a7bdc2bcad610e3f89"><div class="ttname"><a href="pinout_8h.html#a5289e29f8f2c93a7bdc2bcad610e3f89">ICM20948_DEVICE_ID</a></div><div class="ttdeci">#define ICM20948_DEVICE_ID</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00351">pinout.h:351</a></div></div>
<div class="ttc" id="apinout_8h_html_a95d2daf38dcdee5ab42ec6b7bb7447e9"><div class="ttname"><a href="pinout_8h.html#a95d2daf38dcdee5ab42ec6b7bb7447e9">ICM_20948_REG_FIFO_COUNT_H</a></div><div class="ttdeci">#define ICM_20948_REG_FIFO_COUNT_H</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00208">pinout.h:208</a></div></div>
<div class="ttc" id="a_i_c_m20948_8c_html_ab79679ad6161de947d8bfb16a34b4187"><div class="ttname"><a href="_i_c_m20948_8c.html#ab79679ad6161de947d8bfb16a34b4187">ICM_20948_latchEnable</a></div><div class="ttdeci">uint32_t ICM_20948_latchEnable(bool enable)</div><div class="ttdoc">Enables / disables the 50 micro seconds interrupt pin functionality.</div><div class="ttdef"><b>Definition:</b> <a href="_i_c_m20948_8c_source.html#l01219">ICM20948.c:1219</a></div></div>
<div class="ttc" id="apinout_8h_html_a9b41d4bcc632c0bb90dd3102c866e992"><div class="ttname"><a href="pinout_8h.html#a9b41d4bcc632c0bb90dd3102c866e992">ICM_20948_ACCEL_BW_246HZ</a></div><div class="ttdeci">#define ICM_20948_ACCEL_BW_246HZ</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00289">pinout.h:289</a></div></div>
<div class="ttc" id="a_i_c_m20948_8c_html_ad58c847bfe6019ce99e3de59609912ed"><div class="ttname"><a href="_i_c_m20948_8c.html#ad58c847bfe6019ce99e3de59609912ed">_hzcounts</a></div><div class="ttdeci">int16_t _hzcounts</div><div class="ttdef"><b>Definition:</b> <a href="_i_c_m20948_8c_source.html#l00047">ICM20948.c:47</a></div></div>
<div class="ttc" id="apinout_8h_html_a9686a67d02b1d84561f98fed7c93bfd6"><div class="ttname"><a href="pinout_8h.html#a9686a67d02b1d84561f98fed7c93bfd6">AK09916_REG_WHO_AM_I</a></div><div class="ttdeci">#define AK09916_REG_WHO_AM_I</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00395">pinout.h:395</a></div></div>
<div class="ttc" id="apinout_8h_html_a61f3332e075b6fde0cbdb5b9c499dba2"><div class="ttname"><a href="pinout_8h.html#a61f3332e075b6fde0cbdb5b9c499dba2">AK09916_BIT_I2C_SLV_ADDR</a></div><div class="ttdeci">#define AK09916_BIT_I2C_SLV_ADDR</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00396">pinout.h:396</a></div></div>
<div class="ttc" id="a_i_c_m20948_8c_html_a7ed83e84f5d14637ea91c05174e84dcd"><div class="ttname"><a href="_i_c_m20948_8c.html#a7ed83e84f5d14637ea91c05174e84dcd">ICM_20948_write_mag_register</a></div><div class="ttdeci">void ICM_20948_write_mag_register(uint8_t addr, uint8_t data)</div><div class="ttdoc">Writes a uint8_t to the I2C address of the magnetometer of the ICM_20948.</div><div class="ttdef"><b>Definition:</b> <a href="_i_c_m20948_8c_source.html#l01408">ICM20948.c:1408</a></div></div>
<div class="ttc" id="a_i_c_m20948_8c_html_a138a0d4e0dcbec3f93bb022ac655d3e7"><div class="ttname"><a href="_i_c_m20948_8c.html#a138a0d4e0dcbec3f93bb022ac655d3e7">ICM_20948_lowPowerModeEnter</a></div><div class="ttdeci">uint32_t ICM_20948_lowPowerModeEnter(bool enAccel, bool enGyro, bool enTemp)</div><div class="ttdef"><b>Definition:</b> <a href="_i_c_m20948_8c_source.html#l00963">ICM20948.c:963</a></div></div>
<div class="ttc" id="apinout_8h_html_a69c539b22f71fe2bad24af7e3ccfe8b2"><div class="ttname"><a href="pinout_8h.html#a69c539b22f71fe2bad24af7e3ccfe8b2">ICM_20948_POWER_PORT</a></div><div class="ttdeci">#define ICM_20948_POWER_PORT</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00031">pinout.h:31</a></div></div>
<div class="ttc" id="apinout_8h_html_ad568402dff8559f29934806865f9b3ad"><div class="ttname"><a href="pinout_8h.html#ad568402dff8559f29934806865f9b3ad">ICM_20948_POWER_PIN</a></div><div class="ttdeci">#define ICM_20948_POWER_PIN</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00030">pinout.h:30</a></div></div>
<div class="ttc" id="a_i_c_m20948_8c_html_a1d964813062ec77bcd52135dab29654d"><div class="ttname"><a href="_i_c_m20948_8c.html#a1d964813062ec77bcd52135dab29654d">ICM_20948_accelFullscaleSet</a></div><div class="ttdeci">uint32_t ICM_20948_accelFullscaleSet(uint8_t accelFs)</div><div class="ttdef"><b>Definition:</b> <a href="_i_c_m20948_8c_source.html#l01104">ICM20948.c:1104</a></div></div>
<div class="ttc" id="apinout_8h_html_a902981b99c2eaa27bdc951fbc917e7bb"><div class="ttname"><a href="pinout_8h.html#a902981b99c2eaa27bdc951fbc917e7bb">ICM_20948_MISO_PIN</a></div><div class="ttdeci">#define ICM_20948_MISO_PIN</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00053">pinout.h:53</a></div></div>
<div class="ttc" id="a_i_c_m20948_8c_html_a26e7f879fbdd01ab7d0fe3a2326e6269"><div class="ttname"><a href="_i_c_m20948_8c.html#a26e7f879fbdd01ab7d0fe3a2326e6269">_hycounts</a></div><div class="ttdeci">int16_t _hycounts</div><div class="ttdef"><b>Definition:</b> <a href="_i_c_m20948_8c_source.html#l00047">ICM20948.c:47</a></div></div>
<div class="ttc" id="a_i_c_m20948_8c_html_ae523984fd59c5831b8ec8ee73ca1a0b5"><div class="ttname"><a href="_i_c_m20948_8c.html#ae523984fd59c5831b8ec8ee73ca1a0b5">ICM_20948_Initialized</a></div><div class="ttdeci">bool ICM_20948_Initialized</div><div class="ttdef"><b>Definition:</b> <a href="_i_c_m20948_8c_source.html#l00040">ICM20948.c:40</a></div></div>
<div class="ttc" id="apinout_8h_html_a19ed57fde4beb29017b3ae16e97b2c0f"><div class="ttname"><a href="pinout_8h.html#a19ed57fde4beb29017b3ae16e97b2c0f">AK09916_MODE_ST</a></div><div class="ttdeci">#define AK09916_MODE_ST</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00390">pinout.h:390</a></div></div>
<div class="ttc" id="apinout_8h_html_a755fc25f9872d5f5f300f892eb672c81"><div class="ttname"><a href="pinout_8h.html#a755fc25f9872d5f5f300f892eb672c81">ICM_20948_BIT_RAW_DATA_0_RDY_EN</a></div><div class="ttdeci">#define ICM_20948_BIT_RAW_DATA_0_RDY_EN</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00155">pinout.h:155</a></div></div>
<div class="ttc" id="a_i_c_m20948_8c_html_a83301b3809fa28a7a800258bae36d074"><div class="ttname"><a href="_i_c_m20948_8c.html#a83301b3809fa28a7a800258bae36d074">mag_minimumRange</a></div><div class="ttdeci">int32_t mag_minimumRange</div><div class="ttdef"><b>Definition:</b> <a href="_i_c_m20948_8c_source.html#l00042">ICM20948.c:42</a></div></div>
<div class="ttc" id="apinout_8h_html_ab8cba5978077c7abf4cfc104c4905da5"><div class="ttname"><a href="pinout_8h.html#ab8cba5978077c7abf4cfc104c4905da5">ICM_20948_REG_ZG_OFFS_USRH</a></div><div class="ttdeci">#define ICM_20948_REG_ZG_OFFS_USRH</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00263">pinout.h:263</a></div></div>
<div class="ttc" id="a_i_c_m20948_8c_html_ab25e7c803027dbf8de4c205763ac39ab"><div class="ttname"><a href="_i_c_m20948_8c.html#ab25e7c803027dbf8de4c205763ac39ab">waitForSlave4</a></div><div class="ttdeci">void waitForSlave4()</div><div class="ttdef"><b>Definition:</b> <a href="_i_c_m20948_8c_source.html#l01265">ICM20948.c:1265</a></div></div>
<div class="ttc" id="apinout_8h_html_a160112184cf205149c6cebe1cdc77a4a"><div class="ttname"><a href="pinout_8h.html#a160112184cf205149c6cebe1cdc77a4a">AK09916_MODE_50HZ</a></div><div class="ttdeci">#define AK09916_MODE_50HZ</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00388">pinout.h:388</a></div></div>
<div class="ttc" id="apinout_8h_html_a83026c54f9cd8f7e0d8278f087f191d1"><div class="ttname"><a href="pinout_8h.html#a83026c54f9cd8f7e0d8278f087f191d1">AK09916_MODE_20HZ</a></div><div class="ttdeci">#define AK09916_MODE_20HZ</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00387">pinout.h:387</a></div></div>
<div class="ttc" id="apinout_8h_html_a53aaddcfcc2e63e14abc3bebefc26277"><div class="ttname"><a href="pinout_8h.html#a53aaddcfcc2e63e14abc3bebefc26277">ICM_20948_REG_FIFO_RST</a></div><div class="ttdeci">#define ICM_20948_REG_FIFO_RST</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00205">pinout.h:205</a></div></div>
<div class="ttc" id="adbprint_8h_html_a48c1f5d07dde14219473ff6a89a3f7ba"><div class="ttname"><a href="dbprint_8h.html#a48c1f5d07dde14219473ff6a89a3f7ba">dbprint</a></div><div class="ttdeci">void dbprint(char *message)</div></div>
<div class="ttc" id="apinout_8h_html_a7cf7d10cffb3c1fce9e43ab116b0f869"><div class="ttname"><a href="pinout_8h.html#a7cf7d10cffb3c1fce9e43ab116b0f869">ICM_20948_REG_XG_OFFS_USRL</a></div><div class="ttdeci">#define ICM_20948_REG_XG_OFFS_USRL</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00260">pinout.h:260</a></div></div>
<div class="ttc" id="adelay_8c_html_adb46f4276f5ddf111153701858f85df6"><div class="ttname"><a href="delay_8c.html#adb46f4276f5ddf111153701858f85df6">delay</a></div><div class="ttdeci">void delay(uint32_t msDelay)</div><div class="ttdoc">Wait for a certain amount of milliseconds in EM2/3.</div><div class="ttdef"><b>Definition:</b> <a href="delay_8c_source.html#l00116">delay.c:116</a></div></div>
<div class="ttc" id="apinout_8h_html_acd987f19674a4aa99b0a902fd97f5b7f"><div class="ttname"><a href="pinout_8h.html#acd987f19674a4aa99b0a902fd97f5b7f">ICM_20948_REG_I2C_SLV4_DI</a></div><div class="ttdeci">#define ICM_20948_REG_I2C_SLV4_DI</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00337">pinout.h:337</a></div></div>
<div class="ttc" id="apinout_8h_html_a8fe83ac76edc595f6b98cd4a4127aed5"><div class="ttname"><a href="pinout_8h.html#a8fe83ac76edc595f6b98cd4a4127aed5">ERROR</a></div><div class="ttdeci">#define ERROR</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00401">pinout.h:401</a></div></div>
<div class="ttc" id="apinout_8h_html_afb3b1ca4834bff9fb779999bfd05b602"><div class="ttname"><a href="pinout_8h.html#afb3b1ca4834bff9fb779999bfd05b602">ICM_20948_BIT_WOM_INT_EN</a></div><div class="ttdeci">#define ICM_20948_BIT_WOM_INT_EN</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00152">pinout.h:152</a></div></div>
<div class="ttc" id="adbprint_8h_html_a4e4e18f85e358d8cc702ea8c2f190503"><div class="ttname"><a href="dbprint_8h.html#a4e4e18f85e358d8cc702ea8c2f190503">dbprintInt</a></div><div class="ttdeci">void dbprintInt(int32_t value)</div></div>
<div class="ttc" id="apinout_8h_html_aaf6de67942c3c78b0272790078630d85"><div class="ttname"><a href="pinout_8h.html#aaf6de67942c3c78b0272790078630d85">ICM_20948_BIT_GYRO_CYCLE</a></div><div class="ttdeci">#define ICM_20948_BIT_GYRO_CYCLE</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00132">pinout.h:132</a></div></div>
<div class="ttc" id="apinout_8h_html_a4416d485823527daa43078cd8ca8f2ad"><div class="ttname"><a href="pinout_8h.html#a4416d485823527daa43078cd8ca8f2ad">ICM_20948_BIT_TEMP_DIS</a></div><div class="ttdeci">#define ICM_20948_BIT_TEMP_DIS</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00138">pinout.h:138</a></div></div>
<div class="ttc" id="apinout_8h_html_a531e6eb9bdda040f6d5e56a02dec7c36"><div class="ttname"><a href="pinout_8h.html#a531e6eb9bdda040f6d5e56a02dec7c36">ICM_20948_I2C_ADDRESS</a></div><div class="ttdeci">#define ICM_20948_I2C_ADDRESS</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00026">pinout.h:26</a></div></div>
<div class="ttc" id="apinout_8h_html_aa232f09e04ad357d8ca276fd6be0cd2b"><div class="ttname"><a href="pinout_8h.html#aa232f09e04ad357d8ca276fd6be0cd2b">ICM_20948_BIT_PWR_GYRO_STBY</a></div><div class="ttdeci">#define ICM_20948_BIT_PWR_GYRO_STBY</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00143">pinout.h:143</a></div></div>
<div class="ttc" id="apinout_8h_html_a559f5e3cf33135820776dc875da00766"><div class="ttname"><a href="pinout_8h.html#a559f5e3cf33135820776dc875da00766">ICM_20948_REG_XG_OFFS_USRH</a></div><div class="ttdeci">#define ICM_20948_REG_XG_OFFS_USRH</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00259">pinout.h:259</a></div></div>
<div class="ttc" id="a_i_c_m20948_8c_html_afafb9e426c5a0c760268db0cffd7f46e"><div class="ttname"><a href="_i_c_m20948_8c.html#afafb9e426c5a0c760268db0cffd7f46e">ICM_20948_sensorEnable</a></div><div class="ttdeci">uint32_t ICM_20948_sensorEnable(bool accel, bool gyro, bool temp)</div><div class="ttdef"><b>Definition:</b> <a href="_i_c_m20948_8c_source.html#l00999">ICM20948.c:999</a></div></div>
<div class="ttc" id="a_i_c_m20948_8c_html_afca99859e232ac24c63406fb22a8bd46"><div class="ttname"><a href="_i_c_m20948_8c.html#afca99859e232ac24c63406fb22a8bd46">ICM_20948_accelSampleRateSet</a></div><div class="ttdeci">float ICM_20948_accelSampleRateSet(float sampleRate)</div><div class="ttdef"><b>Definition:</b> <a href="_i_c_m20948_8c_source.html#l00934">ICM20948.c:934</a></div></div>
<div class="ttc" id="atimer_8c_html_acd8d13c328bebdf9eddea27ff9448c2d"><div class="ttname"><a href="timer_8c.html#acd8d13c328bebdf9eddea27ff9448c2d">millis</a></div><div class="ttdeci">uint32_t millis(void)</div><div class="ttdoc">Millis Arduino like functionality for EFM32HG.</div><div class="ttdef"><b>Definition:</b> <a href="timer_8c_source.html#l00024">timer.c:24</a></div></div>
<div class="ttc" id="a_i_c_m20948_8c_html_a0adc3826aa3bd34b685205b20864ae12"><div class="ttname"><a href="_i_c_m20948_8c.html#a0adc3826aa3bd34b685205b20864ae12">tX</a></div><div class="ttdeci">int16_t tX[3]</div><div class="ttdef"><b>Definition:</b> <a href="_i_c_m20948_8c_source.html#l00053">ICM20948.c:53</a></div></div>
<div class="ttc" id="apinout_8h_html_a5ebf48f2fe9665273b6985b18ecd1c79"><div class="ttname"><a href="pinout_8h.html#a5ebf48f2fe9665273b6985b18ecd1c79">ICM_20948_REG_YG_OFFS_USRL</a></div><div class="ttdeci">#define ICM_20948_REG_YG_OFFS_USRL</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00262">pinout.h:262</a></div></div>
<div class="ttc" id="apinout_8h_html_a8e84a66c29d07e5d0814f0e01082b9e3"><div class="ttname"><a href="pinout_8h.html#a8e84a66c29d07e5d0814f0e01082b9e3">ICM_20948_REG_USER_CTRL</a></div><div class="ttdeci">#define ICM_20948_REG_USER_CTRL</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00121">pinout.h:121</a></div></div>
<div class="ttc" id="apinout_8h_html_a97d6879075986a07b27a990bac9c8e4e"><div class="ttname"><a href="pinout_8h.html#a97d6879075986a07b27a990bac9c8e4e">ICM_20948_REG_YA_OFFSET_H</a></div><div class="ttdeci">#define ICM_20948_REG_YA_OFFSET_H</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00224">pinout.h:224</a></div></div>
<div class="ttc" id="apinout_8h_html_ad81b648867cec861909b82395796f384"><div class="ttname"><a href="pinout_8h.html#ad81b648867cec861909b82395796f384">ICM_20948_BIT_ACCEL_CYCLE</a></div><div class="ttdeci">#define ICM_20948_BIT_ACCEL_CYCLE</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00131">pinout.h:131</a></div></div>
<div class="ttc" id="apinout_8h_html_ae581a6346270cbca97bf1f8ef1779929"><div class="ttname"><a href="pinout_8h.html#ae581a6346270cbca97bf1f8ef1779929">ICM_20948_GYRO_BW_12HZ</a></div><div class="ttdeci">#define ICM_20948_GYRO_BW_12HZ</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00253">pinout.h:253</a></div></div>
<div class="ttc" id="apinout_8h_html_ae757703d2528c846864cc685b22bdbdc"><div class="ttname"><a href="pinout_8h.html#ae757703d2528c846864cc685b22bdbdc">ICM_20948_ACCEL_BW_1210HZ</a></div><div class="ttdeci">#define ICM_20948_ACCEL_BW_1210HZ</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00287">pinout.h:287</a></div></div>
<div class="ttc" id="apinout_8h_html_a6dfa2dd0acd27971e3fa251fa541fb5b"><div class="ttname"><a href="pinout_8h.html#a6dfa2dd0acd27971e3fa251fa541fb5b">ICM_20948_ACCEL_FULLSCALE_4G</a></div><div class="ttdeci">#define ICM_20948_ACCEL_FULLSCALE_4G</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00284">pinout.h:284</a></div></div>
<div class="ttc" id="apinout_8h_html_a990648feebc0cd0748e4bd7e44e91ec2"><div class="ttname"><a href="pinout_8h.html#a990648feebc0cd0748e4bd7e44e91ec2">ICM_20948_REG_INT_ENABLE</a></div><div class="ttdeci">#define ICM_20948_REG_INT_ENABLE</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00151">pinout.h:151</a></div></div>
<div class="ttc" id="apinout_8h_html_a03e8f839a9d7005f414ce4011ed6a8cb"><div class="ttname"><a href="pinout_8h.html#a03e8f839a9d7005f414ce4011ed6a8cb">ICM_20948_REG_BANK_SEL</a></div><div class="ttdeci">#define ICM_20948_REG_BANK_SEL</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00346">pinout.h:346</a></div></div>
<div class="ttc" id="a_i_c_m20948_8c_html_a0d8a914c518d9d869d3e4d9b7afeb672"><div class="ttname"><a href="_i_c_m20948_8c.html#a0d8a914c518d9d869d3e4d9b7afeb672">ICM_20948_min_max_mag</a></div><div class="ttdeci">uint32_t ICM_20948_min_max_mag(int16_t *minMag, int16_t *maxMag)</div><div class="ttdoc">Calculate minimum and maximum magnetometer values, which are used for calibration.</div><div class="ttdef"><b>Definition:</b> <a href="_i_c_m20948_8c_source.html#l01891">ICM20948.c:1891</a></div></div>
<div class="ttc" id="apinout_8h_html_aa63441f6bf3dba9851a7c6d37666757f"><div class="ttname"><a href="pinout_8h.html#aa63441f6bf3dba9851a7c6d37666757f">AK09916_REG_CONTROL_3</a></div><div class="ttdeci">#define AK09916_REG_CONTROL_3</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00392">pinout.h:392</a></div></div>
<div class="ttc" id="a_i_c_m20948_8c_html_aab96f756fc510c74bd93e749b09a016c"><div class="ttname"><a href="_i_c_m20948_8c.html#aab96f756fc510c74bd93e749b09a016c">tY</a></div><div class="ttdeci">int16_t tY[3]</div><div class="ttdef"><b>Definition:</b> <a href="_i_c_m20948_8c_source.html#l00054">ICM20948.c:54</a></div></div>
<div class="ttc" id="apinout_8h_html_a469908674e4f0c229b8fbd8c53f7001e"><div class="ttname"><a href="pinout_8h.html#a469908674e4f0c229b8fbd8c53f7001e">ICM_20948_MOSI_PIN</a></div><div class="ttdeci">#define ICM_20948_MOSI_PIN</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00055">pinout.h:55</a></div></div>
<div class="ttc" id="apinout_8h_html_a73c721aa21e9714bd8f15150994975d1"><div class="ttname"><a href="pinout_8h.html#a73c721aa21e9714bd8f15150994975d1">AK09916_MODE_100HZ</a></div><div class="ttdeci">#define AK09916_MODE_100HZ</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00389">pinout.h:389</a></div></div>
<div class="ttc" id="a_i_c_m20948_8c_html_ad640eb781cd8b92ce54c6e51754b36a5"><div class="ttname"><a href="_i_c_m20948_8c.html#ad640eb781cd8b92ce54c6e51754b36a5">ICM_20948_sampleRateSet</a></div><div class="ttdeci">uint32_t ICM_20948_sampleRateSet(float sampleRate)</div><div class="ttdef"><b>Definition:</b> <a href="_i_c_m20948_8c_source.html#l00898">ICM20948.c:898</a></div></div>
<div class="ttc" id="apinout_8h_html_a87f6d7ff993213f7739193e6428345c4"><div class="ttname"><a href="pinout_8h.html#a87f6d7ff993213f7739193e6428345c4">ICM_20948_GYRO_FULLSCALE_500DPS</a></div><div class="ttdeci">#define ICM_20948_GYRO_FULLSCALE_500DPS</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00243">pinout.h:243</a></div></div>
<div class="ttc" id="apinout_8h_html_a2b9e2b8a1852e9e0f4b21596881d5217"><div class="ttname"><a href="pinout_8h.html#a2b9e2b8a1852e9e0f4b21596881d5217">ICM_20948_BIT_ACCEL_FIFO_EN</a></div><div class="ttdeci">#define ICM_20948_BIT_ACCEL_FIFO_EN</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00202">pinout.h:202</a></div></div>
<div class="ttc" id="apinout_8h_html_a00b373a61a80ab610518bd076b53b4d9"><div class="ttname"><a href="pinout_8h.html#a00b373a61a80ab610518bd076b53b4d9">ICM_20948_REG_FIFO_R_W</a></div><div class="ttdeci">#define ICM_20948_REG_FIFO_R_W</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00210">pinout.h:210</a></div></div>
<div class="ttc" id="apinout_8h_html_a8411d9aa97e8979df80e4d5e451c1716"><div class="ttname"><a href="pinout_8h.html#a8411d9aa97e8979df80e4d5e451c1716">ICM_20948_REG_XA_OFFSET_L</a></div><div class="ttdeci">#define ICM_20948_REG_XA_OFFSET_L</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00223">pinout.h:223</a></div></div>
<div class="ttc" id="apinout_8h_html_a663daa01e565aee93c6f20c5845b90b4"><div class="ttname"><a href="pinout_8h.html#a663daa01e565aee93c6f20c5845b90b4">LED_PORT</a></div><div class="ttdeci">#define LED_PORT</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00020">pinout.h:20</a></div></div>
<div class="ttc" id="apinout_8h_html_a374a20bea1db9d4341c467bf92097f65"><div class="ttname"><a href="pinout_8h.html#a374a20bea1db9d4341c467bf92097f65">ICM_20948_BIT_H_RESET</a></div><div class="ttdeci">#define ICM_20948_BIT_H_RESET</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00135">pinout.h:135</a></div></div>
<div class="ttc" id="apinout_8h_html_a27828fa2da5bd4751ffea6ef4be5fb77"><div class="ttname"><a href="pinout_8h.html#a27828fa2da5bd4751ffea6ef4be5fb77">ICM_20948_REG_I2C_SLV4_DO</a></div><div class="ttdeci">#define ICM_20948_REG_I2C_SLV4_DO</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00336">pinout.h:336</a></div></div>
<div class="ttc" id="adbprint_8h_html_a05cd4086fbb7c752337b52c49c31d16b"><div class="ttname"><a href="dbprint_8h.html#a05cd4086fbb7c752337b52c49c31d16b">dbprintlnInt</a></div><div class="ttdeci">void dbprintlnInt(int32_t value)</div></div>
<div class="ttc" id="apinout_8h_html_ab3282b1476aecb42bb3863432bbc7221"><div class="ttname"><a href="pinout_8h.html#ab3282b1476aecb42bb3863432bbc7221">ICM_20948_REG_GYRO_SMPLRT_DIV</a></div><div class="ttdeci">#define ICM_20948_REG_GYRO_SMPLRT_DIV</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00234">pinout.h:234</a></div></div>
<div class="ttc" id="apinout_8h_html_acf0092735df1a1b40aeedcfbb4ea8d8f"><div class="ttname"><a href="pinout_8h.html#acf0092735df1a1b40aeedcfbb4ea8d8f">ICM_20948_REG_ACCEL_SMPLRT_DIV_2</a></div><div class="ttdeci">#define ICM_20948_REG_ACCEL_SMPLRT_DIV_2</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00269">pinout.h:269</a></div></div>
<div class="ttc" id="a_i2_c_8c_html_adc2aa003a8bc13c866e90661fa908189"><div class="ttname"><a href="_i2_c_8c.html#adc2aa003a8bc13c866e90661fa908189">IIC_Init</a></div><div class="ttdeci">void IIC_Init(void)</div><div class="ttdoc">Setup I2C functionality.</div><div class="ttdef"><b>Definition:</b> <a href="_i2_c_8c_source.html#l00052">I2C.c:52</a></div></div>
<div class="ttc" id="apinout_8h_html_adbfa0056aaa35c2a5129ebb66d2a2463"><div class="ttname"><a href="pinout_8h.html#adbfa0056aaa35c2a5129ebb66d2a2463">ICM_20948_REG_I2C_SLV0_ADDR</a></div><div class="ttdeci">#define ICM_20948_REG_I2C_SLV0_ADDR</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00313">pinout.h:313</a></div></div>
<div class="ttc" id="apinout_8h_html_aa527cd2683d444f64c67228d15c67dfd"><div class="ttname"><a href="pinout_8h.html#aa527cd2683d444f64c67228d15c67dfd">ICM_20948_REG_ACCEL_CONFIG</a></div><div class="ttdeci">#define ICM_20948_REG_ACCEL_CONFIG</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00277">pinout.h:277</a></div></div>
<div class="ttc" id="a_i2_c_8c_html_a47431e985fd340e0e1d8a112bfe9ddcc"><div class="ttname"><a href="_i2_c_8c.html#a47431e985fd340e0e1d8a112bfe9ddcc">IIC_WriteBuffer</a></div><div class="ttdeci">bool IIC_WriteBuffer(uint8_t iicAddress, uint8_t *wBuffer, uint8_t wLength)</div><div class="ttdoc">I2C write functionality.</div><div class="ttdef"><b>Definition:</b> <a href="_i2_c_8c_source.html#l00112">I2C.c:112</a></div></div>
<div class="ttc" id="apinout_8h_html_a16f777b55cb5d93d7d0b870f59579186"><div class="ttname"><a href="pinout_8h.html#a16f777b55cb5d93d7d0b870f59579186">AK09916_MODE_SINGLE</a></div><div class="ttdeci">#define AK09916_MODE_SINGLE</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00385">pinout.h:385</a></div></div>
<div class="ttc" id="a_i_c_m20948_8c_html_ab6d2dbd77995c450b5cab0068291cc37"><div class="ttname"><a href="_i_c_m20948_8c.html#ab6d2dbd77995c450b5cab0068291cc37">ICM_20948_accelBandwidthSet</a></div><div class="ttdeci">uint32_t ICM_20948_accelBandwidthSet(uint8_t accelBw)</div><div class="ttdef"><b>Definition:</b> <a href="_i_c_m20948_8c_source.html#l01192">ICM20948.c:1192</a></div></div>
<div class="ttc" id="apinout_8h_html_aa59a7f4f3f88a8f60e0726224cdfd1d4"><div class="ttname"><a href="pinout_8h.html#aa59a7f4f3f88a8f60e0726224cdfd1d4">ICM_20948_REG_YG_OFFS_USRH</a></div><div class="ttdeci">#define ICM_20948_REG_YG_OFFS_USRH</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00261">pinout.h:261</a></div></div>
<div class="ttc" id="apinout_8h_html_a979c3313cb8acd9070c677ff2b5e3c60"><div class="ttname"><a href="pinout_8h.html#a979c3313cb8acd9070c677ff2b5e3c60">ICM_20948_BIT_SLV4_NACK</a></div><div class="ttdeci">#define ICM_20948_BIT_SLV4_NACK</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00166">pinout.h:166</a></div></div>
<div class="ttc" id="a_i_c_m20948_8c_html_a784752c7cf3630129dfd34f57cc5b440"><div class="ttname"><a href="_i_c_m20948_8c.html#a784752c7cf3630129dfd34f57cc5b440">ICM_20948_Init2</a></div><div class="ttdeci">void ICM_20948_Init2()</div><div class="ttdoc">Second init function for ICM20948, use when waking from sleep.</div><div class="ttdef"><b>Definition:</b> <a href="_i_c_m20948_8c_source.html#l00169">ICM20948.c:169</a></div></div>
<div class="ttc" id="apinout_8h_html_a84e24442a29c6513274636f22615cd2a"><div class="ttname"><a href="pinout_8h.html#a84e24442a29c6513274636f22615cd2a">ICM_20948_MISO_PORT</a></div><div class="ttdeci">#define ICM_20948_MISO_PORT</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00054">pinout.h:54</a></div></div>
<div class="ttc" id="apinout_8h_html_afe0ab3ec567eaa506dd89d9e18bb0640"><div class="ttname"><a href="pinout_8h.html#afe0ab3ec567eaa506dd89d9e18bb0640">ICM_20948_BIT_I2C_SLV_EN</a></div><div class="ttdeci">#define ICM_20948_BIT_I2C_SLV_EN</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00339">pinout.h:339</a></div></div>
<div class="ttc" id="a_i_c_m20948_8c_html_a70ee6c80001c77355f8d6f7e47ba43db"><div class="ttname"><a href="_i_c_m20948_8c.html#a70ee6c80001c77355f8d6f7e47ba43db">ICM_20948_interruptEnable</a></div><div class="ttdeci">uint32_t ICM_20948_interruptEnable(bool dataReadyEnable, bool womEnable)</div><div class="ttdef"><b>Definition:</b> <a href="_i_c_m20948_8c_source.html#l00870">ICM20948.c:870</a></div></div>
<div class="ttc" id="a_i_c_m20948_8c_html_aa97147c0f9f71cfaea563fb4b1d64306"><div class="ttname"><a href="_i_c_m20948_8c.html#aa97147c0f9f71cfaea563fb4b1d64306">ICM_20948_cycleModeEnable</a></div><div class="ttdeci">uint32_t ICM_20948_cycleModeEnable(bool enable)</div><div class="ttdef"><b>Definition:</b> <a href="_i_c_m20948_8c_source.html#l01035">ICM20948.c:1035</a></div></div>
<div class="ttc" id="a_i_c_m20948_8c_html_a67648f0e4d9239b0624c22f87a23014c"><div class="ttname"><a href="_i_c_m20948_8c.html#a67648f0e4d9239b0624c22f87a23014c">ICM_20948_read</a></div><div class="ttdeci">uint8_t ICM_20948_read(uint16_t addr)</div><div class="ttdoc">Read single register from IMU using SPI.</div><div class="ttdef"><b>Definition:</b> <a href="_i_c_m20948_8c_source.html#l00545">ICM20948.c:545</a></div></div>
<div class="ttc" id="a_i_c_m20948_8c_html_a498e73167c4bbbdc1221f2d409d44aa1"><div class="ttname"><a href="_i_c_m20948_8c.html#a498e73167c4bbbdc1221f2d409d44aa1">_magScale</a></div><div class="ttdeci">float _magScale</div><div class="ttdef"><b>Definition:</b> <a href="_i_c_m20948_8c_source.html#l00063">ICM20948.c:63</a></div></div>
<div class="ttc" id="a_i_c_m20948_8c_html_afa39af5c47122519a8bed2bcafd5ee06"><div class="ttname"><a href="_i_c_m20948_8c.html#afa39af5c47122519a8bed2bcafd5ee06">ICM_20948_read_mag_register</a></div><div class="ttdeci">void ICM_20948_read_mag_register(uint8_t addr, uint8_t numBytes, uint8_t *data)</div><div class="ttdoc">Read register in the AK09916 magnetometer device.</div><div class="ttdef"><b>Definition:</b> <a href="_i_c_m20948_8c_source.html#l01354">ICM20948.c:1354</a></div></div>
<div class="ttc" id="apinout_8h_html_ac259a86b42bae1a0c3d82eda232c23ab"><div class="ttname"><a href="pinout_8h.html#ac259a86b42bae1a0c3d82eda232c23ab">ICM_20948_MASK_GYRO_FULLSCALE</a></div><div class="ttdeci">#define ICM_20948_MASK_GYRO_FULLSCALE</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00240">pinout.h:240</a></div></div>
<div class="ttc" id="apinout_8h_html_a8cd33f6dc4502e60bb6d1c3a962018e2"><div class="ttname"><a href="pinout_8h.html#a8cd33f6dc4502e60bb6d1c3a962018e2">ICM_20948_BIT_FIFO_EN</a></div><div class="ttdeci">#define ICM_20948_BIT_FIFO_EN</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00123">pinout.h:123</a></div></div>
<div class="ttc" id="a_i_c_m20948_8c_html_a2a480bb1caa28241f1cc1e77a3445961"><div class="ttname"><a href="_i_c_m20948_8c.html#a2a480bb1caa28241f1cc1e77a3445961">ICM_20948_gyroSampleRateSet</a></div><div class="ttdeci">float ICM_20948_gyroSampleRateSet(float sampleRate)</div><div class="ttdef"><b>Definition:</b> <a href="_i_c_m20948_8c_source.html#l00907">ICM20948.c:907</a></div></div>
<div class="ttc" id="a_i_c_m20948_8c_html_ae81d4cfd5ba0ab7962bdc2ad2c002468"><div class="ttname"><a href="_i_c_m20948_8c.html#ae81d4cfd5ba0ab7962bdc2ad2c002468">ICM_20948_set_mag_mode</a></div><div class="ttdeci">uint32_t ICM_20948_set_mag_mode(uint8_t magMode)</div><div class="ttdef"><b>Definition:</b> <a href="_i_c_m20948_8c_source.html#l01416">ICM20948.c:1416</a></div></div>
<div class="ttc" id="apinout_8h_html_a49ea8558a01e1792f7798229b131f4e4"><div class="ttname"><a href="pinout_8h.html#a49ea8558a01e1792f7798229b131f4e4">AK09916_BIT_SRST</a></div><div class="ttdeci">#define AK09916_BIT_SRST</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00393">pinout.h:393</a></div></div>
<div class="ttc" id="apinout_8h_html_ac06d5a35f573d3861c7bdad67c209250"><div class="ttname"><a href="pinout_8h.html#ac06d5a35f573d3861c7bdad67c209250">ICM_20948_MASK_GYRO_BW</a></div><div class="ttdeci">#define ICM_20948_MASK_GYRO_BW</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00241">pinout.h:241</a></div></div>
<div class="ttc" id="a_i_c_m20948_8c_html_a95260c22db2bcec4bf69a71c967d5667"><div class="ttname"><a href="_i_c_m20948_8c.html#a95260c22db2bcec4bf69a71c967d5667">ICM_20948_calibrate_mag</a></div><div class="ttdeci">bool ICM_20948_calibrate_mag(float *offset, float *scale)</div><div class="ttdef"><b>Definition:</b> <a href="_i_c_m20948_8c_source.html#l01987">ICM20948.c:1987</a></div></div>
<div class="ttc" id="apinout_8h_html_a846c2742256a4baae9fdeca2d8d31214"><div class="ttname"><a href="pinout_8h.html#a846c2742256a4baae9fdeca2d8d31214">ICM_20948_ACCEL_FULLSCALE_2G</a></div><div class="ttdeci">#define ICM_20948_ACCEL_FULLSCALE_2G</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00283">pinout.h:283</a></div></div>
<div class="ttc" id="apinout_8h_html_a28de9b6408bb83f4bef537464c6b43f4"><div class="ttname"><a href="pinout_8h.html#a28de9b6408bb83f4bef537464c6b43f4">ICM_20948_BIT_I2C_READ</a></div><div class="ttdeci">#define ICM_20948_BIT_I2C_READ</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00343">pinout.h:343</a></div></div>
<div class="ttc" id="apinout_8h_html_ab4553be4db9860d940f81d7447173b2f"><div class="ttname"><a href="pinout_8h.html#ab4553be4db9860d940f81d7447173b2f">LED_PIN</a></div><div class="ttdeci">#define LED_PIN</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00021">pinout.h:21</a></div></div>
<div class="ttc" id="apinout_8h_html_a5491921059825463f0139bab0b42d146"><div class="ttname"><a href="pinout_8h.html#a5491921059825463f0139bab0b42d146">ICM_20948_REG_LP_CONFIG</a></div><div class="ttdeci">#define ICM_20948_REG_LP_CONFIG</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00129">pinout.h:129</a></div></div>
<div class="ttc" id="apinout_8h_html_a0cad2c4edc5886780be003d69741ec37"><div class="ttname"><a href="pinout_8h.html#a0cad2c4edc5886780be003d69741ec37">ICM_20948_CS_PORT</a></div><div class="ttdeci">#define ICM_20948_CS_PORT</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00049">pinout.h:49</a></div></div>
<div class="ttc" id="apinout_8h_html_a72251db0c0d0d4ebc9e17abafc5b077c"><div class="ttname"><a href="pinout_8h.html#a72251db0c0d0d4ebc9e17abafc5b077c">ICM_20948_REG_ZA_OFFSET_L</a></div><div class="ttdeci">#define ICM_20948_REG_ZA_OFFSET_L</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00227">pinout.h:227</a></div></div>
<div class="ttc" id="apinout_8h_html_aba51915c87d64af47fb1cc59348961c9"><div class="ttname"><a href="pinout_8h.html#aba51915c87d64af47fb1cc59348961c9">OK</a></div><div class="ttdeci">#define OK</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00402">pinout.h:402</a></div></div>
<div class="ttc" id="apinout_8h_html_a1be8ebcf9873010af11b8962da3dbb91"><div class="ttname"><a href="pinout_8h.html#a1be8ebcf9873010af11b8962da3dbb91">ICM_20948_REG_ZA_OFFSET_H</a></div><div class="ttdeci">#define ICM_20948_REG_ZA_OFFSET_H</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00226">pinout.h:226</a></div></div>
<div class="ttc" id="a_i_c_m20948_8c_html_a9f8e3ac3e31a7d1a441e1a8ceb3470c8"><div class="ttname"><a href="_i_c_m20948_8c.html#a9f8e3ac3e31a7d1a441e1a8ceb3470c8">ICM_20948_registerRead</a></div><div class="ttdeci">void ICM_20948_registerRead(uint16_t addr, int numBytes, uint8_t *data)</div><div class="ttdoc">Read registers from IMU.</div><div class="ttdef"><b>Definition:</b> <a href="_i_c_m20948_8c_source.html#l00654">ICM20948.c:654</a></div></div>
<div class="ttc" id="apinout_8h_html_a9c748891e6a5448e0b676ab17651de8c"><div class="ttname"><a href="pinout_8h.html#a9c748891e6a5448e0b676ab17651de8c">AK09916_DEVICE_ID</a></div><div class="ttdeci">#define AK09916_DEVICE_ID</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00368">pinout.h:368</a></div></div>
<div class="ttc" id="apinout_8h_html_a78784b662e6c45e07b95b3abbaf5889c"><div class="ttname"><a href="pinout_8h.html#a78784b662e6c45e07b95b3abbaf5889c">ICM_20948_BANK_0</a></div><div class="ttdeci">#define ICM_20948_BANK_0</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00070">pinout.h:70</a></div></div>
<div class="ttc" id="apinout_8h_html_aaf607133986cc433db4c0b97b1d9bd5b"><div class="ttname"><a href="pinout_8h.html#aaf607133986cc433db4c0b97b1d9bd5b">AK09916_BIT_MODE_POWER_DOWN</a></div><div class="ttdeci">#define AK09916_BIT_MODE_POWER_DOWN</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00384">pinout.h:384</a></div></div>
<div class="ttc" id="apinout_8h_html_abdc0ec272bbc6775cad4fd9af0002836"><div class="ttname"><a href="pinout_8h.html#abdc0ec272bbc6775cad4fd9af0002836">ICM_20948_REG_YA_OFFSET_L</a></div><div class="ttdeci">#define ICM_20948_REG_YA_OFFSET_L</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00225">pinout.h:225</a></div></div>
<div class="ttc" id="apinout_8h_html_aca8df047487d29bd72feed821ae3f408"><div class="ttname"><a href="pinout_8h.html#aca8df047487d29bd72feed821ae3f408">ICM_20948_REG_I2C_SLV4_CTRL</a></div><div class="ttdeci">#define ICM_20948_REG_I2C_SLV4_CTRL</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00335">pinout.h:335</a></div></div>
<div class="ttc" id="a_i_c_m20948_8c_html_ad8fa2097274ad4e2b81faf5917a62679"><div class="ttname"><a href="_i_c_m20948_8c.html#ad8fa2097274ad4e2b81faf5917a62679">ICM_20948_magDataRead</a></div><div class="ttdeci">void ICM_20948_magDataRead(float *magn)</div><div class="ttdef"><b>Definition:</b> <a href="_i_c_m20948_8c_source.html#l01468">ICM20948.c:1468</a></div></div>
<div class="ttc" id="apinout_8h_html_a8e9a5640699c35a0fee78b5013c31cfd"><div class="ttname"><a href="pinout_8h.html#a8e9a5640699c35a0fee78b5013c31cfd">ICM_20948_BIT_CLK_PLL</a></div><div class="ttdeci">#define ICM_20948_BIT_CLK_PLL</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00139">pinout.h:139</a></div></div>
<div class="ttc" id="a_i_c_m20948_8c_html_ace147474f6cfc16fee8390c478b66b5e"><div class="ttname"><a href="_i_c_m20948_8c.html#ace147474f6cfc16fee8390c478b66b5e">ICM_20948_power</a></div><div class="ttdeci">void ICM_20948_power(bool enable)</div><div class="ttdoc">Turns the GPIO pin high to provide power to the ICM20948.</div><div class="ttdef"><b>Definition:</b> <a href="_i_c_m20948_8c_source.html#l00392">ICM20948.c:392</a></div></div>
<div class="ttc" id="apinout_8h_html_a13373833ae00ffd733f408836a1eacc1"><div class="ttname"><a href="pinout_8h.html#a13373833ae00ffd733f408836a1eacc1">ICM_20948_OK</a></div><div class="ttdeci">#define ICM_20948_OK</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00043">pinout.h:43</a></div></div>
<div class="ttc" id="a_i_c_m20948_8c_html_ad503b9efac873146ca6401db153afe3e"><div class="ttname"><a href="_i_c_m20948_8c.html#ad503b9efac873146ca6401db153afe3e">ICM_20948_accelGyroCalibrate</a></div><div class="ttdeci">uint32_t ICM_20948_accelGyroCalibrate(float *accelBiasScaled, float *gyroBiasScaled)</div><div class="ttdoc">Accelerometer and gyroscope calibration function. Reads the gyroscope and accelerometer values while ...</div><div class="ttdef"><b>Definition:</b> <a href="_i_c_m20948_8c_source.html#l01525">ICM20948.c:1525</a></div></div>
<div class="ttc" id="apinout_8h_html_ae987da54cf2c6dfac776c7c1796da068"><div class="ttname"><a href="pinout_8h.html#ae987da54cf2c6dfac776c7c1796da068">ICM_20948_REG_ZG_OFFS_USRL</a></div><div class="ttdeci">#define ICM_20948_REG_ZG_OFFS_USRL</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00264">pinout.h:264</a></div></div>
<div class="ttc" id="apinout_8h_html_ad4d7441caf358bb8eb205489ba3db74e"><div class="ttname"><a href="pinout_8h.html#ad4d7441caf358bb8eb205489ba3db74e">ICM_20948_REG_INT_STATUS</a></div><div class="ttdeci">#define ICM_20948_REG_INT_STATUS</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00172">pinout.h:172</a></div></div>
<div class="ttc" id="apinout_8h_html_a03a286b0c524b0c86eea26404bc7111b"><div class="ttname"><a href="pinout_8h.html#a03a286b0c524b0c86eea26404bc7111b">ICM_20948_BIT_ACCEL_INTEL_EN</a></div><div class="ttdeci">#define ICM_20948_BIT_ACCEL_INTEL_EN</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00272">pinout.h:272</a></div></div>
<div class="ttc" id="apinout_8h_html_a6e4cc3b3e25b0e91f36c40a3a0cc0caf"><div class="ttname"><a href="pinout_8h.html#a6e4cc3b3e25b0e91f36c40a3a0cc0caf">ICM_20948_REG_ACCEL_XOUT_H_SH</a></div><div class="ttdeci">#define ICM_20948_REG_ACCEL_XOUT_H_SH</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00181">pinout.h:181</a></div></div>
<div class="ttc" id="a_i_c_m20948_8c_html_a8f1159f4f75b1eaed9a091d01fe76c3d"><div class="ttname"><a href="_i_c_m20948_8c.html#a8f1159f4f75b1eaed9a091d01fe76c3d">ICM_20948_sleepModeEnable</a></div><div class="ttdeci">uint32_t ICM_20948_sleepModeEnable(bool enable)</div><div class="ttdoc">Sleep mode enable function.</div><div class="ttdef"><b>Definition:</b> <a href="_i_c_m20948_8c_source.html#l00728">ICM20948.c:728</a></div></div>
<div class="ttc" id="apinout_8h_html_a0016198ccf5ca2b7f41d7a23e6554373"><div class="ttname"><a href="pinout_8h.html#a0016198ccf5ca2b7f41d7a23e6554373">GYRO_XOUT_H</a></div><div class="ttdeci">#define GYRO_XOUT_H</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00082">pinout.h:82</a></div></div>
<div class="ttc" id="a_i_c_m20948_8c_html_a32e5e81e275f3fecca06ca62cccd8ad5"><div class="ttname"><a href="_i_c_m20948_8c.html#a32e5e81e275f3fecca06ca62cccd8ad5">ICM_20948_reset</a></div><div class="ttdeci">uint32_t ICM_20948_reset(void)</div><div class="ttdoc">Reset IMU.</div><div class="ttdef"><b>Definition:</b> <a href="_i_c_m20948_8c_source.html#l00762">ICM20948.c:762</a></div></div>
<div class="ttc" id="a_i_c_m20948_8c_html_aa9c1a0462c03c5af6e1ccff792128450"><div class="ttname"><a href="_i_c_m20948_8c.html#aa9c1a0462c03c5af6e1ccff792128450">ICM_20948_bankSelect</a></div><div class="ttdeci">void ICM_20948_bankSelect(uint8_t bank)</div><div class="ttdoc">Select appropriate bank in ICM20948 based on first bits of address.</div><div class="ttdef"><b>Definition:</b> <a href="_i_c_m20948_8c_source.html#l00528">ICM20948.c:528</a></div></div>
<div class="ttc" id="apinout_8h_html_a73e873ebc352fc7cf43e5c85cb546cd9"><div class="ttname"><a href="pinout_8h.html#a73e873ebc352fc7cf43e5c85cb546cd9">ICM_20948_BIT_ACCEL_INTEL_MODE</a></div><div class="ttdeci">#define ICM_20948_BIT_ACCEL_INTEL_MODE</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00273">pinout.h:273</a></div></div>
<div class="ttc" id="apinout_8h_html_aae65925e0df0c418431e90baaf0de47c"><div class="ttname"><a href="pinout_8h.html#aae65925e0df0c418431e90baaf0de47c">AK09916_MODE_10HZ</a></div><div class="ttdeci">#define AK09916_MODE_10HZ</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00386">pinout.h:386</a></div></div>
<div class="ttc" id="apinout_8h_html_a5a99e1ad936b41f267baafe25c865afc"><div class="ttname"><a href="pinout_8h.html#a5a99e1ad936b41f267baafe25c865afc">ICM_20948_CS_PIN</a></div><div class="ttdeci">#define ICM_20948_CS_PIN</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00048">pinout.h:48</a></div></div>
<div class="ttc" id="apinout_8h_html_ac280fd4992257ea4ae9dea6b84808003"><div class="ttname"><a href="pinout_8h.html#ac280fd4992257ea4ae9dea6b84808003">ICM_20948_BIT_PWR_ACCEL_STBY</a></div><div class="ttdeci">#define ICM_20948_BIT_PWR_ACCEL_STBY</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00142">pinout.h:142</a></div></div>
<div class="ttc" id="apinout_8h_html_af1f87a2f8a403005c59d91e6085fcd18"><div class="ttname"><a href="pinout_8h.html#af1f87a2f8a403005c59d91e6085fcd18">ICM_20948_REG_INT_PIN_CFG</a></div><div class="ttdeci">#define ICM_20948_REG_INT_PIN_CFG</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00146">pinout.h:146</a></div></div>
<div class="ttc" id="apinout_8h_html_a9bb6dda54a5d15491c813023b363a7ae"><div class="ttname"><a href="pinout_8h.html#a9bb6dda54a5d15491c813023b363a7ae">ICM_20948_REG_ACCEL_SMPLRT_DIV_1</a></div><div class="ttdeci">#define ICM_20948_REG_ACCEL_SMPLRT_DIV_1</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00268">pinout.h:268</a></div></div>
<div class="ttc" id="apinout_8h_html_a15d711ac3d5e10d14ff4cb66dd643ec4"><div class="ttname"><a href="pinout_8h.html#a15d711ac3d5e10d14ff4cb66dd643ec4">ICM_20948_REG_WHO_AM_I</a></div><div class="ttdeci">#define ICM_20948_REG_WHO_AM_I</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00119">pinout.h:119</a></div></div>
<div class="ttc" id="a_i_c_m20948_8c_html_ae71449b1cc6e6250b91f539153a7a0d3"><div class="ttname"><a href="_i_c_m20948_8c.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a></div><div class="ttdeci">#define M_PI</div><div class="ttdef"><b>Definition:</b> <a href="_i_c_m20948_8c_source.html#l00041">ICM20948.c:41</a></div></div>
<div class="ttc" id="apinout_8h_html_a38e158b2dc4b9cbd5daa42cebecd8db1"><div class="ttname"><a href="pinout_8h.html#a38e158b2dc4b9cbd5daa42cebecd8db1">ICM_20948_BIT_I2C_SLV_READ</a></div><div class="ttdeci">#define ICM_20948_BIT_I2C_SLV_READ</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00360">pinout.h:360</a></div></div>
<div class="ttc" id="apinout_8h_html_a1d30f6d19c0cb220ac9109273e7224ee"><div class="ttname"><a href="pinout_8h.html#a1d30f6d19c0cb220ac9109273e7224ee">ICM_20948_ACCEL_FULLSCALE_16G</a></div><div class="ttdeci">#define ICM_20948_ACCEL_FULLSCALE_16G</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00286">pinout.h:286</a></div></div>
<div class="ttc" id="apinout_8h_html_a5645d53425645ed575721d1eee6d3e66"><div class="ttname"><a href="pinout_8h.html#a5645d53425645ed575721d1eee6d3e66">ICM_20948_REG_XA_OFFSET_H</a></div><div class="ttdeci">#define ICM_20948_REG_XA_OFFSET_H</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00222">pinout.h:222</a></div></div>
<div class="ttc" id="apinout_8h_html_a67dc220bec5bd3c3c95c909c2629159b"><div class="ttname"><a href="pinout_8h.html#a67dc220bec5bd3c3c95c909c2629159b">AK09916_REG_CONTROL_2</a></div><div class="ttdeci">#define AK09916_REG_CONTROL_2</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00383">pinout.h:383</a></div></div>
<div class="ttc" id="a_i_c_m20948_8c_html_ae6ae090b120ceda0265da1df5a25c185"><div class="ttname"><a href="_i_c_m20948_8c.html#ae6ae090b120ceda0265da1df5a25c185">ICM_20948_gyroResolutionGet</a></div><div class="ttdeci">uint32_t ICM_20948_gyroResolutionGet(float *gyroRes)</div><div class="ttdoc">Set gyro resolution.</div><div class="ttdef"><b>Definition:</b> <a href="_i_c_m20948_8c_source.html#l00817">ICM20948.c:817</a></div></div>
<div class="ttc" id="a_i2_c_8c_html_a06104f2b83b9e221737ba5a75c6edc4c"><div class="ttname"><a href="_i2_c_8c.html#a06104f2b83b9e221737ba5a75c6edc4c">IIC_WriteReadBuffer</a></div><div class="ttdeci">bool IIC_WriteReadBuffer(uint8_t iicAddress, uint8_t *wBuffer, uint8_t wLength, uint8_t *rBuffer, uint8_t rLength)</div><div class="ttdoc">I2C read/write functionality, to read and write at the same time.</div><div class="ttdef"><b>Definition:</b> <a href="_i2_c_8c_source.html#l00190">I2C.c:190</a></div></div>
<div class="ttc" id="apinout_8h_html_ad7223a43f4e8f1389232e6b559209550"><div class="ttname"><a href="pinout_8h.html#ad7223a43f4e8f1389232e6b559209550">ICM_20948_REG_GYRO_CONFIG_1</a></div><div class="ttdeci">#define ICM_20948_REG_GYRO_CONFIG_1</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00236">pinout.h:236</a></div></div>
<div class="ttc" id="a_i_c_m20948_8c_html_a128cc4107e5e547f6c9e1c4dd87cfbe8"><div class="ttname"><a href="_i_c_m20948_8c.html#a128cc4107e5e547f6c9e1c4dd87cfbe8">ICM_20948_gyroFullscaleSet</a></div><div class="ttdeci">uint32_t ICM_20948_gyroFullscaleSet(uint8_t gyroFs)</div><div class="ttdef"><b>Definition:</b> <a href="_i_c_m20948_8c_source.html#l01117">ICM20948.c:1117</a></div></div>
<div class="ttc" id="apinout_8h_html_a8a5e88ca0ad999c59cc428b8656d4bc1"><div class="ttname"><a href="pinout_8h.html#a8a5e88ca0ad999c59cc428b8656d4bc1">ICM_20948_REG_PWR_MGMT_1</a></div><div class="ttdeci">#define ICM_20948_REG_PWR_MGMT_1</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00134">pinout.h:134</a></div></div>
<div class="ttc" id="apinout_8h_html_a3d05c6f5584419cd8a5dd9840ecce0a2"><div class="ttname"><a href="pinout_8h.html#a3d05c6f5584419cd8a5dd9840ecce0a2">ICM_20948_MASK_ACCEL_BW</a></div><div class="ttdeci">#define ICM_20948_MASK_ACCEL_BW</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00282">pinout.h:282</a></div></div>
<div class="ttc" id="apinout_8h_html_a7f2042e7b2ac7ad4fe753558788aca1c"><div class="ttname"><a href="pinout_8h.html#a7f2042e7b2ac7ad4fe753558788aca1c">ICM_20948_BITS_GYRO_FIFO_EN</a></div><div class="ttdeci">#define ICM_20948_BITS_GYRO_FIFO_EN</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00203">pinout.h:203</a></div></div>
<div class="ttc" id="adbprint_8h_html_a5e059a469cca8341eb0a84e5c352f518"><div class="ttname"><a href="dbprint_8h.html#a5e059a469cca8341eb0a84e5c352f518">dbprintln</a></div><div class="ttdeci">void dbprintln(char *message)</div></div>
<div class="ttc" id="apinout_8h_html_a892abfa89a52e8ba9361da738c85c7b5"><div class="ttname"><a href="pinout_8h.html#a892abfa89a52e8ba9361da738c85c7b5">ICM_20948_REG_I2C_SLV4_ADDR</a></div><div class="ttdeci">#define ICM_20948_REG_I2C_SLV4_ADDR</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00333">pinout.h:333</a></div></div>
<div class="ttc" id="a_i_c_m20948_8c_html_aa22d0eb7ceca8855eb2eece3d875f65e"><div class="ttname"><a href="_i_c_m20948_8c.html#aa22d0eb7ceca8855eb2eece3d875f65e">ICM_20948_registerWrite</a></div><div class="ttdeci">void ICM_20948_registerWrite(uint16_t addr, uint8_t data)</div><div class="ttdoc">Writes registers from IMU.</div><div class="ttdef"><b>Definition:</b> <a href="_i_c_m20948_8c_source.html#l00697">ICM20948.c:697</a></div></div>
<div class="ttc" id="a_i_c_m20948_8c_html_a4f779573a3b06192892ce82c7cd94307"><div class="ttname"><a href="_i_c_m20948_8c.html#a4f779573a3b06192892ce82c7cd94307">_hxcounts</a></div><div class="ttdeci">int16_t _hxcounts</div><div class="ttdef"><b>Definition:</b> <a href="_i_c_m20948_8c_source.html#l00047">ICM20948.c:47</a></div></div>
<div class="ttc" id="apinout_8h_html_adcbd4695e0846db7c093b2346b5a1c99"><div class="ttname"><a href="pinout_8h.html#adcbd4695e0846db7c093b2346b5a1c99">ICM_20948_REG_FIFO_EN_2</a></div><div class="ttdeci">#define ICM_20948_REG_FIFO_EN_2</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00201">pinout.h:201</a></div></div>
<div class="ttc" id="apinout_8h_html_ac8aa6fa64b970326bb6c8cd2c821a99f"><div class="ttname"><a href="pinout_8h.html#ac8aa6fa64b970326bb6c8cd2c821a99f">ICM_20948_REG_I2C_SLV4_REG</a></div><div class="ttdeci">#define ICM_20948_REG_I2C_SLV4_REG</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00334">pinout.h:334</a></div></div>
<div class="ttc" id="apinout_8h_html_a789cde66e41f680ffdad9150073b52c1"><div class="ttname"><a href="pinout_8h.html#a789cde66e41f680ffdad9150073b52c1">ICM_20948_CLK_PIN</a></div><div class="ttdeci">#define ICM_20948_CLK_PIN</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00051">pinout.h:51</a></div></div>
<div class="ttc" id="apinout_8h_html_ab5848846969bfeafb00f106e24e74d90"><div class="ttname"><a href="pinout_8h.html#ab5848846969bfeafb00f106e24e74d90">ICM_20948_REG_ACCEL_INTEL_CTRL</a></div><div class="ttdeci">#define ICM_20948_REG_ACCEL_INTEL_CTRL</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00271">pinout.h:271</a></div></div>
<div class="ttc" id="apinout_8h_html_a4912ec501e0a13e30f34620158979491"><div class="ttname"><a href="pinout_8h.html#a4912ec501e0a13e30f34620158979491">ICM_20948_BIT_SLV4_DONE</a></div><div class="ttdeci">#define ICM_20948_BIT_SLV4_DONE</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00164">pinout.h:164</a></div></div>
<div class="ttc" id="apinout_8h_html_add11763f890c38ef1ee2ec575bde6b04"><div class="ttname"><a href="pinout_8h.html#add11763f890c38ef1ee2ec575bde6b04">ICM_20948_GYRO_FULLSCALE_250DPS</a></div><div class="ttdeci">#define ICM_20948_GYRO_FULLSCALE_250DPS</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00242">pinout.h:242</a></div></div>
<div class="ttc" id="apinout_8h_html_a45b340573ef962261c8641a9401ba691"><div class="ttname"><a href="pinout_8h.html#a45b340573ef962261c8641a9401ba691">ICM_20948_REG_I2C_MST_STATUS</a></div><div class="ttdeci">#define ICM_20948_REG_I2C_MST_STATUS</div><div class="ttdef"><b>Definition:</b> <a href="pinout_8h_source.html#l00162">pinout.h:162</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_a09558a34147725174ab6a4ec37f0469.html">ICM_20948</a></li><li class="navelem"><a class="el" href="_i_c_m20948_8c.html">ICM20948.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.16 </li>
  </ul>
</div>
</body>
</html>
